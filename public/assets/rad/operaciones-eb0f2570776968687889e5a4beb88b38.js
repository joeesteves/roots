(function(){var a,e,o,i,t,n,r,c,p,d,s;s=function(){switch("true"===$("#con_arbol").val()&&$.fn.arbolInit(),$.fn.gridRequest(),$(".calcCuota").change(function(){return n()}),$(".calcCuotaInv").change(function(){return r()}),$("#rad_operacion_operaciontipo_id").change(function(){return p(!1),d(!0),o($("#rad_operacion_operaciontipo_id option:selected").data("codigo")),$.fn.defineUiXOpTipo([$("#rad_operacion_operaciontipo_id option:selected").data("codigo"),void 0])}),$("#action_name").val()){case"new":return o($("#rad_operacion_operaciontipo_id option:selected").data("codigo"));case"edit":return $.fn.defineUiXOpTipo([$("#rad_operacion_operaciontipo_id option:selected").data("codigo"),$("#rad_operacion_id").val()]);case"create":return $.fn.defineUiXOpTipo([$("#rad_operacion_operaciontipo_id option:selected").data("codigo"),void 0])}},$.fn.defineUiXOpTipo=function(o){switch(o[0]){case 0:return p(!0),d(!0);case-1:case 2:return-1===o[0]&&d(!1),e(void 0===o[1]?["buscaPorCta",c("haber"),"haber"]:["buscaPorReg",o[1],"haber"]),a("haber");case 1:case-2:return 1===o[0]&&d(!1),e(void 0===o[1]?["buscaPorCta",c("debe"),"debe"]:["buscaPorReg",o[1],"debe"]),a("debe")}},p=function(a){return $("#rad_operacion_cuotas, #rad_operacion_cuotaimporte").prop("readonly",a)},d=function(a){return $("#rad_operacion_rdosxmes").prop("disabled",a),a===!0?$("#rad_operacion_rdosxmes").prop("checked",!1):void 0},$.fn.gridRequest=function(a){var e,o;return e=["id","fecha","tipo","importe","desc","cuotaimporte"],o=[["Fecha","20%"],["Tipo","auto"],["Importe","20%"],["desc","auto","Descripci\xf3n"],["cuotaimporte","auto","Cuota"]],$.fn.gridPrepDatos(e,o,a)},n=function(){var a,e,o;return e=$("#rad_operacion_importe").val(),a=$("#rad_operacion_cuotas").val(),o=(e/a).toFixed(2),$("#rad_operacion_cuotaimporte").val(o)},r=function(){var a,e,o;return a=$("#rad_operacion_cuotas").val(),o=$("#rad_operacion_cuotaimporte").val(),e=(o*a).toFixed(2),$("#rad_operacion_importe").val(e)},o=function(a){return $.ajax({type:"POST",url:$("#root_path").val()+"rco/cuentas/x_operacion_tipo",data:{operaciontipo_codigo:a},dataType:"script"})},a=function(a){switch(a){case"debe":return $("#rad_operacion_ctaD_id, #rad_operacion_ctaH_id").unbind("change"),$("#rad_operacion_ctaD_id").change(function(){return e(["buscaPorCta",c("debe"),"debe"])});case"haber":return $("#rad_operacion_ctaD_id, #rad_operacion_ctaH_id").unbind("change"),$("#rad_operacion_ctaH_id").change(function(){return e(["buscaPorCta",c("haber"),"haber"])})}},e=function(a){var e;return e="buscaPorReg"===a[0]?{rad_operacion_id:a[1],saldoTipo:a[2]}:{saldoTipo:a[2],cuenta_id:a[1]},$.ajax({type:"POST",url:$("#root_path").val()+"rad/operaciones/compatibles",data:e,dataType:"script"})},c=function(a){switch(a){case"debe":return $("#rad_operacion_ctaD_id option:selected").val();case"haber":return $("#rad_operacion_ctaH_id option:selected").val()}},$.fn.cargaCompatibles=function(a){return $("#compatibles").empty(),$("#compatibles").append('<select  data-placeholder="Seleccionar registros" id="aplicaciones" name="aplicaciones[]" multiple></select>'),$.each(a,function(){var a;return a='<option id="'+this.id+'" value="'+this.id+", "+this.disponible+'" data-disponible="'+this.disponible+'"data-aplicado="'+this.aplicadoATransaccion+'"data-desc="'+this.desc+'">'+this.desc+" -- disp: "+this.disponible+" -- venc: "+this.fecha+"</option>",$("#aplicaciones").append(a)}),$("#aplicaciones").change(function(){return $("#compatiblesImporte").empty(),$("#aplicaciones option:selected").each(function(){return i($(this),"onSelect")}),t(),$("#compatiblesImporte input").focus()}),$.fn.initChosen()},$.fn.seleccionaAplicados=function(a){return $("#aplicaciones "+a).prop("selected",!0).trigger("chosen:updated"),$.each($("#aplicaciones "+a),function(){return i($(this),"onRecord")})},t=function(){return $("#rad_operacion_importe").val(0),$("#compatiblesImporte input").each(function(){var a,e;return a=$(this).attr("id").substr(4),e=$("#aplicaciones #"+a),parseFloat($(this).val())>parseFloat(e.data("disponible"))&&$(this).val(e.data("disponible")),$("#rad_operacion_importe").val(parseFloat($("#rad_operacion_importe").val())+parseFloat($(this).val())),e.val(a+", "+$(this).val())}),$("#rad_operacion_importe").change()},i=function(a,e){var o,i;return o="reg_"+a.attr("id"),i=a.data("undefined"===a.data("aplicado")||"onSelect"===e?"disponible":"aplicado"),$("#compatiblesImporte").append("<span>Ref: "+a.data("desc")+"</span><input id="+o+" name="+o+' type="text" value="'+i+'">'),$("#compatiblesImporte input").change(function(){return t()})},$(document).on("page:load",s),$(document).ready(s)}).call(this);