!function(e){e.jqx.jqxWidget("jqxListBox","",{}),e.extend(e.jqx._jqxListBox.prototype,{defineInstance:function(){var t={disabled:!1,width:null,height:null,items:new Array,multiple:!1,selectedIndex:-1,selectedIndexes:new Array,source:null,scrollBarSize:e.jqx.utilities.scrollBarSize,enableHover:!0,enableSelection:!0,visualItems:new Array,groups:new Array,equalItemsWidth:!0,itemHeight:-1,visibleItems:new Array,emptyGroupText:"Group",checkboxes:!1,hasThreeStates:!1,autoHeight:!1,autoItemsHeight:!1,roundedcorners:!0,touchMode:"auto",displayMember:"",groupMember:"",valueMember:"",searchMember:"",searchMode:"startswithignorecase",incrementalSearch:!0,incrementalSearchDelay:1e3,incrementalSearchKeyDownDelay:300,allowDrag:!1,allowDrop:!0,dropAction:"default",touchModeStyle:"auto",keyboardNavigation:!0,enableMouseWheel:!0,multipleextended:!1,selectedValues:new Array,emptyString:"",rtl:!1,rendered:null,renderer:null,dragStart:null,dragEnd:null,focusable:!0,ready:null,_checkForHiddenParent:!0,autoBind:!0,filterable:!1,filterHeight:27,filterPlaceHolder:"Looking for",filterDelay:100,aria:{"aria-disabled":{name:"disabled",type:"boolean"}},events:["select","unselect","change","checkChange","dragStart","dragEnd","bindingComplete"]};return e.extend(!0,this,t),t},createInstance:function(){var t=this;15!=e.jqx.utilities.scrollBarSize&&(t.scrollBarSize=e.jqx.utilities.scrollBarSize),null==t.width&&(t.width=200),null==t.height&&(t.height=200),t.render();var i=t;e.jqx.utilities.resize(t.host,function(){i._updateSize()},!1,t._checkForHiddenParent)},resize:function(e,t){this.width=e,this.height=t,this._updateSize()},render:function(){var t=this,i=t.element.nodeName.toLowerCase();if("select"==i||"ul"==i||"ol"==i){t.field=t.element,t.field.className&&(t._className=t.field.className);var s={title:t.field.title};s.id=t.field.id.length?t.field.id.replace(/[^\w]/g,"_")+"_jqxListBox":e.jqx.utilities.createId()+"_jqxListBox";var l=e("<div></div>",s);t.width||(t.width=e(t.field).width()),t.height||(t.height=e(t.field).outerHeight()),e(t.field).hide().after(l);var r=t.host.data();if(t.host=l,t.host.data(r),t.element=l[0],t.element.id=t.field.id,t.field.id=s.id,t.field.tabIndex){var n=t.field.tabIndex;t.field.tabIndex=-1,t.element.tabIndex=n}}t.element.innerHTML="";var t=t,a=t.element.className;a+=" "+t.toThemeProperty("jqx-listbox"),a+=" "+t.toThemeProperty("jqx-reset"),a+=" "+t.toThemeProperty("jqx-rc-all"),a+=" "+t.toThemeProperty("jqx-widget"),a+=" "+t.toThemeProperty("jqx-widget-content"),t.element.className=a;var h=!1;null!=t.width&&-1!=t.width.toString().indexOf("%")&&(t.host.width(t.width),h=!0),null!=t.height&&-1!=t.height.toString().indexOf("%")&&(t.host.height(t.height),0==t.host.height()&&t.host.height(200),h=!0),null!=t.width&&-1!=t.width.toString().indexOf("px")?t.host.width(t.width):void 0==t.width||isNaN(t.width)||(t.element.style.width=parseInt(t.width)+"px"),null!=t.height&&-1!=t.height.toString().indexOf("px")?t.host.height(t.height):void 0==t.height||isNaN(t.height)||(t.element.style.height=parseInt(t.height)+"px"),t.multiple||t.multipleextended||t.checkboxes?e.jqx.aria(t,"aria-multiselectable",!0):e.jqx.aria(t,"aria-multiselectable",!1);var o=e("<div style='-webkit-appearance: none; background: transparent; outline: none; width:100%; height: 100%; align:left; border: 0px; padding: 0px; margin: 0px; left: 0px; top: 0px; valign:top; position: relative;'><div style='-webkit-appearance: none; border: none; background: transparent; outline: none; width:100%; height: 100%; padding: 0px; margin: 0px; align:left; left: 0px; top: 0px; valign:top; position: relative;'><div id='filter"+t.element.id+"' style='display: none; visibility: inherit; align:left; valign:top; left: 0px; top: 0px; position: absolute;'><input style='position: absolute;'/></div><div id='listBoxContent' style='-webkit-appearance: none; border: none; background: transparent; outline: none; border: none; padding: 0px; overflow: hidden; margin: 0px; align:left; valign:top; left: 0px; top: 0px; position: absolute;'/><div id='verticalScrollBar"+t.element.id+"' style='visibility: inherit; align:left; valign:top; left: 0px; top: 0px; position: absolute;'/><div id='horizontalScrollBar"+t.element.id+"' style='visibility: inherit; align:left; valign:top; left: 0px; top: 0px; position: absolute;'/><div id='bottomRight' style='align:left; valign:top; left: 0px; top: 0px; border: none; position: absolute;'/></div></div>");t._checkForHiddenParent&&(t._addInput(),t.host.attr("tabIndex")||t.host.attr("tabIndex",1)),t.host.attr("role","listbox"),t.host.append(o),t.filter=t.host.find("#filter"+t.element.id),t.filterInput=t.filter.find("input"),t.filterInput.attr("placeholder",t.filterPlaceHolder),t.filterInput.addClass(t.toThemeProperty("jqx-widget jqx-input jqx-rc-all")),t.addHandler(t.filterInput,"keyup.textchange",function(e){13==e.keyCode?t._search(e):t.filterDelay>0&&(t._filterTimer&&clearTimeout(t._filterTimer),t._filterTimer=setTimeout(function(){t._search(e)},t.filterDelay)),e.stopPropagation()});var d=t.host.find("#verticalScrollBar"+t.element.id);if(!t.host.jqxButton)throw new Error("jqxListBox: Missing reference to jqxbuttons.js.");if(!d.jqxScrollBar)throw new Error("jqxListBox: Missing reference to jqxscrollbar.js.");var c=parseInt(t.host.height())/2;0==c&&(c=10),t.vScrollBar=d.jqxScrollBar({_initialLayout:!0,vertical:!0,rtl:t.rtl,theme:t.theme,touchMode:t.touchMode,largestep:c});var u=t.host.find("#horizontalScrollBar"+t.element.id);if(t.hScrollBar=u.jqxScrollBar({_initialLayout:!0,vertical:!1,rtl:t.rtl,touchMode:t.touchMode,theme:t.theme}),t.content=t.host.find("#listBoxContent"),t.content[0].id="listBoxContent"+t.element.id,t.bottomRight=t.host.find("#bottomRight").addClass(t.toThemeProperty("jqx-listbox-bottomright")).addClass(t.toThemeProperty("jqx-scrollbar-state-normal")),t.bottomRight[0].id="bottomRight"+t.element.id,t.vScrollInstance=e.data(t.vScrollBar[0],"jqxScrollBar").instance,t.hScrollInstance=e.data(t.hScrollBar[0],"jqxScrollBar").instance,t.isTouchDevice()&&!(e.jqx.browser.msie&&e.jqx.browser.version<9)){var v=e("<div class='overlay' unselectable='on' style='z-index: 99; -webkit-appearance: none; border: none; background: black; opacity: 0.01; outline: none; border: none; padding: 0px; overflow: hidden; margin: 0px; align:left; valign:top; left: 0px; top: 0px; position: absolute;'></div>");t.content.parent().append(v),t.overlayContent=t.host.find(".overlay"),t.filterable&&t.overlayContent.css("top","30px")}t._updateTouchScrolling(),t.host.addClass("jqx-disableselect"),t.host.jqxDragDrop&&jqxListBoxDragDrop()},_highlight:function(e,t){var i=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+i+")","ig"),function(e,t){return"<b>"+t+"</b>"})},_addInput:function(){var t=this.host.attr("name");t&&this.host.attr("name",""),this.input=e("<input type='hidden'/>"),this.host.append(this.input),this.input.attr("name",t)},_updateTouchScrolling:function(){var t=this;if(this.isTouchDevice()){t.enableHover=!1;var i=this.overlayContent?this.overlayContent:this.content;this.removeHandler(e(i),e.jqx.mobile.getTouchEventName("touchstart")+".touchScroll"),this.removeHandler(e(i),e.jqx.mobile.getTouchEventName("touchmove")+".touchScroll"),this.removeHandler(e(i),e.jqx.mobile.getTouchEventName("touchend")+".touchScroll"),this.removeHandler(e(i),"touchcancel.touchScroll"),e.jqx.mobile.touchScroll(i,t.vScrollInstance.max,function(e,i){if("hidden"!=t.vScrollBar.css("visibility")){var s=t.vScrollInstance.value;t.vScrollInstance.setPosition(s+i),t._lastScroll=new Date}if("hidden"!=t.hScrollBar.css("visibility")){var s=t.hScrollInstance.value;t.hScrollInstance.setPosition(s+e),t._lastScroll=new Date}},this.element.id,this.hScrollBar,this.vScrollBar),"visible"!=t.vScrollBar.css("visibility")&&"visible"!=t.hScrollBar.css("visibility")?e.jqx.mobile.setTouchScroll(!1,this.element.id):e.jqx.mobile.setTouchScroll(!0,this.element.id),this._arrange()}},isTouchDevice:function(){var t=e.jqx.mobile.isTouchDevice();if(1==this.touchMode){if(this.touchDevice)return!0;if(e.jqx.browser.msie&&e.jqx.browser.version<9)return!1;this.touchDevice=!0,t=!0,e.jqx.mobile.setMobileSimulator(this.element)}else 0==this.touchMode&&(t=!1);return t&&0!=this.touchModeStyle&&(this.scrollBarSize=e.jqx.utilities.touchScrollBarSize),t&&this.host.addClass(this.toThemeProperty("jqx-touch")),t},beginUpdate:function(){this.updatingListBox=!0},endUpdate:function(){this.updatingListBox=!1,this._addItems(),this._renderItems()},beginUpdateLayout:function(){this.updating=!0},resumeUpdateLayout:function(){this.updating=!1,this.vScrollInstance.value=0,this._render(!1)},propertiesChangedHandler:function(e){e._cachedItemHtml=new Array,e.clearSelection(),e.refresh()},propertyChangedHandler:function(t,i,s,l){if(void 0!=this.isInitialized&&0!=this.isInitialized&&!t.batchUpdate){if("filterable"==i&&t.refresh(),"filterHeight"==i&&t._arrange(),"filterPlaceHolder"==i&&t.filterInput.attr("placeholder",l),"renderer"==i&&(t._cachedItemHtml=new Array,t.refresh()),"itemHeight"==i&&t.refresh(),("source"==i||"checkboxes"==i)&&(null==l&&s&&s.unbindBindingUpdate&&(s.unbindBindingUpdate(t.element.id),s.unbindDownloadComplete(t.element.id)),t.clearSelection(),t.refresh()),("scrollBarSize"==i||"equalItemsWidth"==i)&&l!=s&&t._updatescrollbars(),"disabled"==i&&(t._renderItems(),t.vScrollBar.jqxScrollBar({disabled:l}),t.hScrollBar.jqxScrollBar({disabled:l})),"touchMode"==i||"rtl"==i){if(t._removeHandlers(),t.vScrollBar.jqxScrollBar({touchMode:l}),t.hScrollBar.jqxScrollBar({touchMode:l}),"touchMode"==i&&!(e.jqx.browser.msie&&e.jqx.browser.version<9)){var r=e("<div class='overlay' unselectable='on' style='z-index: 99; -webkit-appearance: none; border: none; background: black; opacity: 0.01; outline: none; border: none; padding: 0px; overflow: hidden; margin: 0px; align:left; valign:top; left: 0px; top: 0px; position: absolute;'></div>");t.content.parent().append(r),t.overlayContent=t.host.find(".overlay")}t._updateTouchScrolling(),t._addHandlers(),t._render(!1)}if(this.updating||("width"==i||"height"==i)&&t._updateSize(),"theme"==i&&s!=l&&(t.hScrollBar.jqxScrollBar({theme:t.theme}),t.vScrollBar.jqxScrollBar({theme:t.theme}),t.host.removeClass(),t.host.addClass(t.toThemeProperty("jqx-listbox")),t.host.addClass(t.toThemeProperty("jqx-widget")),t.host.addClass(t.toThemeProperty("jqx-widget-content")),t.host.addClass(t.toThemeProperty("jqx-reset")),t.host.addClass(t.toThemeProperty("jqx-rc-all")),t.refresh()),"selectedIndex"==i&&(t.clearSelection(),t.selectIndex(l,!0)),"displayMember"==i||"valueMember"==i){if(s!=l){var n=t.selectedIndex;t.refresh(),t.selectedIndex=n,t.selectedIndexes[n]=n}t._renderItems()}"autoHeight"==i&&(s!=l?t._render(!1):(t._updatescrollbars(),t._renderItems())),t._checkForHiddenParent&&e.jqx.isHidden(t.host)&&e.jqx.utilities.resize(this.host,function(){t._updateSize()},!1,t._checkForHiddenParent)}},loadFromSelect:function(t){if(null!=t){var i="#"+t,s=e(i);if(s.length>0){var l=e.jqx.parseSourceTag(s[0]),r=l.items,n=l.index;this.source=r,this.fromSelect=!0,this.clearSelection(),this.selectedIndex=n,this.selectedIndexes[this.selectedIndex]=this.selectedIndex,this.refresh()}}},invalidate:function(){this._cachedItemHtml=[],this._renderItems(),this.virtualSize=null,this._updateSize()},refresh:function(t){var i=this;if(void 0!=this.vScrollBar){this._cachedItemHtml=[],this.visibleItems=new Array;var s=function(e){if(1==e&&-1!=i.selectedIndex){var t=i.selectedIndex;i.selectedIndex=-1,i._stopEvents=!0,i.selectIndex(t,!1,!0),-1==i.selectedIndex&&(i.selectedIndex=t),i._stopEvents=!1}};if(null!=this.itemswrapper&&(this.itemswrapper.remove(),this.itemswrapper=null),e.jqx.dataAdapter&&null!=this.source&&this.source._source)return this.databind(this.source,t),void s(t);(this.autoBind||!this.autoBind&&!t)&&(this.field&&this.loadSelectTag(),this.items=this.loadItems(this.source)),this._raiseEvent("6"),this._render(!1,1==t),s(t)}},loadSelectTag:function(){var t=e.jqx.parseSourceTag(this.field);this.source=t.items,-1==this.selectedIndex&&(this.selectedIndex=t.index)},_render:function(e){return this._addItems(),this._renderItems(),this.vScrollInstance.setPosition(0),this._cachedItemHtml=new Array,(void 0==e||e)&&void 0!=this.items&&null!=this.items&&this.selectedIndex>=0&&this.selectedIndex<this.items.length&&this.selectIndex(this.selectedIndex,!0,!0,!0),this.allowDrag&&this._enableDragDrop&&(this._enableDragDrop(),this.isTouchDevice())?(this._removeHandlers(),this.overlayContent&&(this.overlayContent.remove(),this.overlayContent=null),this._updateTouchScrolling(),void this._addHandlers()):(this._updateTouchScrolling(),this.rendered&&this.rendered(),void(this.ready&&this.ready()))},_hitTest:function(e,t){this.filterable&&(t-=this.filterHeight,0>t&&(t=0));var i=parseInt(this.vScrollInstance.value),s=this._searchFirstVisibleIndex(t+i,this.renderedVisibleItems);if(void 0!=this.renderedVisibleItems[s]&&this.renderedVisibleItems[s].isGroup)return null;if(this.renderedVisibleItems.length>0){var l=this.renderedVisibleItems[this.renderedVisibleItems.length-1];if(l.height+l.top<t+i)return null}return s=this._searchFirstVisibleIndex(t+i),this.visibleItems[s]},_searchFirstVisibleIndex:function(e,t){void 0==e&&(e=parseInt(this.vScrollInstance.value));var i=0;(void 0==t||null==t)&&(t=this.visibleItems);for(var s=t.length;s>=i;){mid=parseInt((i+s)/2);var l=t[mid];if(void 0==l)break;if(l.initialTop>e&&l.initialTop+l.height>e)s=mid-1;else{if(!(l.initialTop<e&&l.initialTop+l.height<=e))return mid;i=mid+1}}return 0},_renderItems:function(){if(void 0==this.items||0==this.items.length)return void(this.visibleItems=new Array);if(1!=this.updatingListBox){var t=this.isTouchDevice(),i=this.vScrollInstance,s=this.hScrollInstance,l=parseInt(i.value),r=parseInt(s.value);this.rtl&&"hidden"!=this.hScrollBar[0].style.visibility&&(r=s.max-r);var n=(this.items.length,this.host.width(),parseInt(this.content[0].style.width)),a=n+parseInt(s.max),h=parseInt(this.vScrollBar[0].style.width)+2;"hidden"==this.vScrollBar[0].style.visibility&&(h=0),"visible"!=this.hScrollBar[0].style.visibility&&(a=n);var o=(this._getVirtualItemsCount(),new Array),d=0,c=parseInt(this.element.style.height)+2;-1!=this.element.style.height.indexOf("%")&&(c=this.host.outerHeight()),isNaN(c)&&(c=0);var u=0,v=0,m=0;if(0==i.value||0==this.visibleItems.length)for(var p=0;p<this.items.length;p++){var g=this.items[p];if(g.visible){g.top=-l,g.initialTop=-l,!g.isGroup&&g.visible&&(this.visibleItems[v++]=g,g.visibleIndex=v-1),this.renderedVisibleItems[m++]=g,g.left=-r;var f=g.top+g.height;f>=0&&g.top-g.height<=c&&(o[d++]={index:p,item:g}),l-=g.height}}var x=l>0?this._searchFirstVisibleIndex(this.vScrollInstance.value,this.renderedVisibleItems):0,b=0;d=0;for(var I=this.vScrollInstance.value,y=0;100+c>b;){var g=this.renderedVisibleItems[x];if(void 0==g)break;if(g.visible){g.left=-r;var f=g.top+g.height-I;f>=0&&g.initialTop-I-g.height<=2*c&&(o[d++]={index:x,item:g})}if(x++,g.visible&&(b+=g.initialTop-I+g.height-b),y++,y>this.items.length-1)break}for(var S=this.toThemeProperty("jqx-listitem-state-normal")+" "+this.toThemeProperty("jqx-item"),_=this.toThemeProperty("jqx-listitem-state-group"),w=this.toThemeProperty("jqx-listitem-state-disabled")+" "+this.toThemeProperty("jqx-fill-state-disabled"),k=0,q=this,p=0;p<this.visualItems.length;p++){var B=this.visualItems[p],j=function(){var e=B[0].firstChild;if(q.checkboxes&&(e=B[0].lastChild),null!=e&&(e.style.visibility="hidden",e.className=""),q.checkboxes){var t=B.find(".chkbox");t.css({visibility:"hidden"})}};if(p<o.length){var g=o[p].item;if(g.initialTop-I>=c){j();continue}var T=e(B[0].firstChild);if(this.checkboxes&&(T=e(B[0].lastChild)),0==T.length)continue;if(null==T[0])continue;T[0].className="",T[0].style.display="block",T[0].style.visibility="inherit";var H="";if(H=!g.isGroup&&!this.selectedIndexes[g.index]>=0?S:_,(g.disabled||this.disabled)&&(H+=" "+w),this.roundedcorners&&(H+=" "+this.toThemeProperty("jqx-rc-all")),t&&(H+=" "+this.toThemeProperty("jqx-listitem-state-normal-touch")),T[0].className=H,this.renderer)if(g.key||(g.key=this.generatekey()),this._cachedItemHtml||(this._cachedItemHtml=new Array),this._cachedItemHtml[g.key])T[0].innerHTML!=this._cachedItemHtml[g.key]&&(T[0].innerHTML=this._cachedItemHtml[g.key]);else{var C=this.renderer(g.index,g.label,g.value);T[0].innerHTML=C,this._cachedItemHtml[g.key]=T[0].innerHTML}else{if(-1!==this.itemHeight){var P=2+2*parseInt(T.css("padding-top"));T[0].style.lineHeight=g.height-P+"px",T.css("vertical-align","middle")}null!=g.html&&g.html.toString().length>0?T[0].innerHTML=g.html:null!=g.label||null!=g.value?null!=g.label?(T[0].innerHTML!==g.label&&(T[0].innerHTML=g.label),""==e.trim(g.label)&&(T[0].innerHTML=this.emptyString,""==this.emptyString&&(T[0].style.height=g.height-8+"px")),this.incrementalSearch||g.disabled||void 0!=this.searchString&&""!=this.searchString&&(T[0].innerHTML=this._highlight(g.label.toString(),this.searchString))):null===g.label?(T[0].innerHTML=this.emptyString,""==this.emptyString&&(T[0].style.height=g.height-8+"px")):T[0].innerHTML!==g.value?T[0].innerHTML=g.value:""==g.label&&(T[0].innerHTML=" "):(""==g.label||null==g.label)&&(T[0].innerHTML="",T[0].style.height=g.height-8+"px")}if(B[0].style.left=g.left+"px",B[0].style.top=g.initialTop-I+"px",g.element=T[0],g.title&&(T[0].title=g.title),this.equalItemsWidth&&!g.isGroup){if(0==u){var M=parseInt(a),V=parseInt(T.outerWidth())-parseInt(T.width());M-=V;var D=1;D=null!=D?parseInt(D):0,M-=2*D,u=M,this.checkboxes&&"hidden"==this.hScrollBar[0].style.visibility&&(u-=18)}n>this.virtualSize.width?(T[0].style.width=u+"px",g.width=u):(T[0].style.width=-4+this.virtualSize.width+"px",g.width=this.virtualSize.width-4)}else T.width()<this.host.width()&&T.width(this.host.width()-2);if(this.rtl&&(T[0].style.textAlign="right"),this.autoItemsHeight&&(T[0].style.whiteSpace="normal",T.width(u),g.width=u),k=0,this.checkboxes&&!g.isGroup){0==k&&(k=(g.height-16)/2,k++);var A=e(B.children()[0]);A[0].item=g,this.rtl?"0px"!=T[0].style.left&&(T[0].style.left="0px"):"18px"!=T[0].style.left&&(T[0].style.left="18px"),this.rtl&&A.css("left",8+g.width+"px"),A[0].style.top=k+"px",A[0].style.display="block",A[0].style.visibility="inherit";var L=g.checked,E=g.checked?" "+this.toThemeProperty("jqx-checkbox-check-checked"):"";A[0].firstChild&&A[0].firstChild.firstChild&&A[0].firstChild.firstChild.firstChild&&A[0].firstChild.firstChild&&(L?A[0].firstChild.firstChild.firstChild.className=E:L===!1?A[0].firstChild.firstChild.firstChild.className="":null===L&&(A[0].firstChild.firstChild.firstChild.className=this.toThemeProperty("jqx-checkbox-check-indeterminate"))),e.jqx.ariaEnabled&&(L?B[0].setAttribute("aria-selected",!0):B[0].removeAttribute("aria-selected"))}else if(this.checkboxes){var A=e(B.children()[0]);A.css({display:"none",visibility:"inherit"})}!g.disabled&&(!this.filterable&&this.selectedIndexes[g.visibleIndex]>=0||g.selected&&this.filterable)?(T.addClass(this.toThemeProperty("jqx-listitem-state-selected")),T.addClass(this.toThemeProperty("jqx-fill-state-pressed")),e.jqx.ariaEnabled&&(B[0].setAttribute("aria-selected",!0),this._activeElement=B[0])):this.checkboxes||e.jqx.ariaEnabled&&B[0].removeAttribute("aria-selected")}else j()}}},generatekey:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},_calculateVirtualSize:function(){var t=0,i=2,s=0,l=e("<span></span>");this.equalItemsWidth&&l.css("float","left");var r=0,n=this.host.outerHeight();e(document.body).append(l);var a=this.items.length,h=this.host.width();if(this.autoItemsHeight&&(h-=10,"hidden"!=this.vScrollBar.css("visibility")&&(h-=20)),this.autoItemsHeight||this.renderer||this.groups.length>1||a>0&&null!=this.items[0].html&&""!=this.items[0].html)for(var s=0;a>s;s++){var o=this.items[s];if((!o.isGroup||""!=o.label||""!=o.html)&&o.visible){var d="";if(d+=this.toThemeProperty(o.isGroup?"jqx-listitem-state-group jqx-rc-all":"jqx-listitem-state-normal jqx-rc-all"),d+=" "+this.toThemeProperty("jqx-fill-state-normal"),this.isTouchDevice()&&(d+=" "+this.toThemeProperty("jqx-touch")),l[0].className=d,this.autoItemsHeight){l[0].style.whiteSpace="normal";var c=this.checkboxes?-20:0;l[0].style.width=c+h+"px"}if(this.renderer){var u=this.renderer(o.index,o.label,o.value);l[0].innerHTML=u}else null!=o.html&&o.html.toString().length>0?l[0].innerHTML=o.html:(null!=o.label||null!=o.value)&&(null!=o.label?(l[0].innerHTML=o.label,""==o.label&&(l[0].innerHTML="Empty")):l[0].innerHTML=o.value);var v=l.outerHeight(),m=l.outerWidth();this.itemHeight>-1&&(v=this.itemHeight),o.height=v,o.width=m,i+=v,t=Math.max(t,m),n>=i&&r++}}else{for(var i=0,p=0,g="",f=0,x=0,b=-1,s=0;a>s;s++){var o=this.items[s];if((!o.isGroup||""!=o.label||""!=o.html)&&o.visible){b++;var d="";if(0==b){if(d+=this.toThemeProperty("jqx-listitem-state-normal jqx-rc-all"),d+=" "+this.toThemeProperty("jqx-fill-state-normal"),d+=" "+this.toThemeProperty("jqx-widget"),d+=" "+this.toThemeProperty("jqx-listbox"),d+=" "+this.toThemeProperty("jqx-widget-content"),this.isTouchDevice()&&(d+=" "+this.toThemeProperty("jqx-touch"),d+=" "+this.toThemeProperty("jqx-listitem-state-normal-touch")),l[0].className=d,this.autoItemsHeight){l[0].style.whiteSpace="normal";var c=this.checkboxes?-20:0;l[0].style.width=c+h+"px"}null==o.html||""==o.label||null==o.label?l[0].innerHTML="Item":null!=o.html&&o.html.toString().length>0?l[0].innerHTML=o.html:(null!=o.label||null!=o.value)&&(l[0].innerHTML=null!=o.label?null!=o.label.toString().match(new RegExp("\\w"))||null!=o.label.toString().match(new RegExp("\\d"))?o.label:"Item":o.value);var v=1+l.outerHeight();this.itemHeight>-1&&(v=this.itemHeight),p=v}void 0!=f&&(x=f),null!=o.html&&o.html.toString().length>0?(f=Math.max(f,o.html.toString().length),x!=f&&(g=o.html)):null!=o.label?(f=Math.max(f,o.label.length),x!=f&&(g=o.label)):null!=o.value&&(f=Math.max(f,o.value.length),x!=f&&(g=o.value)),o.height=p,i+=p,n>=i&&r++}}l[0].innerHTML=g,t=l.outerWidth()}return i+=2,10>r&&(r=10),this.filterable&&(i+=this.filterHeight),l.remove(),{width:t,height:i,itemsPerPage:r}},_getVirtualItemsCount:function(){if(0==this.virtualItemsCount){var e=parseInt(this.host.height())/5;return e>this.items.length&&(e=this.items.length),e}return this.virtualItemsCount},_addItems:function(t){var i=this;if(1!=i.updatingListBox){if(void 0==i.items||0==i.items.length)return i.virtualSize={width:0,height:0,itemsPerPage:0},i._updatescrollbars(),i.renderedVisibleItems=new Array,void(i.itemswrapper&&i.itemswrapper.children().remove());if(0==t){var s=i._calculateVirtualSize(),l=2*s.itemsPerPage;i.autoHeight&&(l=i.items.length),i.virtualItemsCount=Math.min(l,i.items.length);{s.width}return i.virtualSize=s,void i._updatescrollbars()}var r=this,n=0;i.visibleItems=new Array,i.renderedVisibleItems=new Array,i._removeHandlers(),i.allowDrag&&i._enableDragDrop&&(i.itemswrapper=null),null==i.itemswrapper&&(i.content[0].innerHTML="",i.itemswrapper=e('<div style="outline: 0 none; overflow:hidden; width:100%; position: relative;"></div>'),i.itemswrapper.height(2*i.host.height()),i.content.append(i.itemswrapper));var s=i._calculateVirtualSize(),l=2*s.itemsPerPage;i.autoHeight&&(l=i.items.length),i.virtualItemsCount=Math.min(l,i.items.length);{var i=this;s.width}i.virtualSize=s,i.itemswrapper.width(Math.max(i.host.width(),17+s.width));for(var a=0,h="",o=e.jqx.browser.msie&&e.jqx.browser.version<9,d=o?' unselectable="on"':"",c=a;c<i.virtualItemsCount;c++){var u=i.items[c],v="listitem"+c+i.element.id;if(h+="<div"+d+" role='option' id='"+v+"' class='jqx-listitem-element'>",i.checkboxes){h+='<div style="background-color: transparent; padding: 0; margin: 0; position: absolute; float: left; width: 16px; height: 16px;" class="chkbox">';var m='<div class="'+i.toThemeProperty("jqx-checkbox-default")+" "+i.toThemeProperty("jqx-fill-state-normal")+" "+i.toThemeProperty("jqx-rc-all")+'"><div style="cursor: pointer; width: 13px; height: 13px;">',p=u.checked?" "+i.toThemeProperty("jqx-checkbox-check-checked"):"";m+='<span style="width: 13px; height: 13px;" class="checkBoxCheck'+p+'"></span>',m+="</div></div>",h+=m,h+="</div>"}h+="<span"+d+" style='-ms-touch-action: none;'></span></div>"}r.WinJS?i.itemswrapper.html(h):i.itemswrapper[0].innerHTML=h;for(var g=i.itemswrapper.children(),c=a;c<i.virtualItemsCount;c++){var u=i.items[c],f=e(g[c]);if(i.allowDrag&&i._enableDragDrop&&f.addClass("draggable"),i.checkboxes){{e(f.children()[0])}f.css("float","left");var x=e(f[0].firstChild);x.css("float","left")}f[0].style.height=u.height+"px",f[0].style.top=n+"px",n+=u.height,i.visualItems[c]=f}if(i._addHandlers(),i._updatescrollbars(),i.autoItemsHeight){var s=i._calculateVirtualSize(),l=2*s.itemsPerPage;i.autoHeight&&(l=i.items.length),i.virtualItemsCount=Math.min(l,i.items.length);{var i=this;s.width}i.virtualSize=s,i._updatescrollbars()}e.jqx.browser.msie&&e.jqx.browser.version<8&&(i.host.attr("hideFocus",!0),i.host.find("div").attr("hideFocus",!0))}},_updatescrollbars:function(){var t=this;if(t.virtualSize){var i=t.virtualSize.height,s=t.virtualSize.width,l=t.vScrollInstance,r=t.hScrollInstance;t._arrange(!1);var n=!1,a=t.host.outerWidth(),h=t.host.outerHeight(),o=0;if(s>a&&(o=t.hScrollBar.outerHeight()+2),i+o>h){var d=l.max;l.max=2+parseInt(i)+o-parseInt(h-2),"inherit"!=t.vScrollBar[0].style.visibility&&(t.vScrollBar[0].style.visibility="inherit",n=!0),d!=l.max&&l._arrange()}else"hidden"!=t.vScrollBar[0].style.visibility&&(t.vScrollBar[0].style.visibility="hidden",n=!0,l.setPosition(0));var c=0;"hidden"!=t.vScrollBar[0].style.visibility&&(c=t.scrollBarSize+6);var u=t.checkboxes?20:0;if(t.autoItemsHeight)t.hScrollBar[0].style.visibility="hidden";else if(s>=a-c-u){var v=r.max;r.max="inherit"==t.vScrollBar[0].style.visibility?u+c+parseInt(s)-t.host.width()+4:u+parseInt(s)-t.host.width()+6,"inherit"!=t.hScrollBar[0].style.visibility&&(t.hScrollBar[0].style.visibility="inherit",n=!0),v!=r.max&&r._arrange(),"inherit"==t.vScrollBar[0].style.visibility&&(l.max=2+parseInt(i)+t.hScrollBar.outerHeight()+2-parseInt(t.host.height()))}else"hidden"!=t.hScrollBar[0].style.visibility&&(t.hScrollBar[0].style.visibility="hidden",n=!0);r.setPosition(0),n&&t._arrange(),t.itemswrapper&&(t.itemswrapper[0].style.width=Math.max(0,Math.max(a-2,17+s))+"px",t.itemswrapper[0].style.height=Math.max(0,2*h)+"px");var m=t.isTouchDevice();m&&("visible"!=t.vScrollBar.css("visibility")&&"visible"!=t.hScrollBar.css("visibility")?e.jqx.mobile.setTouchScroll(!1,t.element.id):e.jqx.mobile.setTouchScroll(!0,t.element.id))}},clear:function(){this.source=null,this.clearSelection(),this.refresh()},clearSelection:function(e){for(var t=0;t<this.selectedIndexes.length;t++)this.selectedIndexes[t]&&-1!=this.selectedIndexes[t]&&this._raiseEvent("1",{index:t,type:"api",item:this.getVisibleItem(t),originalEvent:null}),this.selectedIndexes[t]=-1;this.selectedIndex=-1,this.selectedValue=null,this.selectedValues=new Array,0!=e&&this._renderItems()},unselectIndex:function(e,t){if(!isNaN(e)){this.selectedIndexes[e]=-1;for(var i=!1,s=0;s<this.selectedIndexes.length;s++){var e=this.selectedIndexes[s];-1!=e&&void 0!=e&&(i=!0)}i||(this.selectedValue=null,this.selectedIndex=-1,this.selectedValues[this.getVisibleItem(e).value]&&(this.selectedValues[this.getVisibleItem(e).value]=null)),(void 0==t||1==t)&&(this._renderItems(),this._raiseEvent("1",{index:e,type:"api",item:this.getVisibleItem(e),originalEvent:null})),this._updateInputSelection(),this._raiseEvent("2",{index:e,type:"api",item:this.getItem(e)})}},getInfo:function(){var e=this,t=this.getItems(),i=this.getVisibleItems(),s=function(){var t=e.vScrollInstance.value;e.filterable&&(t-=e.filterHeight);for(var s=new Array,l=0;l<i.length;l++){var r=i[l];if(r){var n=r.initialTop,a=r.height,h=!0;(0>n+a-t||n-t>=e.host.height())&&(h=!1),h&&s.push(r)}}return s}();return{items:t,visibleItems:i,viewItems:s}},getItem:function(t){if(-1==t||isNaN(t)||"string"==typeof t)return-1===t?null:this.getItemByValue(t);{var i=null;e.each(this.items,function(){return this.index==t?(i=this,!1):void 0})}return i},getVisibleItem:function(e){return-1==e||isNaN(e)||"string"==typeof e?-1===e?null:this.getItemByValue(e):this.visibleItems[e]},getVisibleItems:function(){return this.visibleItems},checkIndex:function(t,i,s){if(this.checkboxes&&!isNaN(t)&&!(0>t||t>=this.visibleItems.length||null!=this.visibleItems[t]&&this.visibleItems[t].disabled||this.disabled)){var l=this.getItem(t);if(this.groups.length>0||this.filterable)var l=this.getVisibleItem(t);if(null!=l){{e(l.checkBoxElement)}l.checked=!0,(void 0==i||1==i)&&this._updateCheckedItems()}(void 0==s||1==s)&&this._raiseEvent(3,{label:l.label,value:l.value,checked:!0,item:l})}},getCheckedItems:function(){if(!this.checkboxes)return null;var t=new Array;if(void 0!=this.items)return e.each(this.items,function(){this.checked&&(t[t.length]=this)}),t},checkAll:function(t){if(this.checkboxes&&!this.disabled){var i=this;e.each(this.items,function(){var e=this;t!==!1&&e.checked!==!0&&i._raiseEvent(3,{label:e.label,value:e.value,checked:!0,item:e}),this.checked=!0}),this._updateCheckedItems()}},uncheckAll:function(t){if(this.checkboxes&&!this.disabled){var i=this;e.each(this.items,function(){var e=this;t!==!1&&e.checked!==!1&&(this.checked=!1,i._raiseEvent(3,{label:e.label,value:e.value,checked:!1,item:e})),this.checked=!1}),this._updateCheckedItems()}},uncheckIndex:function(t,i,s){if(this.checkboxes&&!isNaN(t)&&!(0>t||t>=this.visibleItems.length||null!=this.visibleItems[t]&&this.visibleItems[t].disabled||this.disabled)){var l=this.getItem(t);if(this.groups.length>0||this.filterable)var l=this.getVisibleItem(t);if(null!=l){{e(l.checkBoxElement)}l.checked=!1,(void 0==i||1==i)&&this._updateCheckedItems()}(void 0==s||1==s)&&this._raiseEvent(3,{label:l.label,value:l.value,checked:!1,item:l})}},indeterminateIndex:function(t,i,s){if(this.checkboxes&&!isNaN(t)&&!(0>t||t>=this.visibleItems.length||null!=this.visibleItems[t]&&this.visibleItems[t].disabled||this.disabled)){var l=this.getItem(t);if(this.groups.length>0||this.filterable)var l=this.getVisibleItem(t);if(null!=l){{e(l.checkBoxElement)}l.checked=null,(void 0==i||1==i)&&this._updateCheckedItems()}(void 0==s||1==s)&&this._raiseEvent(3,{checked:null})}},getSelectedIndex:function(){return this.selectedIndex},getSelectedItems:function(){var e=this.getVisibleItems(),t=this.selectedIndexes,i=[];for(var s in t)-1!=t[s]&&(i[i.length]=e[s]);return i},getSelectedItem:function(){return this.getItem(this.selectedIndex)},_updateCheckedItems:function(){var t=this.selectedIndex;this.clearSelection(!1);this.getCheckedItems();this.selectedIndex=t,this._renderItems();var i=e.data(this.element,"hoveredItem");null!=i&&(e(i).addClass(this.toThemeProperty("jqx-listitem-state-hover")),e(i).addClass(this.toThemeProperty("jqx-fill-state-hover"))),this._updateInputSelection()},getItemByValue:function(t){if(null!=this.visibleItems){if(t&&t.value&&(t=t.value),this.itemsByValue)return this.itemsByValue[e.trim(t).split(" ").join("")];for(var i=this.visibleItems,s=0;s<i.length;s++)if(i[s].value==t)return i[s]}},checkItem:function(e){if(null!=e){var t=this._getItemByParam(e);return this.checkIndex(t.index,!0)}return!1},uncheckItem:function(e){if(null!=e){var t=this._getItemByParam(e);return this.uncheckIndex(t.index,!0)}return!1},indeterminateItem:function(e){if(null!=e){var t=this._getItemByParam(e);return this.indeterminateIndex(t.index,!0)}return!1},val:function(e){if(this.input){var t=function(t){for(var i in t)if(t.hasOwnProperty(i))return!1;return"number"==typeof e?!1:"date"==typeof e?!1:"boolean"==typeof e?!1:"string"==typeof e?!1:!0};if(t(e)||0==arguments.length)return this.input.val();var i=this.getItemByValue(e);return null!=i&&this.selectItem(i),this.input?this.input.val():void 0}},selectItem:function(e){if(null!=e){if(void 0==e.index){var t=this.getItemByValue(e);t&&(e=t)}return this.selectIndex(e.visibleIndex,!0)}return!1},unselectItem:function(e){if(null!=e){if(void 0==e.index){var t=this.getItemByValue(e);t&&(e=t)}return this.unselectIndex(e.visibleIndex,!0)}return!1},selectIndex:function(e,t,i,s,l,r){if(!(isNaN(e)||(this.filterable&&(this.selectedIndex=-1),-1>e||e>=this.visibleItems.length||null!=this.visibleItems[e]&&this.visibleItems[e].disabled||this.disabled))){if(!this.multiple&&!this.multipleextended&&this.selectedIndex==e&&!s)return void(this.visibleItems&&this.items&&this.visibleItems.length!=this.items.length&&(h=this.getVisibleItem(e),h&&(this.selectedValue=h.value,this.selectedValues[h.value]=h.value)));if(this.checkboxes)return void this._updateCheckedItems();this.focused=!0;var n=!1;this.selectedIndex!=e&&(n=!0);var a=this.selectedIndex;this.selectedIndex!=e||this.multiple||(a=-1),void 0==l&&(l="none");
var h=this.getItem(e),o=this.getItem(a);if(this.visibleItems&&this.items&&this.visibleItems.length!=this.items.length&&(h=this.getVisibleItem(e),o=this.getVisibleItem(a)),void 0!=s&&s)this._raiseEvent("1",{index:a,type:l,item:o,originalEvent:r}),this.selectedIndex=e,this.selectedIndexes[a]=-1,this.selectedIndexes[e]=e,h&&(this.selectedValue=h.value,this.selectedValues[h.value]=h.value),this._raiseEvent("0",{index:e,type:l,item:h,originalEvent:r});else{var d=this,c=function(e,t,i,s,l,r){d._raiseEvent("1",{index:t,type:i,item:s,originalEvent:r}),d.selectedIndex=e,d.selectedIndexes=[],t=e,d.selectedIndexes[e]=e,d.selectedValues=new Array,l&&(d.selectedValues[l.value]=l.value),d._raiseEvent("0",{index:e,type:i,item:l,originalEvent:r})},u=function(e,t,i,s,l,r){void 0==d.selectedIndexes[e]||-1==d.selectedIndexes[e]?(d.selectedIndexes[e]=e,d.selectedIndex=e,l&&(d.selectedValues[l.value]=l.value,d._raiseEvent("0",{index:e,type:i,item:l,originalEvent:r}))):(t=d.selectedIndexes[e],s=d.getVisibleItem(t),s&&(d.selectedValues[s.value]=null),d.selectedIndexes[e]=-1,d.selectedIndex=-1,d._raiseEvent("1",{index:t,type:i,item:s,originalEvent:r}))};if(this.multipleextended)if(this._shiftKey||this._ctrlKey){if(this._ctrlKey)"keyboard"==l&&(this.clearSelection(!1),d._clickedIndex=e),u(e,a,l,o,h,r);else if(this._shiftKey){void 0==d._clickedIndex&&(d._clickedIndex=a);var v=Math.min(d._clickedIndex,e),m=Math.max(d._clickedIndex,e);this.clearSelection(!1);for(var p=v;m>=p;p++)d.selectedIndexes[p]=p,d.selectedValues[d.getVisibleItem(p).value]=d.getVisibleItem(p).value,d._raiseEvent("0",{index:p,type:l,item:this.getVisibleItem(p),originalEvent:r});d.selectedIndex="keyboard"!=l?d._clickedIndex:e}}else"keyboard"!=l&&"mouse"!=l?(u(e,a,l,o,h,r),d._clickedIndex=e):(this.clearSelection(!1),d._clickedIndex=e,c(e,a,l,o,h,r));else this.multiple?u(e,a,l,o,h,r):(h&&(this.selectedValue=h.value),c(e,a,l,o,h,r))}return(void 0==i||1==i)&&this._renderItems(),void 0!=t&&null!=t&&1==t&&this.ensureVisible(e),this._raiseEvent("2",{index:e,item:h,oldItem:o,type:l,originalEvent:r}),this._updateInputSelection(),n}},_updateInputSelection:function(){this._syncSelection();var t=new Array;if(this.input&&(-1==this.selectedIndex?this.input.val(""):this.items&&void 0!=this.items[this.selectedIndex]&&(this.input.val(this.items[this.selectedIndex].value),t.push(this.items[this.selectedIndex].value)),this.multiple||this.multipleextended||this.checkboxes)){var i=this.checkboxes?this.getCheckedItems():this.getSelectedItems(),s="";if(i){for(var l=0;l<i.length;l++)void 0!=i[l]&&(s+=l==i.length-1?i[l].value:i[l].value+",",t.push(i[l].value));this.input.val(s)}}this.field&&this.input&&("select"==this.field.nodeName.toLowerCase()?e.each(this.field,function(){e(this).removeAttr("selected"),this.selected=t.indexOf(this.value)>=0,this.selected&&e(this).attr("selected",!0)}):e.each(this.items,function(){e(this.originalItem.originalItem).removeAttr("data-selected"),this.selected=t.indexOf(this.value)>=0,this.selected&&e(this.originalItem.originalItem).attr("data-selected",!0)}))},isIndexInView:function(e){if(isNaN(e))return!1;if(!this.items)return!1;if(0>e||e>=this.items.length)return!1;var t=this.vScrollInstance.value;this.filterable&&(t-=this.filterHeight);var i=this.visibleItems[e];if(void 0==i)return!0;var s=i.initialTop,l=i.height;return 0>s-t||s-t+l>=this.host.outerHeight()?!1:!0},_itemsInPage:function(){var t=0,i=this;return this.items&&e.each(this.items,function(){return this.initialTop+this.height>=i.content.height()?!1:void t++}),t},_firstItemIndex:function(){return null!=this.visibleItems?this.visibleItems[0]&&this.visibleItems[0].isGroup?this._nextItemIndex(0):0:-1},_lastItemIndex:function(){return null!=this.visibleItems?this.visibleItems[this.visibleItems.length-1]&&this.visibleItems[this.visibleItems.length-1].isGroup?this._prevItemIndex(this.visibleItems.length-1):this.visibleItems.length-1:-1},_nextItemIndex:function(e){for(indx=e+1;indx<this.visibleItems.length;indx++)if(this.visibleItems[indx]&&!this.visibleItems[indx].disabled&&!this.visibleItems[indx].isGroup)return indx;return-1},_prevItemIndex:function(e){for(indx=e-1;indx>=0;indx--)if(this.visibleItems[indx]&&!this.visibleItems[indx].disabled&&!this.visibleItems[indx].isGroup)return indx;return-1},clearFilter:function(){this.filterInput.val(""),this._updateItemsVisibility("")},_search:function(e){var t=this,i=t.filterInput.val();return 9!=e.keyCode&&"none"!=t.searchMode&&null!=t.searchMode&&"undefined"!=t.searchMode&&16!=e.keyCode&&17!=e.keyCode&&20!=e.keyCode?37==e.keyCode||39==e.keyCode?!1:void(e.altKey||18==e.keyCode||e.keyCode>=33&&e.keyCode<=40||(e.ctrlKey||e.metaKey||t.ctrlKey)&&88!=e.keyCode&&86!=e.keyCode||i!==t.searchString&&t._updateItemsVisibility(i)):void 0},_updateItemsVisibility:function(t){var i=this.getItems();if(void 0==i)return{index:-1,matchItem:new Array};var s=this,l=-1,r=new Array,n=0;e.each(i,function(){var i="";if(!this.isGroup){i=this.searchLabel?this.searchLabel:this.label?this.label:this.value?this.value:this.title?this.title:"jqxItem",i=i.toString();var a=!1;switch(s.searchMode){case"containsignorecase":a=e.jqx.string.containsIgnoreCase(i,t);break;case"contains":a=e.jqx.string.contains(i,t);break;case"equals":a=e.jqx.string.equals(i,t);break;case"equalsignorecase":a=e.jqx.string.equalsIgnoreCase(i,t);break;case"startswith":a=e.jqx.string.startsWith(i,t);break;case"startswithignorecase":a=e.jqx.string.startsWithIgnoreCase(i,t);break;case"endswith":a=e.jqx.string.endsWith(i,t);break;case"endswithignorecase":a=e.jqx.string.endsWithIgnoreCase(i,t)}a||(this.visible=!1),a&&(r[n++]=this,this.visible=!0,l=this.visibleIndex),""==t&&(this.visible=!0,a=!1)}}),s.renderedVisibleItems=new Array,s.visibleItems=new Array,s.vScrollInstance.setPosition(0,!0),s._addItems(!1),s._renderItems();for(var a=0;a<s.items.length;a++)s.selectedIndexes[a]=-1;s.selectedIndex=-1;for(var h in s.selectedValues){var t=s.selectedValues[h],o=s.getItemByValue(t);o&&o.visible&&(s.selectedIndex=o.visibleIndex,s.selectedIndexes[o.visibleIndex]=o.visibleIndex)}s._syncSelection()},_getMatches:function(t,i){if(void 0==t||0==t.length)return-1;void 0==i&&(i=0);var s=this.getItems(),l=this,r=-1;return e.each(s,function(){var s="";if(!this.isGroup){s=this.label?this.label.toString():this.value?this.value.toString():this.title?this.title.toString():"jqxItem";var n=!1;switch(l.searchMode){case"containsignorecase":n=e.jqx.string.containsIgnoreCase(s,t);break;case"contains":n=e.jqx.string.contains(s,t);break;case"equals":n=e.jqx.string.equals(s,t);break;case"equalsignorecase":n=e.jqx.string.equalsIgnoreCase(s,t);break;case"startswith":n=e.jqx.string.startsWith(s,t);break;case"startswithignorecase":n=e.jqx.string.startsWithIgnoreCase(s,t);break;case"endswith":n=e.jqx.string.endsWith(s,t);break;case"endswithignorecase":n=e.jqx.string.endsWithIgnoreCase(s,t)}if(n&&this.visibleIndex>=i)return r=this.visibleIndex,!1}}),r},findItems:function(t){var i=this.getItems(),s=this,l=0,r=new Array;return e.each(i,function(){var i="";if(!this.isGroup){i=this.label?this.label:this.value?this.value:this.title?this.title:"jqxItem";var n=!1;switch(s.searchMode){case"containsignorecase":n=e.jqx.string.containsIgnoreCase(i,t);break;case"contains":n=e.jqx.string.contains(i,t);break;case"equals":n=e.jqx.string.equals(i,t);break;case"equalsignorecase":n=e.jqx.string.equalsIgnoreCase(i,t);break;case"startswith":n=e.jqx.string.startsWith(i,t);break;case"startswithignorecase":n=e.jqx.string.startsWithIgnoreCase(i,t);break;case"endswith":n=e.jqx.string.endsWith(i,t);break;case"endswithignorecase":n=e.jqx.string.endsWithIgnoreCase(i,t)}n&&(r[l++]=this)}}),r},_syncSelection:function(){var e=this;if(e.filterable){for(var t=0;t<e.items.length;t++){var i=e.items[t];i.selected=!1}for(var t=0;t<e.visibleItems.length;t++){var i=e.visibleItems[t];e.selectedIndexes&&e.selectedIndexes[t]==i.visibleIndex&&(i.selected=!0)}e.itemswrapper&&e._renderItems()}},_handleKeyDown:function(e){var t=e.keyCode,i=this,s=i.selectedIndex,l=i.selectedIndex;if(this.keyboardNavigation&&this.enableSelection&&(!this.filterInput||e.target!=this.filterInput[0])){var r=function(){i.multiple&&i.clearSelection(!1)};if(e.altKey&&(t=-1),i.incrementalSearch){var n=-1;i._searchString||(i._searchString=""),(8==t||46==t)&&i._searchString.length>=1&&(i._searchString=i._searchString.substr(0,i._searchString.length-1));var a=String.fromCharCode(t),h=!isNaN(parseInt(a)),o=!1;if(t>=65&&97>=t||h||8==t||32==t||46==t){e.shiftKey||(a=a.toLocaleLowerCase());var d=1+i.selectedIndex;8!=t&&32!=t&&46!=t&&(i._searchString.length>0&&i._searchString.substr(0,1)==a?d=1+i.selectedIndex:i._searchString+=a),32==t&&(i._searchString+=" ");var c=this._getMatches(i._searchString,d);if(n=c,n==i._lastMatchIndex||-1==n){var c=this._getMatches(i._searchString,0);n=c}if(i._lastMatchIndex=n,n>=0){var u=function(){r(),i.selectIndex(n,!1,!1,!1,"keyboard",e);var t=i.isIndexInView(n);t?i._renderItems():i.ensureVisible(n)};i._toSelectTimer&&clearTimeout(i._toSelectTimer),i._toSelectTimer=setTimeout(function(){u()},i.incrementalSearchKeyDownDelay)}o=!0}if(void 0!=i._searchTimer&&clearTimeout(i._searchTimer),(27==t||13==t)&&(i._searchString=""),i._searchTimer=setTimeout(function(){i._searchString="",i._renderItems()},i.incrementalSearchDelay),n>=0)return;if(o)return!1}if(this.checkboxes)return!0;if(33==t){var v=i._itemsInPage();i.selectedIndex-v>=0?(r(),i.selectIndex(l-v,!1,!1,!1,"keyboard",e)):(r(),i.selectIndex(i._firstItemIndex(),!1,!1,!1,"keyboard",e)),i._searchString=""}if(32==t&&this.checkboxes){var m=this.getItem(s);null!=m&&(i._updateItemCheck(m,s),e.preventDefault()),i._searchString=""}if(36==t&&(r(),i.selectIndex(i._firstItemIndex(),!1,!1,!1,"keyboard",e),i._searchString=""),35==t&&(r(),i.selectIndex(i._lastItemIndex(),!1,!1,!1,"keyboard",e),i._searchString=""),34==t){var v=i._itemsInPage();i.selectedIndex+v<i.visibleItems.length?(r(),i.selectIndex(l+v,!1,!1,!1,"keyboard",e)):(r(),i.selectIndex(i._lastItemIndex(),!1,!1,!1,"keyboard",e)),i._searchString=""}if(38==t){if(i._searchString="",!(i.selectedIndex>0))return!1;var p=i._prevItemIndex(i.selectedIndex);if(p==i.selectedIndex||-1==p)return!0;r(),i.selectIndex(p,!1,!1,!1,"keyboard",e)}else if(40==t){if(i._searchString="",!(i.selectedIndex+1<i.visibleItems.length))return!1;var p=i._nextItemIndex(i.selectedIndex);if(p==i.selectedIndex||-1==p)return!0;r(),i.selectIndex(p,!1,!1,!1,"keyboard",e)}if(35==t||36==t||38==t||40==t||34==t||33==t){var g=i.isIndexInView(i.selectedIndex);return g?i._renderItems():i.ensureVisible(i.selectedIndex),!1}return!0}},_updateItemCheck:function(e,t){if(!this.disabled)switch(e.checked=1==e.checked?e.hasThreeStates&&this.hasThreeStates?null:!1:null!=e.checked,e.checked){case!0:this.checkIndex(t);break;case!1:this.uncheckIndex(t);break;default:this.indeterminateIndex(t)}},wheel:function(e,t){if(t.autoHeight||!t.enableMouseWheel)return e.returnValue=!0,!0;if(t.disabled)return!0;var i=0;if(e||(e=window.event),e.originalEvent&&e.originalEvent.wheelDelta&&(e.wheelDelta=e.originalEvent.wheelDelta),e.wheelDelta?i=e.wheelDelta/120:e.detail&&(i=-e.detail/3),i){var s=t._handleDelta(i);return s&&(e.preventDefault&&e.preventDefault(),null!=e.originalEvent&&(e.originalEvent.mouseHandled=!0),void 0!=e.stopPropagation&&e.stopPropagation()),s?(s=!1,e.returnValue=s,s):!1}e.preventDefault&&e.preventDefault(),e.returnValue=!1},_handleDelta:function(e){var t=this.vScrollInstance.value;0>e?this.scrollDown():this.scrollUp();var i=this.vScrollInstance.value;return t!=i?!0:!1},focus:function(){try{this.focused=!0,this.host.focus();var e=this;setTimeout(function(){e.host.focus()},10)}catch(t){}},_removeHandlers:function(){this.removeHandler(e(document),"keydown.listbox"+this.element.id),this.removeHandler(e(document),"keyup.listbox"+this.element.id),this.removeHandler(this.vScrollBar,"valueChanged"),this.removeHandler(this.hScrollBar,"valueChanged"),this._mousewheelfunc?this.removeHandler(this.host,"mousewheel",this._mousewheelfunc):this.removeHandler(this.host,"mousewheel"),this.removeHandler(this.host,"keydown"),this.removeHandler(this.content,"mouseleave"),this.removeHandler(this.content,"focus"),this.removeHandler(this.content,"blur"),this.removeHandler(this.host,"focus"),this.removeHandler(this.host,"blur"),this.removeHandler(this.content,"mouseenter"),this.removeHandler(this.content,"mouseup"),this.removeHandler(this.content,"mousedown"),this.removeHandler(this.content,"touchend"),this._mousemovefunc?this.removeHandler(this.content,"mousemove",this._mousemovefunc):this.removeHandler(this.content,"mousemove"),this.removeHandler(this.content,"selectstart"),this.overlayContent&&this.removeHandler(this.overlayContent,e.jqx.mobile.getTouchEventName("touchend"))},_updateSize:function(){this.virtualSize||(this._oldheight=null,this.virtualSize=this._calculateVirtualSize());var e=this;if(e._arrange(),e.host.height()!=e._oldheight||e.host.width()!=e._oldwidth){{e.host.width()!=e._oldwidth}if(e.autoItemsHeight)e._render(!1);else if(e.items)if(e.items.length>0&&e.virtualItemsCount*e.items[0].height<e._oldheight-2)e._render(!1);else{var t=e.vScrollInstance.value;e._updatescrollbars(),e._renderItems(),e.vScrollInstance.setPosition(t<e.vScrollInstance.max?t:e.vScrollInstance.max)}e._oldwidth=e.host.width(),e._oldheight=e.host.height()}},_addHandlers:function(){var t=this;this.focused=!1;var i=(new Date,this.isTouchDevice());this.addHandler(this.vScrollBar,"valueChanged",function(){e.jqx.browser.msie&&e.jqx.browser.version>9?setTimeout(function(){t._renderItems()},1):t._renderItems()}),this.addHandler(this.hScrollBar,"valueChanged",function(){t._renderItems()}),this._mousewheelfunc&&this.removeHandler(this.host,"mousewheel",this._mousewheelfunc),this._mousewheelfunc=function(e){t.wheel(e,t)},this.addHandler(this.host,"mousewheel",this._mousewheelfunc),this.addHandler(e(document),"keydown.listbox"+this.element.id,function(e){t._ctrlKey=e.ctrlKey||e.metaKey,t._shiftKey=e.shiftKey}),this.addHandler(e(document),"keyup.listbox"+this.element.id,function(e){t._ctrlKey=e.ctrlKey||e.metaKey,t._shiftKey=e.shiftKey}),this.addHandler(this.host,"keydown",function(e){return t._handleKeyDown(e)}),this.addHandler(this.content,"mouseleave",function(){t.focused=!1;var i=e.data(t.element,"hoveredItem");null!=i&&(e(i).removeClass(t.toThemeProperty("jqx-listitem-state-hover")),e(i).removeClass(t.toThemeProperty("jqx-fill-state-hover")),e.data(t.element,"hoveredItem",null))}),this.addHandler(this.content,"focus",function(){t.disabled||(t.host.addClass(t.toThemeProperty("jqx-fill-state-focus")),t.focused=!0)}),this.addHandler(this.content,"blur",function(){t.focused=!1,t.host.removeClass(t.toThemeProperty("jqx-fill-state-focus"))}),this.addHandler(this.host,"focus",function(){t.disabled||(t.host.addClass(t.toThemeProperty("jqx-fill-state-focus")),t.focused=!0)}),this.addHandler(this.host,"blur",function(){e.jqx.browser.msie&&e.jqx.browser.version<9&&t.focused||(t.host.removeClass(t.toThemeProperty("jqx-fill-state-focus")),t.focused=!1)}),this.addHandler(this.content,"mouseenter",function(){t.focused=!0});var s=e.jqx.utilities.hasTransform(this.host);if(this.enableSelection){var l=t.isTouchDevice()&&this.touchMode!==!0,r=l?"touchend":"mousedown";if(this.overlayContent)this.addHandler(this.overlayContent,e.jqx.mobile.getTouchEventName("touchend"),function(i){if(!t.enableSelection)return!0;if(l&&(t._newScroll=new Date,t._newScroll-t._lastScroll<500))return!0;var s=e.jqx.mobile.getTouches(i),r=s[0];if(void 0!=r){var n=t.host.offset(),a=parseInt(r.pageX),h=parseInt(r.pageY);1==t.touchMode&&void 0!=r._pageX&&(a=parseInt(r._pageX),h=parseInt(r._pageY)),a-=n.left,h-=n.top;var o=t._hitTest(a,h);if(null!=o&&!o.isGroup){if(t._newScroll=new Date,t._newScroll-t._lastScroll<500)return!1;if(t.checkboxes)return void t._updateItemCheck(o,o.visibleIndex);if(-1==o.html.indexOf("href"))return t.selectIndex(o.visibleIndex,!1,!0,!1,"mouse",i),i.preventDefault&&i.preventDefault(),t.content.trigger("click"),!1;setTimeout(function(){return t.selectIndex(o.visibleIndex,!1,!0,!1,"mouse",i),t.content.trigger("click"),!1},100)}}});else{var n=!1;this.addHandler(this.content,r,function(i){if(!t.enableSelection)return!0;if(n=!0,l&&(t._newScroll=new Date,t._newScroll-t._lastScroll<500))return!1;if(t.focused=!0,!t.isTouchDevice()&&t.focusable&&t.host.focus(),i.target.id!="listBoxContent"+t.element.id&&t.itemswrapper[0]!=i.target){var a=i.target,h=e(a).offset(),o=t.host.offset();if(s){var d=e.jqx.mobile.getLeftPos(a),c=e.jqx.mobile.getTopPos(a);h.left=d,h.top=c,d=e.jqx.mobile.getLeftPos(t.element),c=e.jqx.mobile.getTopPos(t.element),o.left=d,o.top=c}var u=parseInt(h.top)-parseInt(o.top),v=parseInt(h.left)-parseInt(o.left),m=t._hitTest(v,u);if(null!=m&&!m.isGroup){var p=function(e,i){if(t._shiftKey||(t._clickedIndex=e.visibleIndex),t.checkboxes)if(t.selectedIndex=e.visibleIndex,v=20+i.pageX-h.left,t.rtl){{"hidden"!=t.hScrollBar.css("visibility")?t.hScrollInstance.max:t.host.width()}v<=t.host.width()-20&&(t.allowDrag?setTimeout(function(){t._dragItem||n||t._updateItemCheck(e,e.visibleIndex)},200):t._updateItemCheck(e,e.visibleIndex))}else v+t.hScrollInstance.value>=20&&(t.allowDrag?setTimeout(function(){t._dragItem||n||t._updateItemCheck(e,e.visibleIndex)},200):t._updateItemCheck(e,e.visibleIndex));else t.selectIndex(e.visibleIndex,!1,!0,!1,"mouse",i)};m.disabled||(-1!=m.html.indexOf("href")?setTimeout(function(){p(m,i)},100):p(m,i))}if("mousedown"==r){var g=!1;return i.which?g=3==i.which:i.button&&(g=2==i.button),g?!0:!1}}return!0})}this.addHandler(this.content,"mouseup",function(e){t.vScrollInstance.handlemouseup(t,e),n=!1}),e.jqx.browser.msie&&this.addHandler(this.content,"selectstart",function(){return!1})}var i=this.isTouchDevice();this.enableHover&&!i&&(this._mousemovefunc=function(l){if(i)return!0;if(!t.enableHover)return!0;1==e.jqx.browser.msie&&e.jqx.browser.version<9?0:1;if(null==l.target)return!0;if(t.disabled)return!0;t.focused=!0;var r=t.vScrollInstance.isScrolling();if(!r&&l.target.id!="listBoxContent"+t.element.id&&t.itemswrapper[0]!=l.target){var n=l.target,a=e(n).offset(),h=t.host.offset();if(s){var o=e.jqx.mobile.getLeftPos(n),d=e.jqx.mobile.getTopPos(n);a.left=o,a.top=d,o=e.jqx.mobile.getLeftPos(t.element),d=e.jqx.mobile.getTopPos(t.element),h.left=o,h.top=d}var c=parseInt(a.top)-parseInt(h.top),u=parseInt(a.left)-parseInt(h.left),v=t._hitTest(u,c);if(null!=v&&!v.isGroup&&!v.disabled){var m=e.data(t.element,"hoveredItem");null!=m&&(e(m).removeClass(t.toThemeProperty("jqx-listitem-state-hover")),e(m).removeClass(t.toThemeProperty("jqx-fill-state-hover"))),e.data(t.element,"hoveredItem",v.element);var p=e(v.element);p.addClass(t.toThemeProperty("jqx-listitem-state-hover")),p.addClass(t.toThemeProperty("jqx-fill-state-hover"))}}},this.addHandler(this.content,"mousemove",this._mousemovefunc))},_arrange:function(e){void 0==e&&(e=!0);var t=this,i=null,s=null,l=t.filterable?t.filterHeight:0,r=function(e){return e=t.host.height(),0==e&&(e=200,t.host.height(e)),e};null!=t.width&&-1!=t.width.toString().indexOf("px")?i=t.width:void 0==t.width||isNaN(t.width)||(i=t.width),null!=t.height&&-1!=t.height.toString().indexOf("px")?s=t.height:void 0==t.height||isNaN(t.height)||(s=t.height),null!=t.width&&-1!=t.width.toString().indexOf("%")&&(t.host.css("width",t.width),i=t.host.width()),null!=t.height&&-1!=t.height.toString().indexOf("%")&&(t.host.css("height",t.height),s=r(s)),null!=i&&(i=parseInt(i),parseInt(t.element.style.width)!=parseInt(t.width)&&t.host.width(t.width)),t.autoHeight?t.virtualSize&&("hidden"!=t.hScrollBar.css("visibility")?(t.host.height(t.virtualSize.height+parseInt(t.scrollBarSize)+3),t.height=t.virtualSize.height+parseInt(t.scrollBarSize)+3,s=t.height):(t.host.height(t.virtualSize.height),t.height=t.virtualSize.height,s=t.virtualSize.height)):null!=s&&(s=parseInt(s),parseInt(t.element.style.height)!=parseInt(t.height)&&(t.host.height(t.height),r(s)));var n=t.scrollBarSize;isNaN(n)&&(n=parseInt(n),isNaN(n)?n="17px":n+="px"),n=parseInt(n);var a=4,h=2,o=0;if(t.vScrollBar&&("hidden"!=t.vScrollBar[0].style.visibility?o=n+a:t.vScrollInstance.setPosition(0),t.hScrollBar)){"hidden"!=t.hScrollBar[0].style.visibility?h=n+a:t.hScrollInstance.setPosition(0),t.autoItemsHeight&&(t.hScrollBar[0].style.visibility="hidden",h=0),null==s&&(s=0);var d=parseInt(s)-a-n;0>d&&(d=0),parseInt(t.hScrollBar[0].style.height)!=n&&(parseInt(n)<0&&(n=0),t.hScrollBar[0].style.height=parseInt(n)+"px"),t.hScrollBar[0].style.top!=d+"px"&&(t.hScrollBar[0].style.top=d+"px",t.hScrollBar[0].style.left="0px");var c=i-n-a;0>c&&(c=0);var u=c+"px";if(t.hScrollBar[0].style.width!=u&&(t.hScrollBar[0].style.width=u),0==o&&i>=2&&(t.hScrollBar[0].style.width=parseInt(i-2)+"px"),n!=parseInt(t.vScrollBar[0].style.width)&&(t.vScrollBar[0].style.width=parseInt(n)+"px"),parseInt(s)-h!=parseInt(t.vScrollBar[0].style.height)){var v=parseInt(s)-h;0>v&&(v=0),t.vScrollBar[0].style.height=v+"px"}null==i&&(i=0);var m=parseInt(i)-parseInt(n)-a+"px";m!=t.vScrollBar[0].style.left&&(parseInt(m)>=0&&(t.vScrollBar[0].style.left=m),t.vScrollBar[0].style.top="0px");var p=t.vScrollInstance;p.disabled=t.disabled,e&&p._arrange();var g=t.hScrollInstance;if(g.disabled=t.disabled,e&&g._arrange(),"hidden"!=t.vScrollBar[0].style.visibility&&"hidden"!=t.hScrollBar[0].style.visibility?(t.bottomRight[0].style.visibility="inherit",t.bottomRight[0].style.left=1+parseInt(t.vScrollBar[0].style.left)+"px",t.bottomRight[0].style.top=1+parseInt(t.hScrollBar[0].style.top)+"px",t.rtl&&t.bottomRight.css({left:0}),t.bottomRight[0].style.width=parseInt(n)+3+"px",t.bottomRight[0].style.height=parseInt(n)+3+"px"):t.bottomRight[0].style.visibility="hidden",parseInt(t.content[0].style.width)!=parseInt(i)-o){var f=parseInt(i)-o;0>f&&(f=0),t.content[0].style.width=f+"px"}if(t.rtl&&(t.vScrollBar.css({left:"0px",top:"0px"}),t.hScrollBar.css({left:t.vScrollBar.width()+2+"px"}),"hidden"!=t.vScrollBar[0].style.visibility?t.content.css("margin-left",4+t.vScrollBar.width()):(t.content.css("margin-left",0),t.hScrollBar.css({left:"0px"}))),parseInt(t.content[0].style.height)!=parseInt(s)-h){var x=parseInt(s)-h;0>x&&(x=0),t.content[0].style.height=x+"px",t.content[0].style.top="0px"}l>0&&(t.content[0].style.top=l+"px",t.content[0].style.height=parseInt(t.content[0].style.height)-l+"px"),t.filterable?(t.filterInput[0].style.height=l-6+"px",t.filterInput[0].style.top="3px",t.filterInput[0].style.left=parseInt(t.content.css("left"))+3+"px",t.filterInput[0].style.width=parseInt(t.content.css("width"))-7+"px",t.filter[0].style.display="block"):t.filter[0].style.display="none",t.overlayContent&&(t.overlayContent.width(parseInt(i)-o),t.overlayContent.height(parseInt(s)-h))}},ensureVisible:function(t,i){if(isNaN(t)){var s=this.getItemByValue(t);s&&(t=s.index)}var l=this.isIndexInView(t);if(l){if(i)for(indx=0;indx<this.visibleItems.length;indx++){var s=this.visibleItems[indx];if(s.visibleIndex==t&&!s.isGroup){var r=this.vScrollInstance.value,n=s.initialTop;this.filterable&&(n=this.filterHeight+2+s.initialTop),r+this.host.height()<this.vScrollInstance.max&&this.vScrollInstance.setPosition(n)}}}else{if(0>t)return;if(this.autoHeight){var a=e.data(this.vScrollBar[0],"jqxScrollBar").instance;a.setPosition(0)}else for(indx=0;indx<this.visibleItems.length;indx++){var s=this.visibleItems[indx];if(s.visibleIndex==t&&!s.isGroup){var a=e.data(this.vScrollBar[0],"jqxScrollBar").instance,r=a.value;this.filterable&&(r-=this.filterHeight+2);var h="hidden"===this.hScrollBar.css("visibility"),o=h?0:this.scrollBarSize+4;if(s.initialTop<r)a.setPosition(s.initialTop),0==indx&&a.setPosition(0);else if(s.initialTop+s.height>r+this.host.height()){var d=this.host.height();if(this.filterable?a.setPosition(this.filterHeight+2+s.initialTop+s.height+2-d+o):(a.setPosition(s.initialTop+s.height+2-d+o),indx===this.visibleItems.length-1&&a.setPosition(a.max)),i){var r=a.value,n=s.initialTop;this.filterable&&(n=this.filterHeight+2+s.initialTop),r+d<a.max&&a.setPosition(n)}}break}}}this._renderItems()},scrollTo:function(e,t){"hidden"!=this.vScrollBar.css("visibility")&&this.vScrollInstance.setPosition(t),"hidden"!=this.hScrollBar.css("visibility")&&this.hScrollInstance.setPosition(e)},scrollDown:function(){if("hidden"==this.vScrollBar.css("visibility"))return!1;var e=this.vScrollInstance;return e.value+e.largestep<=e.max?(e.setPosition(e.value+e.largestep),!0):(e.setPosition(e.max),!0)},scrollUp:function(){if("hidden"==this.vScrollBar.css("visibility"))return!1;var e=this.vScrollInstance;return e.value-e.largestep>=e.min?(e.setPosition(e.value-e.largestep),!0):e.value!=e.min?(e.setPosition(e.min),!0):!1},databind:function(t,i){this.records=new Array;var s=t._source?!0:!1,l=new e.jqx.dataAdapter(t,{autoBind:!1});s&&(l=t,t=t._source);var r=function(){void 0!=t.type&&(l._options.type=t.type),void 0!=t.formatdata&&(l._options.formatData=t.formatdata),void 0!=t.contenttype&&(l._options.contentType=t.contenttype),void 0!=t.async&&(l._options.async=t.async)},n=function(t,i){var s=function(i){var s=null;if("string"==typeof i)var l=i,r=i,n="";else if(void 0!=t.displayMember&&""!=t.displayMember)var r=i[t.valueMember],l=i[t.displayMember];var n="";if(t.groupMember?n=i[t.groupMember]:i&&void 0!=i.group&&(n=i.group),t.searchMember?s=i[t.searchMember]:i&&void 0!=i.searchLabel&&(s=i.searchLabel),t.valueMember||t.displayMember||"string"==e.type(i)&&(l=r=i.toString()),i&&void 0!=i.label)var l=i.label,r=i.value;var a=!1;i&&void 0!=i.checked&&(a=i.checked);var h="";i&&void 0!=i.html&&(h=i.html);var o=!0;i&&void 0!=i.visible&&(o=i.visible);var d=!1;i&&void 0!=i.disabled&&(d=i.disabled);var c=!1;i&&void 0!=i.hasThreeStates&&(c=i.hasThreeStates);var u={};return u.label=l,u.value=r,u.searchLabel=s,u.html=h,u.visible=o,u.originalItem=i,u.group=n,u.groupHtml="",u.disabled=d,u.checked=a,u.hasThreeStates=c,u};if(void 0!=i){var r=l._changedrecords[0];if(r)return void e.each(l._changedrecords,function(){var e=this.index,l=this.record;if("remove"!=i)var r=s(l);switch(i){case"update":t.updateAt(r,e);break;case"add":t.insertAt(r,e);break;case"remove":t.removeAt(e)}})}t.records=l.records;for(var n=t.records.length,a=new Array,h=0;n>h;h++){var o=t.records[h],d=s(o);d.index=h,a[h]=d}t.items=t.loadItems(a,!0),t._render(),t._raiseEvent("6")};r(this);var a=this;switch(t.datatype){case"local":case"array":default:(null!=t.localdata||e.isArray(t))&&(l.unbindBindingUpdate(this.element.id),(this.autoBind||!this.autoBind&&!i)&&l.dataBind(),n(this),l.bindBindingUpdate(this.element.id,function(e){n(a,e)}));break;case"json":case"jsonp":case"xml":case"xhtml":case"script":case"text":case"csv":case"tab":if(null!=t.localdata)return l.unbindBindingUpdate(this.element.id),(this.autoBind||!this.autoBind&&!i)&&l.dataBind(),n(this),void l.bindBindingUpdate(this.element.id,function(){n(a)});var h={};l._options.data?e.extend(l._options.data,h):(t.data&&e.extend(h,t.data),l._options.data=h);var o=function(){n(a)};l.unbindDownloadComplete(a.element.id),l.bindDownloadComplete(a.element.id,o),(this.autoBind||!this.autoBind&&!i)&&l.dataBind()}},loadItems:function(t,i){if(null==t)return this.groups=new Array,this.items=new Array,void(this.visualItems=new Array);var s=this,l=0,r=0,n=0;this.groups=new Array,this.items=new Array,this.visualItems=new Array;var a=new Array;this.itemsByValue=new Array,e.map(t,function(t){if(void 0==t)return null;var h=new e.jqx._jqxListBox.item,o=t.group,d=t.groupHtml,c=t.title,u=null;if(s.searchMember?u=record[s.searchMember]:t&&void 0!=t.searchLabel&&(u=t.searchLabel),(null==c||void 0==c)&&(c=""),(null==o||void 0==o)&&(o=""),s.groupMember&&(o=t[s.groupMember]),(null==d||void 0==d)&&(d=""),!s.groups[o]){s.groups[o]={items:new Array,index:-1,caption:o,captionHtml:d},l++;var v=l+"jqxGroup";s.groups[v]=s.groups[o],r++,s.groups.length=r}var m=s.groups[o];return m.index++,m.items[m.index]=h,"string"==typeof t?(h.label=t,h.value=t):null==t.label&&null==t.value&&null==t.html&&null==t.group&&null==t.groupHtml?(h.label=t.toString(),h.value=t.toString()):(h.label=t.label,h.value=t.value,void 0===h.label&&(h.label=t.value),void 0===h.value&&(h.value=t.label)),"string"!=typeof t&&(void 0===t.label&&""!=s.displayMember&&(h.label=void 0!=t[s.displayMember]?t[s.displayMember]:""),void 0===t.value&&""!=s.valueMember&&(h.value=t[s.valueMember])),h.hasThreeStates=void 0!=t.hasThreeStates?t.hasThreeStates:!0,h.originalItem=t,i&&(h.originalItem=t.originalItem),h.title=c,c&&void 0===h.value&&void 0===h.label&&(h.value=h.label=c),h.html=t.html||"",t.html&&""!=t.html,h.group=o,h.checked=t.checked||!1,h.groupHtml=t.groupHtml||"",h.disabled=t.disabled||!1,h.visible=void 0!=t.visible?t.visible:!0,h.searchLabel=u,h.index=n,a[n]=h,n++,h});var h=new Array,o=0;if(void 0==this.fromSelect||0==this.fromSelect)for(var d=0;r>d;d++){var l=d+1,c=l+"jqxGroup",u=this.groups[c];if(void 0==u||null==u)break;if(0==d&&""==u.caption&&""==u.captionHtml&&1>=r){for(var v=0;v<u.items.length;v++){var m=u.items[v].value;(void 0==u.items[v].value||null==u.items[v].value)&&(m=v),this.itemsByValue[e.trim(m).split(" ").join("")]=u.items[v]}return u.items}var p=new e.jqx._jqxListBox.item;p.isGroup=!0,p.label=u.caption,""==u.caption&&""==u.captionHtml&&(u.caption=this.emptyGroupText,p.label=u.caption),p.html=u.captionHtml,h[o]=p,o++;for(var g=0;g<u.items.length;g++){h[o]=u.items[g];var m=u.items[g].value;(""==u.items[g].value||null==u.items[g].value)&&(m=o),s.itemsByValue[e.trim(m).split(" ").join("")]=u.items[g],o++}}else{var o=0,f=new Array;e.each(a,function(){if(!f[this.group]&&""!=this.group){var t=new e.jqx._jqxListBox.item;t.isGroup=!0,t.label=this.group,h[o]=t,o++,f[this.group]=!0}h[o]=this;var i=this.value;(""==this.value||null==this.value)&&(i=o-1),s.itemsByValue[e.trim(i).split(" ").join("")]=this,o++})}return h},_mapItem:function(t){var i=new e.jqx._jqxListBox.item;return this.displayMember&&(void 0==t.label&&(t.label=t[this.displayMember]),void 0==t.value&&(t.value=t[this.valueMember])),"string"==typeof t?(i.label=t,i.value=t):"number"==typeof t?(i.label=t.toString(),i.value=t.toString()):(i.label=void 0!==t.label?t.label:t.value,i.value=void 0!==t.value?t.value:t.label),void 0==i.label&&void 0==i.value&&void 0==i.html&&(i.label=i.value=t),i.html=t.html||"",i.group=t.group||"",i.checked=t.checked||!1,i.title=t.title||"",i.groupHtml=t.groupHtml||"",i.disabled=t.disabled||!1,i.visible=t.visible||!0,i},addItem:function(e){return this.insertAt(e,this.items?this.items.length:0)},_getItemByParam:function(e){if(null!=e&&void 0==e.index){var t=this.getItemByValue(e);t&&(e=t)}return e},insertItem:function(e,t){var i=this._getItemByParam(e);return this.insertAt(i,t)},updateItem:function(e,t){var i=this._getItemByParam(t);return i&&void 0!=i.index?this.updateAt(e,i.index):!1},updateAt:function(t,i){if(null!=t){var s=this._mapItem(t);this.itemsByValue[e.trim(s.value).split(" ").join("")]=this.items[i],this.items[i].value=s.value,this.items[i].label=s.label,this.items[i].html=s.html,this.items[i].disabled=s.disabled}this._cachedItemHtml=[],this._renderItems(),this.rendered&&this.rendered()},insertAt:function(t,i){if(null==t)return!1;if(this._cachedItemHtml=[],void 0==this.items||0==this.items.length){this.source=new Array,this.refresh();var s=this._mapItem(t);s.index=0,this.items[this.items.length]=s,this._addItems(!0),this._renderItems(),this.rendered&&this.rendered(),this.allowDrag&&this._enableDragDrop&&this._enableDragDrop();var l=s.value;return(""==s.value||null==s.value)&&(l=i),this.itemsByValue[e.trim(l).split(" ").join("")]=s,!1}var s=this._mapItem(t);if(-1==i||void 0==i||null==i||i>=this.items.length)s.index=this.items.length,this.items[this.items.length]=s;else{for(var r=new Array,n=0,a=!1,h=0,o=0;o<this.items.length;o++)0==this.items[o].isGroup&&h>=i&&!a&&(r[n++]=s,s.index=i,h++,a=!0),r[n]=this.items[o],this.items[o].isGroup||(r[n].index=h,h++),n++;this.items=r}var l=s.value;(""==s.value||null==s.value)&&(l=i),this.itemsByValue[e.trim(l).split(" ").join("")]=s,this.visibleItems=new Array,this.renderedVisibleItems=new Array;var d=e.data(this.vScrollBar[0],"jqxScrollBar").instance,c=d.value;return d.setPosition(0),this._addItems(this.allowDrag&&this._enableDragDrop||this.virtualSize&&this.virtualSize.height<10+this.host.height()?!0:!1),this.groups.length>1,this._renderItems(),this.allowDrag&&this._enableDragDrop&&this._enableDragDrop(),d.setPosition(c),this.rendered&&this.rendered(),!0},removeAt:function(t){if(0>t||t>this.items.length-1)return!1;if(void 0==t)return!1;var i=this.items[t].height,s=this.items[t].value;if((""==s||null==s)&&(s=t),this.itemsByValue[e.trim(s).split(" ").join("")]=null,this.groups.length>1){for(var l=new Array,r=0;r<this.items.length;r++)this.items[r].isGroup||l.push({item:this.items[r],key:r});if(!l[t])return!1;this.items.splice(l[t].key,1)}else this.items.splice(t,1);
for(var n=new Array,a=0,h=0,r=0;r<this.items.length;r++)n[a]=this.items[r],this.items[r].isGroup||(n[a].index=h,h++),a++;this.items=n;var o=e.data(this.vScrollBar[0],"jqxScrollBar").instance,o=e.data(this.vScrollBar[0],"jqxScrollBar").instance,d=o.value;if(o.setPosition(0),this.visibleItems=new Array,this.renderedVisibleItems=new Array,this.items.length>0){if(this.virtualSize){this.virtualSize.height-=i;var c=2*this.virtualSize.itemsPerPage;this.autoHeight&&(c=this.items.length),this.virtualItemsCount=Math.min(c,this.items.length)}this._updatescrollbars()}else this._addItems();this._renderItems(),this.allowDrag&&this._enableDragDrop&&this._enableDragDrop(),o.setPosition("hidden"!=this.vScrollBar.css("visibility")?d:0),this.itemsByValue=new Array;for(var u=0;u<this.items.length;u++){var s=this.items[u].value;(""==this.items[u].value||null==this.items[u].value)&&(s=u),this.itemsByValue[e.trim(s).split(" ").join("")]=this.items[u]}return this.rendered&&this.rendered(),!0},removeItem:function(e,t){var i=this._getItemByParam(e),s=-1;if(i&&void 0!=i.index&&t!==!0){for(var l=0;l<this.items.length;l++)if(this.items[l].label==i.label&&this.items[l].value==i.value){s=l;break}if(-1!=s)return this.removeAt(s)}return-1==s?this.removeAt(i.index):void 0},getItems:function(){return this.items},disableItem:function(e){var t=this._getItemByParam(e);this.disableAt(t.index)},enableItem:function(e){var t=this._getItemByParam(e);this.enableAt(t.index)},disableAt:function(e){return this.items?0>e||e>this.items.length-1?!1:(this.items[e].disabled=!0,this._renderItems(),!0):!1},enableAt:function(e){return this.items?0>e||e>this.items.length-1?!1:(this.items[e].disabled=!1,this._renderItems(),!0):!1},destroy:function(){this.source&&this.source.unbindBindingUpdate&&this.source.unbindBindingUpdate(this.element.id),this._removeHandlers(),this.vScrollBar.jqxScrollBar("destroy"),this.hScrollBar.jqxScrollBar("destroy"),this.vScrollBar.remove(),this.hScrollBar.remove(),this.content.remove(),e.jqx.utilities.resize(this.host,null,!0);var t=e.data(this.element,"jqxListBox");delete this.hScrollInstance,delete this.vScrollInstance,delete this.vScrollBar,delete this.hScrollBar,delete this.content,delete this.bottomRight,delete this.itemswrapper,delete this.visualItems,delete this.visibleItems,delete this.items,delete this.groups,delete this.renderedVisibleItems,delete this._mousewheelfunc,delete this._mousemovefunc,delete this._cachedItemHtml,delete this.itemsByValue,delete this._activeElement,delete this.source,delete this.events,this.input&&(this.input.remove(),delete this.input),t&&delete t.instance,this.host.removeData(),this.host.removeClass(),this.host.remove(),this.element=null,delete this.element,this.host=null,delete this.set,delete this.get,delete this.call,delete this.host},_raiseEvent:function(t,i){if(1==this._stopEvents)return!0;void 0==i&&(i={owner:null});var s=this.events[t];args=i,args.owner=this,this._updateInputSelection();var l=new e.Event(s);if(l.owner=this,l.args=args,null!=this.host)var r=this.host.trigger(l);return r}})}(jqxBaseFramework),function(e){e.jqx.parseSourceTag=function(t){var i=new Array,s=e(t).find("option"),l=e(t).find("optgroup"),r=!1;0===s.length&&(s=e(t).find("li"),s.length>0&&(r=!0));var n=null,n=-1,a=new Array;if(e.each(s,function(t){var s=l.find(this).length>0,h=null;null==this.text||null!=this.label&&""!=this.label||(this.label=this.text),r===!0&&(this.label=e(this).text(),this.selected=e(this).attr("data-selected"),this.checked=this.selected,this.value=e(this).attr("data-value")||t,this.disabled=e(this).attr("disabled"));var o={style:this.style.cssText,selected:this.selected,html:this.innerHTML,classes:this.className,disabled:this.disabled,value:this.value,label:this.label,title:this.title,originalItem:this},d=e.jqx.browser.msie&&e.jqx.browser.version<8;d&&!r&&""==o.value&&null!=this.text&&this.text.length>0&&(o.value=this.text),s&&(h=l.find(this).parent()[0].label,o.group=h,a[h]||(a[h]=new Array,a.length++),a[h].push(o)),this.selected&&(n=t),o.checked=this.selected,void 0!==o.label&&i.push(o)}),a.length>0){var h=new Array;for(var o in a)if("indexOf"!==o){for(var d=null,c=0;c<l.length;c++)if(o===l[c].label||l[c].text){d=l[c];break}e.each(a[o],function(){void 0!==this.label&&h.push(this)})}}return h&&h.length>0?{items:h,index:n}:{items:i,index:n}},e.jqx._jqxListBox.item=function(){var e={group:"",groupHtml:"",selected:!1,isGroup:!1,highlighted:!1,value:null,label:"",html:null,visible:!0,disabled:!1,element:null,width:null,height:null,initialTop:null,top:null,left:null,title:"",index:-1,checkBoxElement:null,originalItem:null,checked:!1,visibleIndex:-1};return e}}(jqxBaseFramework);