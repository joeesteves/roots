!function(e){e.extend(e.jqx._jqxGrid.prototype,{autoresizecolumns:function(t,i){"cells"!=t&&"all"!=t&&"column"!=t&&(t="all");var l=this.that,s=this.getrows();this.pageable&&(s=this.dataview.rows,this.groupable&&(s=this.dataview.records)),i=void 0==i?0:parseInt(i);var r=s.length;if(void 0==r&&void 0!=s){var o=new Array;e.each(s,function(){o.push(this)}),s=o,r=s.length}var a=e("<span></span>");a.addClass(this.toThemeProperty("jqx-widget")),a.addClass(this.toThemeProperty("jqx-grid-cell")),e(document.body).append(a);var n=[],d=[],c=[],u=[],h=l.host.width();"hidden"!=l.vScrollBar[0].style.visibility&&(h-=this.scrollbarsize+5),0>h&&(h=0);for(var m=0;r>m;m++)for(var f=s[m],v=0;v<this.columns.records.length;v++){var p=this.columns.records[v];if(!p.hidden){void 0==d[p.displayfield]&&(d[p.displayfield]=0),void 0==c[p.displayfield]&&(c[p.displayfield]="");var w=f[p.displayfield];if(""!=p.cellsformat)e.jqx.dataFormat&&(e.jqx.dataFormat.isDate(w)?w=e.jqx.dataFormat.formatdate(w,p.cellsformat,this.gridlocalization):e.jqx.dataFormat.isNumber(w)&&(w=e.jqx.dataFormat.formatnumber(w,p.cellsformat,this.gridlocalization)));else if(p.cellsrenderer){var g=l._defaultcellsrenderer(w,p),z=p.cellsrenderer(m,p.datafield,w,g,p.getcolumnproperties(),f);void 0!=z&&(w=e(z).text())}if((void 0==t||"cells"==t||"all"==t)&&null!=w){var n=w.toString().length,b=w.toString(),y=b.replace(/[^A-Z]/g,"").length;if(n>d[p.displayfield]&&(d[p.displayfield]=n,c[p.displayfield]=w,u[p.displayfield]=y),n>0&&n>=y){var _=20*y+15*(n-y),x=20*u[p.displayfield]+15*(d[p.displayfield]-u[p.displayfield]);_>x&&_>0&&x>0&&(d[p.displayfield]=n,c[p.displayfield]=w,u[p.displayfield]=y)}}if("column"==t||"all"==t){if(p.text.toString().length>d[p.displayfield]){c[p.displayfield]=p.text,d[p.displayfield]=p.text.length;var b=p.text.toString(),y=b.replace(/[^A-Z]/g,"").length;u[p.displayfield]=y}var w=p.text,n=w.toString().length,b=w.toString(),y=b.replace(/[^A-Z]/g,"").length;if(n>0&&n>=y){var _=20*y+15*(n-y),x=20*u[p.displayfield]+15*(d[p.displayfield]-u[p.displayfield]);_>x&&_>0&&x>0&&(d[p.displayfield]=n,c[p.displayfield]=w,u[p.displayfield]=y)}}}}if(this.columns.records){for(var v=0;v<this.columns.records.length;v++){var p=this.columns.records[v];void 0==c[p.displayfield]&&(c[p.displayfield]=p.text),a[0].innerHTML=c[p.displayfield].toString();var j=a.outerWidth()+10;if(a.children().length>0&&(j=a.children().outerWidth()+10),e.jqx.browser.msie&&e.jqx.browser.version<8&&(j+=10),this.filterable&&this.showfilterrow&&(j+=5),j+=i,j>p.maxwidth&&(j=p.maxwidth),void 0!=p._width&&(p.__width=p._width),p._width=null,"auto"==p.maxwidth||j<=p.maxwidth){var q=p.width;j<p.minwidth&&(j=p.minwidth),p.width=j,void 0!=p._percentagewidth&&(p._percentagewidth=null),this._raiseEvent(14,{columntext:p.text,column:p.getcolumnproperties(),datafield:p.datafield,displayfield:p.displayfield,oldwidth:q,newwidth:j})}}a.remove(),this._updatecolumnwidths(),this._updatecellwidths(),this._renderrows(this.virtualsizeinfo);for(var v=0;v<this.columns.records.length;v++){var p=this.columns.records[v];void 0!=p.__width&&(p._width=p.__width)}}},autoresizecolumn:function(t,i,l){if("cells"!=i&&"all"!=i&&"column"!=i&&(i="all"),void 0==t)return!1;var s=this.getrows();this.pageable&&(s=this.dataview.rows,this.groupable&&(s=this.dataview.records));var r=this.getcolumn(t);if(void 0==r)return!1;l=void 0==l?0:parseInt(l);var o=s.length,a=e("<span></span>");a.addClass(this.toThemeProperty("jqx-widget")),a.addClass(this.toThemeProperty("jqx-grid-cell")),e(document.body).append(a);var n=0,d="",c=0,u=this.that,h=u.host.width();if("hidden"!=u.vScrollBar[0].style.visibility&&(h-=this.scrollbarsize+5),0>h&&(h=0),void 0==i||"cells"==i||"all"==i)for(var m=0;o>m;m++){var f=s[m][r.displayfield];if(""!=r.cellsformat)e.jqx.dataFormat&&(e.jqx.dataFormat.isDate(f)?f=e.jqx.dataFormat.formatdate(f,r.cellsformat,this.gridlocalization):e.jqx.dataFormat.isNumber(f)&&(f=e.jqx.dataFormat.formatnumber(f,r.cellsformat,this.gridlocalization)));else if(r.cellsrenderer){var v=r.cellsrenderer(m,r,f);void 0!=v&&(f=e(v).text())}if(null!=f){var p=f.toString().length,w=f.toString(),g=w.replace(/[^A-Z]/g,"").length;if(p>n&&(n=p,d=f,c=g),p>0&&p>=g){var z=20*g+15*(p-g),b=20*c+15*(n-c);z>b&&z>0&&b>0&&(n=p,d=f,c=g)}}}if("column"==i||"all"==i){r.text.toString().length>n&&(d=r.text);var f=r.text.toString(),p=f.toString().length,w=f.toString(),g=w.replace(/[^A-Z]/g,"").length;if(p>0&&p>=g){var z=20*g+15*(p-g),b=20*c+15*(n-c);z>b&&z>0&&b>0&&(n=p,d=f,c=g)}}void 0==d&&(d=r.text),a[0].innerHTML=d;var y=a.outerWidth()+10;if(e.jqx.browser.msie&&e.jqx.browser.version<8&&(y+=5),this.filterable&&this.showfilterrow&&(y+=5),y+=l,a.remove(),y>r.maxwidth&&(y=r.maxwidth),"auto"==r.maxwidth||y<=r.maxwidth){var _=r.width;y<r.minwidth&&(y=r.minwidth),r.width=y,void 0!=r._width&&(r.__width=r._width),r._width=null,void 0!=r._percentagewidth&&(r._percentagewidth=null),this._updatecolumnwidths(),this._updatecellwidths(),this._raiseEvent(14,{columntext:r.text,column:r.getcolumnproperties(),datafield:t,displayfield:r.displayfield,oldwidth:_,newwidth:y}),this._renderrows(this.virtualsizeinfo),void 0!=r._width&&(r._width=r.__width)}},_handlecolumnsresize:function(){var t=this.that;if(this.columnsresize){var i=!1;t.isTouchDevice()&&t.touchmode!==!0&&(i=!0);var l="mousemove.resize"+this.element.id,s="mousedown.resize"+this.element.id,r="mouseup.resize"+this.element.id;if(i)var l=e.jqx.mobile.getTouchEventName("touchmove")+".resize"+this.element.id,s=e.jqx.mobile.getTouchEventName("touchstart")+".resize"+this.element.id,r=e.jqx.mobile.getTouchEventName("touchend")+".resize"+this.element.id;this.removeHandler(e(document),l),this.addHandler(e(document),l,function(l){var s=e.data(document.body,"contextmenu"+t.element.id);if(null!=s&&t.autoshowcolumnsmenubutton)return!0;if(null!=t.resizablecolumn&&!t.disabled&&t.resizing&&null!=t.resizeline){var r=(t.resizablecolumn.columnelement,t.host.coord()),o=parseInt(t.resizestartline.coord().left),a=o-t._startcolumnwidth,n=t.resizablecolumn.column.minwidth;n="auto"==n?0:parseInt(n);var d=t.resizablecolumn.column.maxwidth;d="auto"==d?0:parseInt(d);var c=l.pageX;if(i){var u=t.getTouches(l),h=u[0];c=h.pageX}a+=n;var m=d>0?o+d:0,f=0==d?!0:t._startcolumnwidth+c-o<d?!0:!1;if(t.rtl)var f=!0;if(f)if(t.rtl){if(c>=r.left&&c<=r.left+t.host.width()&&(t.resizeline.css("left",c),i))return!1}else if(c>=r.left&&c>=a&&(0!=m&&l.pageX<m?t.resizeline.css("left",c):0==m&&t.resizeline.css("left",c),i))return!1}return i||null==t.resizablecolumn?void 0:!1}),this.removeHandler(e(document),s),this.addHandler(e(document),s,function(i){var l=e.data(document.body,"contextmenu"+t.element.id);if(null!=l&&t.autoshowcolumnsmenubutton)return!0;if(null!=t.resizablecolumn&&!t.disabled){var s=t.resizablecolumn.columnelement;if(s.coord().top+s.height()+5<i.pageY)return void(t.resizablecolumn=null);if(s.coord().top-5>i.pageY)return void(t.resizablecolumn=null);t._startcolumnwidth=t.resizablecolumn.column.width,t.resizablecolumn.column._width=null,e(document.body).addClass("jqx-disableselect"),e(document.body).addClass("jqx-position-reset"),t.host.addClass("jqx-disableselect"),t.content.addClass("jqx-disableselect"),t._mouseDownResize=new Date,t.resizing=!0,t._resizecolumn=t.resizablecolumn.column,t.resizeline=t.resizeline||e('<div style="position: absolute;"></div>'),t.resizestartline=t.resizestartline||e('<div style="position: absolute;"></div>'),t.resizebackground=t.resizebackground||e('<div style="position: absolute; left: 0; top: 0; background: #000;"></div>'),t.resizebackground.css("opacity",.01),t.resizebackground.css("cursor","col-resize"),t.resizeline.css("cursor","col-resize"),t.resizestartline.css("cursor","col-resize"),t.resizeline.addClass(t.toThemeProperty("jqx-grid-column-resizeline")),t.resizestartline.addClass(t.toThemeProperty("jqx-grid-column-resizestartline")),e(document.body).append(t.resizeline),e(document.body).append(t.resizestartline),e(document.body).append(t.resizebackground);var r=t.resizablecolumn.columnelement.coord();t.resizebackground.css("left",t.host.coord().left),t.resizebackground.css("top",t.host.coord().top),t.resizebackground.width(t.host.width()),t.resizebackground.height(t.host.height()),t.resizebackground.css("z-index",9999);var o=function(e){t.rtl?e.css("left",parseInt(r.left)):e.css("left",parseInt(r.left)+t._startcolumnwidth);var i=t._groupsheader(),l=i?t.groupsheader.height():0,s=t.showtoolbar?t.toolbarheight:0;l+=s;var o=t.showstatusbar?t.statusbarheight:0;l+=o;var a=0;t.pageable&&(a=t.pagerheight);var n="visible"==t.hScrollBar.css("visibility")?17:0;e.css("top",parseInt(r.top)),e.css("z-index",99999),e.height(t.columngroups?t.host.height()+t.resizablecolumn.columnelement.height()-a-l-n-t.columngroupslevel*t.columnsheight:t.host.height()-a-l-n),t.enableanimations?e.show("fast"):e.show()};o(t.resizeline),o(t.resizestartline),t.dragmousedown=null}});var o=function(){if(e(document.body).removeClass("jqx-disableselect"),e(document.body).removeClass("jqx-position-reset"),(t.showfilterrow||t.showstatusbar||t.showtoolbar||t.enablebrowserselection)&&(t.host.removeClass("jqx-disableselect"),t.content.removeClass("jqx-disableselect")),t.resizing){t._mouseUpResize=new Date;var i=t._mouseUpResize-t._mouseDownResize;if(200>i)return t.resizing=!1,void(null!=t._resizecolumn&&null!=t.resizeline&&"block"==t.resizeline.css("display")&&(t._resizecolumn=null,t.resizeline.hide(),t.resizestartline.hide(),t.resizebackground.remove()));if(t.resizing=!1,!t.disabled){var l=t.host.width();if("hidden"!=t.vScrollBar[0].style.visibility&&(l-=20),0>l&&(l=0),null!=t._resizecolumn&&null!=t.resizeline&&"block"==t.resizeline.css("display")){var s=parseInt(t.resizeline.css("left")),r=parseInt(t.resizestartline.css("left")),o=t._startcolumnwidth+s-r;if(t.rtl)var o=t._startcolumnwidth-s+r;var a=t._resizecolumn.width;t._closemenu(),t._resizecolumn.width=o,void 0!=t._resizecolumn._percentagewidth&&(t._resizecolumn._percentagewidth=o/l*100);for(var n=0;n<t._columns.length;n++)if(t._columns[n].datafield===t._resizecolumn.datafield){t._columns[n].width=t._resizecolumn.width;break}var d=t.hScrollBar[0].style.visibility;t._updatecolumnwidths(),t._updatecellwidths(),t._raiseEvent(14,{columntext:t._resizecolumn.text,column:t._resizecolumn.getcolumnproperties(),datafield:t._resizecolumn.datafield,oldwidth:a,newwidth:o}),t._renderrows(t.virtualsizeinfo),t.autosavestate&&t.savestate&&t.savestate(),d!=t.hScrollBar[0].style.visibility&&t.hScrollInstance.setPosition(0),t.rtl&&t._arrange(),t._resizecolumn=null,t.resizeline.hide(),t.resizestartline.hide(),t.resizebackground.remove(),t.resizablecolumn=null}else t.resizablecolumn=null}}};try{if(""!=document.referrer||window.frameElement){var a=null;if(null!=window.top&&window.top!=window.self&&window.parent&&document.referrer&&(a=document.referrer),a&&-1!=a.indexOf(document.location.host)){var n=function(){o()};window.top.document.addEventListener?window.top.document.addEventListener("mouseup",n,!1):window.top.document.attachEvent&&window.top.document.attachEvent("onmouseup",n)}}}catch(d){}this.removeHandler(e(document),r),this.addHandler(e(document),r,function(){var i=e.data(document.body,"contextmenu"+t.element.id);return null!=i&&t.autoshowcolumnsmenubutton?!0:void o()})}}})}(jQuery);