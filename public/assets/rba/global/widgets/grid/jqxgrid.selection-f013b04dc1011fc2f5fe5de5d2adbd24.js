!function(e){e.extend(e.jqx._jqxGrid.prototype,{selectallrows:function(){this._trigger=!1;var e=this.virtualmode?this.dataview.totalrecords:this.dataview.loadedrecords.length;this.selectedrowindexes=new Array;for(var t=this.dataview.loadedrecords,i=0;e>i;i++){var l=t[i];if(l){var s=this.getboundindex(l);void 0!=s&&(this.selectedrowindexes[i]=s)}else this.selectedrowindexes[i]=i}"checkbox"!=this.selectionmode||this._checkboxcolumnupdating||this._checkboxcolumn&&this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!0}),this._renderrows(this.virtualsizeinfo),this._trigger=!0,"checkbox"==this.selectionmode&&this._raiseEvent(2,{rowindex:this.selectedrowindexes})},unselectallrows:function(){this._trigger=!1;var e=this.virtualmode?this.dataview.totalrecords:this.dataview.loadedrecords.length;this.selectedrowindexes=new Array;for(var t=this.dataview.loadedrecords,i=0;e>i;i++){var l=t[i];l?delete this.selectedrowindexes[i]:this.selectedrowindexes[i]=i}"checkbox"!=this.selectionmode||this._checkboxcolumnupdating||this._checkboxcolumn&&this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!1}),this._renderrows(this.virtualsizeinfo),this._trigger=!0,"checkbox"==this.selectionmode&&this._raiseEvent(2,{rowindex:this.selectedrowindexes})},selectrow:function(e,t){this._applyrowselection(e,!0,t),t!==!1&&this._updatecheckboxselection()},_updatecheckboxselection:function(){if("checkbox"==this.selectionmode){var e=this.getrows();if(e&&this._checkboxcolumn){if(0===e.length)return void this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!1});var t=e.length;this.groupable&&(t=this.dataview.loadedrecords.length),this.virtualmode&&(t=this.source._source.totalrecords);var i=this.selectedrowindexes.length;this._checkboxcolumn.checkboxelement.jqxCheckBox(i===t?{checked:!0}:0===i?{checked:!1}:{checked:null})}}},unselectrow:function(e,t){this._applyrowselection(e,!1,t),t!==!1&&this._updatecheckboxselection()},selectcell:function(e,t){this._applycellselection(e,t,!0)},unselectcell:function(e,t){this._applycellselection(e,t,!1)},clearselection:function(e,t){if(this._trigger=!1,this.selectedrowindex=-1,this._oldselectedcell=null,t!==!1)for(var i=0;i<this.selectedrowindexes.length;i++)this._raiseEvent(3,{rowindex:this.selectedrowindexes[i]});return this.selectedrowindexes=new Array,this.selectedcells=new Array,"checkbox"!=this.selectionmode||this._checkboxcolumnupdating||this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!1}),!1===e?void(this._trigger=!0):(this._renderrows(this.virtualsizeinfo),this._trigger=!0,void("checkbox"==this.selectionmode&&this._raiseEvent(3,{rowindex:this.selectedrowindexes})))},getselectedrowindex:function(){if(-1==this.selectedrowindex)for(var e=0;e<this.selectedrowindexes.length;e++)return this.selectedrowindexes[e];return this.selectedrowindex},getselectedrowindexes:function(){return this.selectedrowindexes},getselectedcell:function(){if(!this.selectedcell)return null;var e=this.selectedcell;return e.row=this.selectedcell.rowindex,e.column=this.selectedcell.datafield,e.value=this.getcellvalue(e.row,e.column),e},getselectedcells:function(){var e=new Array;for(obj in this.selectedcells)e[e.length]=this.selectedcells[obj];return e},_getcellsforcopypaste:function(){var e=new Array;if(-1==this.selectionmode.indexOf("cell"))for(var t=this.selectedrowindexes,i=0;i<t.length;i++)for(var l=t[i],s=0;s<this.columns.records.length;s++){var o=(l+"_"+this.columns.records[s].datafield,{rowindex:l,datafield:this.columns.records[s].datafield});e.push(o)}return e},deleteselection:function(){var e=this,t=e.getselectedcells();if(-1==this.selectionmode.indexOf("cell")&&(t=this._getcellsforcopypaste()),null!=t&&t.length>0){for(var i=0;i<t.length;i++){var l=t[i],s=e.getcolumn(l.datafield),o=e.getcellvalue(l.rowindex,l.datafield);if(s&&""!==o){var r=null;"checkbox"==s.columntype&&(s.threestatecheckbox||(r=!1)),e._raiseEvent(17,{rowindex:l.rowindex,datafield:l.datafield,value:o}),i==t.length-1?(e.setcellvalue(l.rowindex,l.datafield,r,!0),s.displayfield!=s.datafield&&e.setcellvalue(l.rowindex,s.displayfield,r,!0)):(e.setcellvalue(l.rowindex,l.datafield,r,!1),s.displayfield!=s.datafield&&e.setcellvalue(l.rowindex,s.displayfield,r,!0)),e._raiseEvent(18,{rowindex:l.rowindex,datafield:l.datafield,oldvalue:o,value:r})}}this.dataview.updateview(),this._renderrows(this.virtualsizeinfo)}},copyselection:function(){var t="",i=this;this.clipboardselection={},this._clipboardselection=[];var l=i.getselectedcells();if(-1==this.selectionmode.indexOf("cell")&&(l=this._getcellsforcopypaste()),null!=l&&l.length>0){for(var s=999999999999999,o=-1,r=0;r<l.length;r++){var a=l[r],n=i.getcolumn(a.datafield);if(null!=n){var c=i.getcelltext(a.rowindex,a.datafield),d=this.getrowdisplayindex(a.rowindex);this.clipboardselection[d]||(this.clipboardselection[d]={}),this.clipboardselection[d][a.datafield]=c,s=Math.min(s,d),o=Math.max(o,d)}}for(var h=s;o>=h;h++){var u=0;this._clipboardselection[this._clipboardselection.length]=new Array,void 0!=this.clipboardselection[h]&&e.each(this.clipboardselection[h],function(e,l){u>0&&(t+="	");var s=l;null==l&&(s=""),i._clipboardselection[i._clipboardselection.length-1][u]=s,u++,t+=s}),o>h&&(t+="\r\n")}}return this.clipboardselectedtext=t,t},pasteselection:function(){var e=this.getselectedcells();if(-1==this.selectionmode.indexOf("cell")&&(e=this._getcellsforcopypaste()),null!=e&&e.length>0){var t=e[0].rowindex,i=this.getrowdisplayindex(t),l=e[0].datafield,s=this._getcolumnindex(l);if(this.selectedrowindexes=new Array,this.selectedcells=new Array,!this._clipboardselection)return;for(var o=0;o<this._clipboardselection.length;o++)for(var r=0;r<this._clipboardselection[o].length;r++){var a=this.getcolumnat(s+r);if(a){var n=this.getrowboundindex(i+o),c=this.getcell(n,a.datafield),d=null;if(d=this._clipboardselection[o][r],null!=d){if(a.cellsformat&&(-1!=a.cellsformat.indexOf("p")||-1!=a.cellsformat.indexOf("c")||-1!=a.cellsformat.indexOf("n")||-1!=a.cellsformat.indexOf("f"))){d.indexOf(this.gridlocalization.currencysymbol)>-1&&(d=d.replace(this.gridlocalization.currencysymbol,""));var h=function(e,t,i){var l=e;if(t==i)return e;for(var s=l.indexOf(t);-1!=s;)l=l.replace(t,i),s=l.indexOf(t);return l};d=h(d,this.gridlocalization.thousandsseparator,""),d=d.replace(this.gridlocalization.decimalseparator,"."),d.indexOf(this.gridlocalization.percentsymbol)>-1&&(d=d.replace(this.gridlocalization.percentsymbol,""));for(var u="",f=0;f<d.length;f++){var v=d.substring(f,f+1);"-"===v&&(u+="-"),"."===v&&(u+="."),null!=v.match(/^[0-9]+$/)&&(u+=v)}d=u,d=d.replace(/ /g,""),d=new Number(d),isNaN(d)&&(d="")}this._raiseEvent(17,{rowindex:n,datafield:c.datafield,value:d}),this.setcellvalue(n,c.column,d,!1),this._raiseEvent(18,{rowindex:n,datafield:c.datafield,oldvalue:this.getcellvalue(c.rowindex,c.datafield),value:d}),this._applycellselection(n,c.datafield,!0,!1)}}}this.dataview.updateview(),this._renderrows(this.virtualsizeinfo)}},_applyrowselection:function(e,t,i,l){if(null==e)return!1;var s=this.selectedrowindex;if("singlerow"==this.selectionmode&&(t?this._raiseEvent(2,{rowindex:e,row:this.getrowdata(e)}):this._raiseEvent(3,{rowindex:e,row:this.getrowdata(e)}),this._raiseEvent(3,{rowindex:s}),this.selectedrowindexes=new Array,this.selectedcells=new Array),1==l&&(this.selectedrowindexes=new Array),this.dataview.filters.length>0){var o=this.getrowdata(e);o&&void 0!==o.dataindex?e=o.dataindex:o&&void 0===o.dataindex&&void 0!=o.uid&&(e=this.getrowboundindexbyid(o.uid))}var r=this.selectedrowindexes.indexOf(e);if(t)this.selectedrowindex=e,-1==r?(this.selectedrowindexes.push(e),"singlerow"!=this.selectionmode&&this._raiseEvent(2,{rowindex:e,row:this.getrowdata(e)})):"multiplerows"==this.selectionmode&&(this.selectedrowindexes.splice(r,1),this._raiseEvent(3,{rowindex:this.selectedrowindex,row:this.getrowdata(e)}),this.selectedrowindex=this.selectedrowindexes.length>0?this.selectedrowindexes[this.selectedrowindexes.length-1]:-1);else if(r>=0||"singlerow"==this.selectionmode||"multiplerowsextended"==this.selectionmode||"multiplerowsadvanced"==this.selectionmode){var a=this.selectedrowindexes[r];this.selectedrowindexes.splice(r,1),this._raiseEvent(3,{rowindex:a,row:this.getrowdata(e)}),this.selectedrowindex=-1}return(void 0==i||i)&&this._rendervisualrows(),!0},_applycellselection:function(e,t,i,l){if(null==e)return!1;if(null==t)return!1;this.selectedrowindex;if("singlecell"==this.selectionmode){var s=this.selectedcell;null!=s&&this._raiseEvent(16,{rowindex:s.rowindex,datafield:s.datafield}),this.selectedcells=new Array}if("multiplecellsextended"==this.selectionmode||"multiplecellsadvanced"==this.selectionmode){var s=this.selectedcell;null!=s&&this._raiseEvent(16,{rowindex:s.rowindex,datafield:s.datafield})}var o=e+"_"+t;if(this.dataview.filters.length>0){var r=this.getrowdata(e);if(r&&void 0!==r.dataindex){e=r.dataindex;var o=e+"_"+t}else if(r&&void 0===r.dataindex&&r.uid){e=this.getrowboundindexbyid(r.uid);var o=e+"_"+t}}var a={rowindex:e,datafield:t};return i?(this.selectedcell=a,this.selectedcells[o]?("multiplecells"==this.selectionmode||"multiplecellsextended"==this.selectionmode||"multiplecellsadvanced"==this.selectionmode)&&(delete this.selectedcells[o],this.selectedcells.length>0&&this.selectedcells.length--,this._raiseEvent(16,a)):(this.selectedcells[o]=a,this.selectedcells.length++,this._raiseEvent(15,a))):(delete this.selectedcells[o],this.selectedcells.length>0&&this.selectedcells.length--,this._raiseEvent(16,a)),(void 0==l||l)&&this._rendervisualrows(),!0},_getcellindex:function(t){var i=-1;return e.each(this.selectedcells,function(){return i++,this[t]?!1:void 0}),i},_clearhoverstyle:function(){if(void 0!=this.hoveredrow&&-1!=this.hoveredrow&&!this.vScrollInstance.isScrolling()&&!this.hScrollInstance.isScrolling()){var e=this.table.find(".jqx-grid-cell-hover");e.length>0&&(e.removeClass(this.toTP("jqx-grid-cell-hover")),e.removeClass(this.toTP("jqx-fill-state-hover"))),this.hoveredrow=-1}},_clearselectstyle:function(){for(var t=this.table[0].rows.length,i=this.table[0].rows,l=this.toTP("jqx-grid-cell-selected"),s=this.toTP("jqx-fill-state-pressed"),o=this.toTP("jqx-grid-cell-hover"),r=this.toTP("jqx-fill-state-hover"),a=0;t>a;a++)for(var n=i[a],c=n.cells.length,d=n.cells,h=0;c>h;h++){var u=d[h],f=e(u);-1!=u.className.indexOf("jqx-grid-cell-selected")&&(f.removeClass(l),f.removeClass(s)),-1!=u.className.indexOf("jqx-grid-cell-hover")&&(f.removeClass(o),f.removeClass(r))}},_selectpath:function(e,t){var i=this,l=this._lastClickedCell?Math.min(this._lastClickedCell.row,e):0,s=this._lastClickedCell?Math.max(this._lastClickedCell.row,e):0;if(s>=l){var o=this._getcolumnindex(this._lastClickedCell.column),r=this._getcolumnindex(t),a=Math.min(o,r),n=Math.max(o,r);this.selectedcells=new Array;for(var c=this.dataview.loadedrecords,d=l;s>=d;d++)for(var h=a;n>=h;h++){var e=c[d];this._applycellselection(i.getboundindex(e),i._getcolumnat(h).datafield,!0,!1)}this._rendervisualrows()}},_selectrowpath:function(e){if("multiplerowsextended"==this.selectionmode){var t=this._lastClickedCell?Math.min(this._lastClickedCell.row,e):0,i=this._lastClickedCell?Math.max(this._lastClickedCell.row,e):0,l=this.dataview.loadedrecords;if(i>=t){this.selectedrowindexes=new Array;for(var s=t;i>=s;s++){var e=l[s],o=this.getrowboundindex(s);this._applyrowselection(o,!0,!1)}this._rendervisualrows()}}},_selectrowwithmouse:function(e,t,i,l,s,o){var r=t.row;if(void 0!=r){var a=t.index;if(void 0!=this.hittestinfo[a]){var n=this.hittestinfo[a].visualrow;if(!this.hittestinfo[a].details){{n.cells[0].className}if(!r.group){if("multiplerows"==this.selectionmode||"multiplecells"==this.selectionmode||"checkbox"==this.selectionmode||-1!=this.selectionmode.indexOf("multiple")&&(1==o||1==s)){var c=this.getboundindex(r);if(this.dataview.filters.length>0){var d=this.getrowdata(c);if(d&&(c=d.dataindex,void 0==c))var c=this.getboundindex(r)}var h=-1!=i.indexOf(c),u=this.getboundindex(r)+"_"+l;if(-1!=this.selectionmode.indexOf("cell")){var f=void 0!=this.selectedcells[u];if(void 0!=this.selectedcells[u]&&f?this._selectcellwithstyle(e,!1,a,l,n):this._selectcellwithstyle(e,!0,a,l,n),o&&void 0==this._lastClickedCell){var v=this.getselectedcells();v&&v.length>0&&(this._lastClickedCell={row:v[0].rowindex,column:v[0].datafield})}o&&this._lastClickedCell&&(this._selectpath(r.visibleindex,l),this.mousecaptured=!1,"visible"==this.selectionarea.css("visibility")&&this.selectionarea.css("visibility","hidden"))}else{if(h?s?this._applyrowselection(this.getboundindex(r),!1):this._selectrowwithstyle(e,n,!1,l):this._selectrowwithstyle(e,n,!0,l),o&&void 0==this._lastClickedCell){var w=this.getselectedrowindexes();w&&w.length>0&&(this._lastClickedCell={row:w[0],column:l})}if(o&&this._lastClickedCell){this.selectedrowindexes=new Array;for(var g=this._lastClickedCell?Math.min(this._lastClickedCell.row,r.visibleindex):0,p=this._lastClickedCell?Math.max(this._lastClickedCell.row,r.visibleindex):0,x=this.dataview.loadedrecords,m=g;p>=m;m++){var r=x[m];r&&this._applyrowselection(this.getboundindex(r),!0,!1,!1)}this._rendervisualrows()}}}else this._clearselectstyle(),this._selectrowwithstyle(e,n,!0,l),-1!=this.selectionmode.indexOf("cell")&&this._selectcellwithstyle(e,!0,a,l,n);o||(this._lastClickedCell={row:r.visibleindex,column:l})}}}}},_selectcellwithstyle:function(t,i,l,s,o){var r=e(o.cells[t._getcolumnindex(s)]);r.removeClass(this.toTP("jqx-grid-cell-hover")),r.removeClass(this.toTP("jqx-fill-state-hover")),i?(r.addClass(this.toTP("jqx-grid-cell-selected")),r.addClass(this.toTP("jqx-fill-state-pressed"))):(r.removeClass(this.toTP("jqx-grid-cell-selected")),r.removeClass(this.toTP("jqx-fill-state-pressed")))},_selectrowwithstyle:function(t,i,l){var s=i.cells.length,o=0;t.rowdetails&&t.showrowdetailscolumn?this.rtl?(s-=1,s-=this.groups.length):o=1+this.groups.length:this.groupable&&(this.rtl?s-=this.groups.length:o=this.groups.length);for(var r=o;s>r;r++){var a=i.cells[r];l?(e(a).removeClass(this.toTP("jqx-grid-cell-hover")),e(a).removeClass(this.toTP("jqx-fill-state-hover")),-1==t.selectionmode.indexOf("cell")&&(e(a).addClass(this.toTP("jqx-grid-cell-selected")),e(a).addClass(this.toTP("jqx-fill-state-pressed")))):(e(a).removeClass(this.toTP("jqx-grid-cell-hover")),e(a).removeClass(this.toTP("jqx-grid-cell-selected")),e(a).removeClass(this.toTP("jqx-fill-state-hover")),e(a).removeClass(this.toTP("jqx-fill-state-pressed")))}},_handlemousemoveselection:function(t,i){if(i.hScrollInstance.isScrolling()||i.vScrollInstance.isScrolling())return!1;if(("multiplerowsextended"==i.selectionmode||"multiplecellsextended"==i.selectionmode||"multiplecellsadvanced"==i.selectionmode)&&i.mousecaptured){if(i.multipleselectionbegins){var l=i.multipleselectionbegins(t);if(l===!1)return!0}var s=this.showheader?this.columnsheader.height()+2:0,o=this._groupsheader()?this.groupsheader.height():0,r=this.showtoolbar?this.toolbarheight:0;o+=r;var a=this.host.coord();if(this.hasTransform){a=e.jqx.utilities.getOffset(this.host);var n=this._getBodyOffset();a.left-=n.left,a.top-=n.top}"0px"===this.host.css("border-top-width")&&(o-=2);var c=t.pageX,d=t.pageY-o;if(Math.abs(this.mousecaptureposition.left-c)>3||Math.abs(this.mousecaptureposition.top-d)>3){var h=parseInt(this.columnsheader.coord().top);this.hasTransform&&(h=e.jqx.utilities.getOffset(this.columnsheader).top),c<a.left&&(c=a.left),c>a.left+this.host.width()&&(c=a.left+this.host.width());var u=a.top+s;u>d&&(d=u+5);var f=parseInt(Math.min(i.mousecaptureposition.left,c)),v=-5+parseInt(Math.min(i.mousecaptureposition.top,d)),w=parseInt(Math.abs(i.mousecaptureposition.left-c)),g=parseInt(Math.abs(i.mousecaptureposition.top-d));if(f-=a.left,v-=a.top,this.selectionarea.css("visibility","visible"),"multiplecellsadvanced"==i.selectionmode){var c=f,p=c+w,x=i.hScrollInstance,m=x.value;this.rtl&&("hidden"!=this.hScrollBar.css("visibility")&&(m=x.max-x.value),"hidden"!=this.vScrollBar[0].style.visibility);var b=i.table[0].rows[0],_=0,y=i.mousecaptureposition.clickedcell,k=y,C=!1,j=0,q=b.cells.length;i.mousecaptureposition.left<=t.pageX&&(j=y);for(var O=j;q>O;O++){var T=parseInt(e(this.columnsrow[0].cells[O]).css("left")),I=T-m;if(i.columns.records[O].pinned)I=T;else{var S=this._getcolumnat(O);if(!(null!=S&&S.hidden||i.groupable&&i.groups.length>0&&O<i.groups.length)){var P=I+e(this.columnsrow[0].cells[O]).width();if(i.mousecaptureposition.left>t.pageX){if(P>=c&&c>=I){k=O,C=!0;break}}else if(P>=p&&p>=I){k=O,C=!0;break}}}}C||(i.mousecaptureposition.left>t.pageX?e.each(this.columns.records,function(e){return i.groupable&&i.groups.length>0&&e<i.groups.length?!0:this.pinned||this.hidden?void 0:(k=e,!1)}):(!i.groupable||i.groupable&&!i.groups.length>0)&&(k=b.cells.length-1));var M=y;y=Math.min(y,k),k=Math.max(M,k),v+=5,v+=o;for(var A=(i.table[0].rows.indexOf(i.mousecaptureposition.clickedrow),0),K=-1,E=-1,z=0,O=0;O<i.table[0].rows.length;O++){var B=e(i.table[0].rows[O]);0==O&&(z=B.coord().top);var N=B.height(),X=z-a.top;if(-1==K&&X+N>=v){for(var Y=!1,D=0;D<i.groups.length;D++){var F=B[0].cells[D].className;if(-1!=F.indexOf("jqx-grid-group-collapse")||-1!=F.indexOf("jqx-grid-group-expand")){Y=!0;break}}if(Y)continue;K=O}if(z+=N,i.groupable&&i.groups.length>0){for(var Y=!1,D=0;D<i.groups.length;D++){var F=B[0].cells[D].className;if(-1!=F.indexOf("jqx-grid-group-collapse")||-1!=F.indexOf("jqx-grid-group-expand")){Y=!0;break}}if(Y)continue;for(var _=0,G=i.groups.length;G<B[0].cells.length;G++){var L=B[0].cells[G];""==e(L).html()&&_++}if(_==B[0].cells.length-i.groups.length)continue}if(-1!=K&&(A+=N),X+N>v+g){E=O;break}}if(-1!=K){v=e(i.table[0].rows[K]).coord().top-a.top-o-2;var $=0;this.filterable&&this.showfilterrow&&($=this.filterrowheight),parseInt(i.table[0].style.top)<0&&v<this.rowsheight+$&&(v-=parseInt(i.table[0].style.top),A+=parseInt(i.table[0].style.top)),g=A;var H=e(this.columnsrow[0].cells[y]),J=e(this.columnsrow[0].cells[k]);if(f=parseInt(H.css("left")),w=parseInt(J.css("left"))-parseInt(f)+J.width()-2,f-=m,i.editcell&&i.editable&&i.endcelledit&&(y!=k||K!=E)){if(0==i.editcell.validated)return;i.endcelledit(i.editcell.row,i.editcell.column,!0,!0)}}}this.selectionarea.width(w),this.selectionarea.height(g),this.selectionarea.css("left",f),this.selectionarea.css("top",v)}}},_handlemouseupselection:function(t,i){if(this.selectionarea){if("visible"!=this.selectionarea[0].style.visibility)return i.mousecaptured=!1,!0;if(i.mousecaptured&&("multiplerowsextended"==i.selectionmode||"multiplerowsadvanced"==i.selectionmode||"multiplecellsextended"==i.selectionmode||"multiplecellsadvanced"==i.selectionmode)&&(i.mousecaptured=!1,"visible"==this.selectionarea.css("visibility"))){this.selectionarea.css("visibility","hidden");var l=this.showheader?this.columnsheader.height()+2:0,s=this._groupsheader()?this.groupsheader.height():0;"0px"===this.host.css("border-top-width")&&(s-=2);var o=this.showtoolbar?this.toolbarheight:0;s+=o;var r=this.selectionarea.coord(),a=this.host.coord();this.hasTransform&&(a=e.jqx.utilities.getOffset(this.host),r=e.jqx.utilities.getOffset(this.selectionarea));var n=r.left-a.left,c=r.top-l-a.top-s,d=c,h=n+this.selectionarea.width(),u=n,f=new Array,v=new Array;if("multiplerowsextended"==i.selectionmode){for(;c<d+this.selectionarea.height();){var w=this._hittestrow(n,c),g=w.row,p=w.index;-1!=p&&(v[p]||(v[p]=!0,f[f.length]=w)),c+=20}var d=0;e.each(f,function(){var e=this.row;"none"!=i.selectionmode&&i._selectrowwithmouse&&(t.ctrlKey||t.metaKey?i._applyrowselection(i.getboundindex(e),!0,!1,!1):0==d?i._applyrowselection(i.getboundindex(e),!0,!1,!0):i._applyrowselection(i.getboundindex(e),!0,!1,!1),d++)})}else{"multiplecellsadvanced"==i.selectionmode&&(c+=2);var x=i.hScrollInstance,m=x.value;this.rtl&&("hidden"!=this.hScrollBar.css("visibility")&&(m=x.max-x.value),"hidden"!=this.vScrollBar[0].style.visibility&&(m-=this.scrollbarsize+4));var b=i.table[0].rows[0],_=i.selectionarea.height();!t.ctrlKey&&!t.metaKey&&_>0&&(i.selectedcells=new Array);for(var y=_;d+y>c;){var w=i._hittestrow(n,c);if(w){var g=w.row,p=w.index;if(-1!=p&&!v[p]){v[p]=!0;for(var k=0;k<b.cells.length;k++){var C=parseInt(e(i.columnsrow[0].cells[k]).css("left"))-m,j=C+e(i.columnsrow[0].cells[k]).width();(u>=C&&j>=u||h>=C&&j>=h||C>=u&&h>=C)&&i._applycellselection(i.getboundindex(g),i._getcolumnat(k).datafield,!0,!1)}}c+=5}else c+=5}}i.autosavestate&&i.savestate&&i.savestate(),i._renderrows(i.virtualsizeinfo)}}},selectprevcell:function(e,t){var i=this._getcolumnindex(t),l=(this.columns.records.length,this._getprevvisiblecolumn(i));null!=l&&(this.clearselection(),this.selectcell(e,l.datafield))},selectnextcell:function(e,t){var i=this._getcolumnindex(t),l=(this.columns.records.length,this._getnextvisiblecolumn(i));null!=l&&(this.clearselection(),this.selectcell(e,l.datafield))},_getfirstvisiblecolumn:function(){for(var e=this.columns.records.length,t=0;e>t;t++){var i=this.columns.records[t];if(!i.hidden&&null!=i.datafield)return i}return null},_getlastvisiblecolumn:function(){for(var e=this.columns.records.length,t=e-1;t>=0;t--){var i=this.columns.records[t];if(!i.hidden&&null!=i.datafield)return i}return null},_handlekeydown:function(t,i){if(i.groupable&&i.groups.length>0)return!0;if(i.disabled)return!1;var l=t.charCode?t.charCode:t.keyCode?t.keyCode:0;if(i.editcell&&"multiplecellsadvanced"!=i.selectionmode)return!0;if(i.editcell&&"multiplecellsadvanced"==i.selectionmode){if(!(l>=33&&40>=l))return!0;if(t.altKey)return i._cancelkeydown=!1,!0;if(void 0!=i._cancelkeydown&&0!=i._cancelkeydown)return i._cancelkeydown=!1,!0;if("selectedrow"===i.editmode)return!0;if(i.endcelledit(i.editcell.row,i.editcell.column,!1,!0),i._cancelkeydown=!1,i.editcell&&!i.editcell.validated)return i._rendervisualrows(),i.endcelledit(i.editcell.row,i.editcell.column,!1,!0),!1}if("none"==i.selectionmode)return!0;if(i.showfilterrow&&i.filterable&&this.filterrow&&e(t.target).ischildof(this.filterrow))return!0;if(i.pageable&&e(t.target).ischildof(this.pager))return!0;if(this.showtoolbar&&e(t.target).ischildof(this.toolbar))return!0;if(this.showstatusbar&&e(t.target).ischildof(this.statusbar))return!0;var s=!1;if(t.altKey)return!0;if((t.ctrlKey||t.metaKey)&&this.clipboard){var o=String.fromCharCode(l).toLowerCase();if("c"==o||"x"==o){var r=this.copyselection();if(window.clipboardData)window.clipboardData.setData("Text",r);else{var a=e('<textarea style="position: absolute; left: -1000px; top: -1000px;"/>');a.val(r),e("body").append(a),a.select(),setTimeout(function(){document.designMode="off",a.select(),a.remove(),i.focus()},100)}}else if("v"==o){var n=e('<textarea style="position: absolute; left: -1000px; top: -1000px;"/>');e("body").append(n),n.select();var c=this;setTimeout(function(){c._clipboardselection=new Array;for(var e=n.val(),t=e.split("\n"),i=0;i<t.length;i++)if(t[i].split("	").length>0){var l=t[i].split("	");if(1==l.length&&i==t.length-1&&""==l[0])continue;l.length>0&&c._clipboardselection.push(l)}c.pasteselection(),n.remove(),c.focus()},100)}"x"==o&&(this.deleteselection(),this.host.focus())}var d=Math.round(i._gettableheight()),h=Math.round(d/i.rowsheight),u=i.getdatainformation();switch(i.selectionmode){case"singlecell":case"multiplecells":case"multiplecellsextended":case"multiplecellsadvanced":var f=i.getselectedcell();if(null!=f){var v=this.getrowvisibleindex(f.rowindex),w=v,g=f.datafield,p=i._getcolumnindex(g),x=(i.columns.records.length,function(e,o,r){var a=function(e,t){var l=i.dataview.loadedrecords[e];if(void 0!=l&&null!=t){(r||void 0==r)&&i.clearselection();var o=i.getboundindex(l);return i.selectcell(o,t),i._oldselectedcell=i.selectedcell,s=!0,i.ensurecellvisible(e,t),!0}return!1};if(a(e,o)||(i.ensurecellvisible(e,o),a(e,o),i.virtualmode&&i.host.focus()),t.shiftKey&&9!=l){if(("multiplecellsextended"==i.selectionmode||"multiplecellsadvanced"==i.selectionmode)&&i._lastClickedCell){i._selectpath(e,o);var n=i.dataview.loadedrecords[e],c=i.getboundindex(n);return void(i.selectedcell={rowindex:c,datafield:o})}}else t.shiftKey||(i._lastClickedCell={row:e,column:o})}),m=t.shiftKey&&"singlecell"!=i.selectionmode&&"multiplecells"!=i.selectionmode,b=function(){x(0,g,!m)},_=function(){var e=u.rowscount-1;x(e,g,!m)},y=9==l&&!t.shiftKey,k=9==l&&t.shiftKey;(y||k)&&(m=!1);var C=t.ctrlKey||t.metaKey;if(C&&37==l){var j=i._getfirstvisiblecolumn(p);null!=j&&x(w,j.datafield)}else if(C&&39==l){var q=i._getlastvisiblecolumn(p);null!=q&&x(w,q.datafield)}else if(39==l||y){var O=i._getnextvisiblecolumn(p);null!=O?x(w,O.datafield,!m):y||(s=!0)}else if(37==l||k){var j=i._getprevvisiblecolumn(p);null!=j?x(w,j.datafield,!m):k||(s=!0)}else if(36==l)b();else if(35==l)_();else if(33==l)if(w-h>=0){var T=w-h;x(T,g,!m)}else b();else if(34==l)if(u.rowscount>w+h){var T=w+h;x(T,g,!m)}else _();else 38==l?C?b():w>0?x(w-1,g,!m):s=!0:40==l&&(C?_():u.rowscount>w+1?x(w+1,g,!m):s=!0)}break;case"singlerow":case"multiplerows":case"multiplerowsextended":case"multiplerowsadvanced":var w=i.getselectedrowindex();if(null==w||-1==w)return!0;w=this.getrowvisibleindex(w);var I=function(e,o){var r=function(e){var t=i.dataview.loadedrecords[e];if(void 0!=t){var l=i.getboundindex(t),r=i.selectedrowindex;(o||void 0==o)&&i.clearselection(),i.selectedrowindex=r,i.selectrow(l,!1);var a=i.ensurerowvisible(e);return(!a||i.autoheight||i.groupable)&&i._rendervisualrows(),s=!0,!0}return!1};if(r(e)||(i.ensurerowvisible(e),r(e,o),i.virtualmode&&setTimeout(function(){r(e,o)},25),i.virtualmode&&i.host.focus()),t.shiftKey&&9!=l){if("multiplerowsextended"==i.selectionmode&&i._lastClickedCell)return i._selectrowpath(e),void(i.selectedrowindex=i.getrowboundindex(e))}else t.shiftKey||(i._lastClickedCell={row:e},i.selectedrowindex=i.getrowboundindex(e))},m=t.shiftKey&&"singlerow"!=i.selectionmode&&"multiplerows"!=i.selectionmode,b=function(){I(0,!m)},_=function(){var e=u.rowscount-1;I(e,!m)},C=t.ctrlKey||t.metaKey;if(36==l||C&&38==l)b();else if(35==l||C&&40==l)_();else if(33==l)if(w-h>=0){var T=w-h;I(T,!m)}else b();else if(34==l)if(u.rowscount>w+h){var T=w+h;I(T,!m)}else _();else 38==l?w>0?I(w-1,!m):s=!0:40==l&&(u.rowscount>w+1?I(w+1,!m):s=!0)}return s?(i.autosavestate&&i.savestate&&i.savestate(),!1):!0},_handlemousemove:function(t,i){if(!i.vScrollInstance.isScrolling()&&!i.hScrollInstance.isScrolling()){var l,s,o,r,a;if(i.enablehover||"multiplerows"==i.selectionmode){l=this.showheader?this.columnsheader.height()+2:0,s=this._groupsheader()?this.groupsheader.height():0;var n=this.showtoolbar?this.toolbarheight:0;if(s+=n,o=this.host.coord(),this.hasTransform){o=e.jqx.utilities.getOffset(this.host);var c=this._getBodyOffset();o.left-=c.left,o.top-=c.top}r=t.pageX-o.left,a=t.pageY-l-o.top-s}if("multiplerowsextended"!=i.selectionmode&&"multiplecellsextended"!=i.selectionmode&&"multiplecellsadvanced"!=i.selectionmode||1!=i.mousecaptured){if(!i.enablehover)return!0;if(!i.disabled&&!this.vScrollInstance.isScrolling()&&!this.hScrollInstance.isScrolling()){var d=this._hittestrow(r,a);if(d){var h=d.row,u=d.index;if((-1==this.hoveredrow||-1==u||this.hoveredrow!=u||-1!=this.selectionmode.indexOf("cell")||"checkbox"==this.selectionmode)&&(this._clearhoverstyle(),-1!=u&&void 0!=h)){var f=this.hittestinfo[u].visualrow;if(null!=f&&!(this.hittestinfo[u].details||t.clientX>e(f).width()+e(f).coord().left)){var v=0,w=f.cells.length;if(i.rowdetails&&i.showrowdetailscolumn?this.rtl?(w-=1,w-=this.groups.length):v=1+this.groups.length:this.groupable&&(this.rtl?w-=this.groups.length:v=this.groups.length),0!=f.cells.length){var g=f.cells[v].className;if(!(h.group||this.selectionmode.indexOf("row")>=0&&-1!=g.indexOf("jqx-grid-cell-selected")))if(this.hoveredrow=u,-1==this.selectionmode.indexOf("cell")&&"checkbox"!=this.selectionmode)for(var p=v;w>p;p++){var x=f.cells[p];e(x).addClass(this.toTP("jqx-grid-cell-hover")),e(x).addClass(this.toTP("jqx-fill-state-hover")),this.cellhover&&this.cellhover(x,t.pageX,t.pageY)}else{var m=-1,b=this.hScrollInstance,_=b.value;this.rtl&&"hidden"!=this.hScrollBar.css("visibility")&&(_=b.max-b.value);for(var p=v;w>p;p++){var y=parseInt(e(this.columnsrow[0].cells[p]).css("left"))-_,k=y+e(this.columnsrow[0].cells[p]).width();if(k>=r&&r>=y){m=p;break}}if(-1!=m){var x=f.cells[m];if(this.cellhover&&this.cellhover(x,t.pageX,t.pageY),-1==x.className.indexOf("jqx-grid-cell-selected")){if(this.editcell){var C=this._getcolumnat(m);if(C&&this.editcell.row==u&&this.editcell.column==C.datafield)return}e(x).addClass(this.toTP("jqx-grid-cell-hover")),e(x).addClass(this.toTP("jqx-fill-state-hover"))}}}}}}}}}}}})}(jqxBaseFramework);