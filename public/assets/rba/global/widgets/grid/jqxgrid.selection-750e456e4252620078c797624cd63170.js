!function(e){e.extend(e.jqx._jqxGrid.prototype,{selectallrows:function(){this._trigger=!1;var e=this.virtualmode?this.dataview.totalrecords:this.getboundrows().length;this.selectedrowindexes=new Array;for(var t=0;e>t;t++)this.selectedrowindexes[t]=t;"checkbox"!=this.selectionmode||this._checkboxcolumnupdating||this._checkboxcolumn&&this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!0}),this._renderrows(this.virtualsizeinfo),this._trigger=!0,"checkbox"==this.selectionmode&&this._raiseEvent(2,{rowindex:this.selectedrowindexes})},selectrow:function(e,t){this._applyrowselection(e,!0,t),t!==!1&&this._updatecheckboxselection()},_updatecheckboxselection:function(){if("checkbox"==this.selectionmode){var e=this.getrows();if(e&&this._checkboxcolumn){if(0===e.length)return void this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!1});var t=e.length;this.virtualmode&&(t=this.source._source.totalrecords);var l=this.selectedrowindexes.length;this._checkboxcolumn.checkboxelement.jqxCheckBox(l===t?{checked:!0}:0===l?{checked:!1}:{checked:null})}}},unselectrow:function(e,t){this._applyrowselection(e,!1,t),t!==!1&&this._updatecheckboxselection()},selectcell:function(e,t){this._applycellselection(e,t,!0)},unselectcell:function(e,t){this._applycellselection(e,t,!1)},clearselection:function(e,t){if(this._trigger=!1,this.selectedrowindex=-1,t!==!1)for(var l=0;l<this.selectedrowindexes.length;l++)this._raiseEvent(3,{rowindex:this.selectedrowindexes[l]});return this.selectedrowindexes=new Array,this.selectedcells=new Array,"checkbox"!=this.selectionmode||this._checkboxcolumnupdating||this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!1}),!1===e?void(this._trigger=!0):(this._renderrows(this.virtualsizeinfo),this._trigger=!0,void("checkbox"==this.selectionmode&&this._raiseEvent(3,{rowindex:this.selectedrowindexes})))},getselectedrowindex:function(){if(-1==this.selectedrowindex)for(var e=0;e<this.selectedrowindexes.length;e++)return this.selectedrowindexes[e];return this.selectedrowindex},getselectedrowindexes:function(){return this.selectedrowindexes},getselectedcell:function(){if(!this.selectedcell)return null;var e=this.selectedcell;return e.row=this.selectedcell.rowindex,e.column=this.selectedcell.datafield,e.value=this.getcellvalue(e.row,e.column),e},getselectedcells:function(){var e=new Array;for(obj in this.selectedcells)e[e.length]=this.selectedcells[obj];return e},_getcellsforcopypaste:function(){var e=new Array;if(-1==this.selectionmode.indexOf("cell"))for(var t=this.selectedrowindexes,l=0;l<t.length;l++)for(var i=t[l],s=0;s<this.columns.records.length;s++){var o=(i+"_"+this.columns.records[s].datafield,{rowindex:i,datafield:this.columns.records[s].datafield});e.push(o)}return e},deleteselection:function(){var e=this,t=e.getselectedcells();if(-1==this.selectionmode.indexOf("cell")&&(t=this._getcellsforcopypaste()),null!=t&&t.length>0){for(var l=0;l<t.length;l++){var i=t[l],s=e.getcolumn(i.datafield),o=e.getcellvalue(i.rowindex,i.datafield);if(s&&""!==o){var r=null;"checkbox"==s.columntype&&(s.threestatecheckbox||(r=!1)),e._raiseEvent(17,{rowindex:i.rowindex,datafield:i.datafield,value:o}),l==t.length-1?(e.setcellvalue(i.rowindex,i.datafield,r,!0),s.displayfield!=s.datafield&&e.setcellvalue(i.rowindex,s.displayfield,r,!0)):(e.setcellvalue(i.rowindex,i.datafield,r,!1),s.displayfield!=s.datafield&&e.setcellvalue(i.rowindex,s.displayfield,r,!0)),e._raiseEvent(18,{rowindex:i.rowindex,datafield:i.datafield,oldvalue:o,value:r})}}this.dataview.updateview(),this._renderrows(this.virtualsizeinfo)}},copyselection:function(){var t="",l=this;this.clipboardselection={},this._clipboardselection=[];var i=l.getselectedcells();if(-1==this.selectionmode.indexOf("cell")&&(i=this._getcellsforcopypaste()),null!=i&&i.length>0){for(var s=999999999999999,o=-1,r=0;r<i.length;r++){var n=i[r],a=l.getcolumn(n.datafield);if(null!=a){var c=l.getcelltext(n.rowindex,n.datafield);this.clipboardselection[n.rowindex]||(this.clipboardselection[n.rowindex]={}),this.clipboardselection[n.rowindex][n.datafield]=c,s=Math.min(s,n.rowindex),o=Math.max(o,n.rowindex)}}for(var d=s;o>=d;d++){var h=0;this._clipboardselection[this._clipboardselection.length]=new Array,void 0!=this.clipboardselection[d]&&e.each(this.clipboardselection[d],function(e,i){h>0&&(t+="	");var s=i;null==i&&(s=""),l._clipboardselection[l._clipboardselection.length-1][h]=s,h++,t+=s}),o>d&&(t+="\n")}}return this.clipboardselectedtext=t,t},pasteselection:function(){var e=this.getselectedcells();if(-1==this.selectionmode.indexOf("cell")&&(e=this._getcellsforcopypaste()),null!=e&&e.length>0){var t=e[0].rowindex,l=e[0].datafield,i=this._getcolumnindex(l);if(this.selectedrowindexes=new Array,this.selectedcells=new Array,!this._clipboardselection)return;for(var s=0;s<this._clipboardselection.length;s++)for(var o=0;o<this._clipboardselection[s].length;o++){var r=this.getcolumnat(i+o);if(r){var n=this.getcell(t+s,r.datafield),a=null;if(a=this._clipboardselection[s][o],null!=a){if(r.cellsformat&&(-1!=r.cellsformat.indexOf("p")||-1!=r.cellsformat.indexOf("c")||-1!=r.cellsformat.indexOf("n")||-1!=r.cellsformat.indexOf("f"))){a.indexOf(this.gridlocalization.currencysymbol)>-1&&(a=a.replace(this.gridlocalization.currencysymbol,""));var c=function(e,t,l){var i=e;if(t==l)return e;for(var s=i.indexOf(t);-1!=s;)i=i.replace(t,l),s=i.indexOf(t);return i};a=c(a,this.gridlocalization.thousandsseparator,""),a=a.replace(this.gridlocalization.decimalseparator,"."),a.indexOf(this.gridlocalization.percentsymbol)>-1&&(a=a.replace(this.gridlocalization.percentsymbol,""));for(var d="",h=0;h<a.length;h++){var u=a.substring(h,h+1);"-"===u&&(d+="-"),"."===u&&(d+="."),null!=u.match(/^[0-9]+$/)&&(d+=u)}a=d,a=a.replace(/ /g,""),a=new Number(a),isNaN(a)&&(a="")}this._raiseEvent(17,{rowindex:t+s,datafield:n.datafield,value:a}),this.setcellvalue(n.row,n.column,a,!1),this._raiseEvent(18,{rowindex:t+s,datafield:n.datafield,oldvalue:this.getcellvalue(n.rowindex,n.datafield),value:a}),this._applycellselection(t+s,n.datafield,!0,!1)}}}this.dataview.updateview(),this._renderrows(this.virtualsizeinfo)}},_applyrowselection:function(e,t,l,i){if(null==e)return!1;var s=this.selectedrowindex;if("singlerow"==this.selectionmode&&(t?this._raiseEvent(2,{rowindex:e,row:this.getrowdata(e)}):this._raiseEvent(3,{rowindex:e,row:this.getrowdata(e)}),this._raiseEvent(3,{rowindex:s}),this.selectedrowindexes=new Array,this.selectedcells=new Array),1==i&&(this.selectedrowindexes=new Array),this.dataview.filters.length>0){var o=this.getrowdata(e);o&&void 0!==o.dataindex?e=o.dataindex:o&&void 0===o.dataindex&&o.uid&&(e=this.getrowboundindexbyid(o.uid))}var r=this.selectedrowindexes.indexOf(e);if(t)this.selectedrowindex=e,-1==r?(this.selectedrowindexes.push(e),"singlerow"!=this.selectionmode&&this._raiseEvent(2,{rowindex:e,row:this.getrowdata(e)})):"multiplerows"==this.selectionmode&&(this.selectedrowindexes.splice(r,1),this._raiseEvent(3,{rowindex:this.selectedrowindex,row:this.getrowdata(e)}),this.selectedrowindex=this.selectedrowindexes.length>0?this.selectedrowindexes[this.selectedrowindexes.length-1]:-1);else if(r>=0||"singlerow"==this.selectionmode||"multiplerowsextended"==this.selectionmode||"multiplerowsadvanced"==this.selectionmode){var n=this.selectedrowindexes[r];this.selectedrowindexes.splice(r,1),this._raiseEvent(3,{rowindex:n,row:this.getrowdata(e)}),this.selectedrowindex=-1}return(void 0==l||l)&&this._rendervisualrows(),!0},_applycellselection:function(e,t,l,i){if(null==e)return!1;if(null==t)return!1;this.selectedrowindex;if("singlecell"==this.selectionmode){var s=this.selectedcell;null!=s&&this._raiseEvent(16,{rowindex:s.rowindex,datafield:s.datafield}),this.selectedcells=new Array}if("multiplecellsextended"==this.selectionmode||"multiplecellsadvanced"==this.selectionmode){var s=this.selectedcell;null!=s&&this._raiseEvent(16,{rowindex:s.rowindex,datafield:s.datafield})}var o=e+"_"+t;if(this.dataview.filters.length>0){var r=this.getrowdata(e);if(r&&void 0!==r.dataindex){e=r.dataindex;var o=e+"_"+t}else if(r&&void 0===r.dataindex&&r.uid){e=this.getrowboundindexbyid(r.uid);var o=e+"_"+t}}var n={rowindex:e,datafield:t};return l?(this.selectedcell=n,this.selectedcells[o]?("multiplecells"==this.selectionmode||"multiplecellsextended"==this.selectionmode||"multiplecellsadvanced"==this.selectionmode)&&(delete this.selectedcells[o],this.selectedcells.length>0&&this.selectedcells.length--,this._raiseEvent(16,n)):(this.selectedcells[o]=n,this.selectedcells.length++,this._raiseEvent(15,n))):(delete this.selectedcells[o],this.selectedcells.length>0&&this.selectedcells.length--,this._raiseEvent(16,n)),(void 0==i||i)&&this._rendervisualrows(),!0},_getcellindex:function(t){var l=-1;return e.each(this.selectedcells,function(){return l++,this[t]?!1:void 0}),l},_clearhoverstyle:function(){if(void 0!=this.hoveredrow&&-1!=this.hoveredrow&&!this.vScrollInstance.isScrolling()&&!this.hScrollInstance.isScrolling()){var e=this.table.find(".jqx-grid-cell-hover");e.length>0&&(e.removeClass(this.toTP("jqx-grid-cell-hover")),e.removeClass(this.toTP("jqx-fill-state-hover"))),this.hoveredrow=-1}},_clearselectstyle:function(){for(var t=this.table[0].rows.length,l=this.table[0].rows,i=this.toTP("jqx-grid-cell-selected"),s=this.toTP("jqx-fill-state-pressed"),o=this.toTP("jqx-grid-cell-hover"),r=this.toTP("jqx-fill-state-hover"),n=0;t>n;n++)for(var a=l[n],c=a.cells.length,d=a.cells,h=0;c>h;h++){var u=d[h],f=e(u);-1!=u.className.indexOf("jqx-grid-cell-selected")&&(f.removeClass(i),f.removeClass(s)),-1!=u.className.indexOf("jqx-grid-cell-hover")&&(f.removeClass(o),f.removeClass(r))}},_selectpath:function(e,t){var l=this,i=this._lastClickedCell?Math.min(this._lastClickedCell.row,e):0,s=this._lastClickedCell?Math.max(this._lastClickedCell.row,e):0;if(s>=i){var o=this._getcolumnindex(this._lastClickedCell.column),r=this._getcolumnindex(t),n=Math.min(o,r),a=Math.max(o,r);this.selectedcells=new Array;for(var c=this.dataview.loadedrecords,d=i;s>=d;d++)for(var h=n;a>=h;h++){var e=c[d];this._applycellselection(l.getboundindex(e),l._getcolumnat(h).datafield,!0,!1)}this._rendervisualrows()}},_selectrowpath:function(e){if("multiplerowsextended"==this.selectionmode){var t=this._lastClickedCell?Math.min(this._lastClickedCell.row,e):0,l=this._lastClickedCell?Math.max(this._lastClickedCell.row,e):0,i=this.dataview.loadedrecords;if(l>=t){this.selectedrowindexes=new Array;for(var s=t;l>=s;s++){var e=i[s],o=this.getrowboundindex(s);this._applyrowselection(o,!0,!1)}this._rendervisualrows()}}},_selectrowwithmouse:function(e,t,l,i,s,o){var r=t.row;if(void 0!=r){var n=t.index;if(void 0!=this.hittestinfo[n]){var a=this.hittestinfo[n].visualrow;if(!this.hittestinfo[n].details){{a.cells[0].className}if(!r.group){if("multiplerows"==this.selectionmode||"multiplecells"==this.selectionmode||"checkbox"==this.selectionmode||-1!=this.selectionmode.indexOf("multiple")&&(1==o||1==s)){var c=this.getboundindex(r);if(this.dataview.filters.length>0){var d=this.getrowdata(c);if(d&&(c=d.dataindex,void 0==c))var c=this.getboundindex(r)}var h=-1!=l.indexOf(c),u=this.getboundindex(r)+"_"+i;if(-1!=this.selectionmode.indexOf("cell")){var f=void 0!=this.selectedcells[u];if(void 0!=this.selectedcells[u]&&f?this._selectcellwithstyle(e,!1,n,i,a):this._selectcellwithstyle(e,!0,n,i,a),o&&void 0==this._lastClickedCell){var v=this.getselectedcells();v&&v.length>0&&(this._lastClickedCell={row:v[0].rowindex,column:v[0].datafield})}o&&this._lastClickedCell&&(this._selectpath(r.visibleindex,i),this.mousecaptured=!1,"visible"==this.selectionarea.css("visibility")&&this.selectionarea.css("visibility","hidden"))}else{if(h?s?this._applyrowselection(this.getboundindex(r),!1):this._selectrowwithstyle(e,a,!1,i):this._selectrowwithstyle(e,a,!0,i),o&&void 0==this._lastClickedCell){var w=this.getselectedrowindexes();w&&w.length>0&&(this._lastClickedCell={row:w[0],column:i})}if(o&&this._lastClickedCell){this.selectedrowindexes=new Array;for(var g=this._lastClickedCell?Math.min(this._lastClickedCell.row,r.visibleindex):0,p=this._lastClickedCell?Math.max(this._lastClickedCell.row,r.visibleindex):0,m=this.dataview.loadedrecords,x=g;p>=x;x++){var r=m[x];this._applyrowselection(this.getboundindex(r),!0,!1,!1)}this._rendervisualrows()}}}else this._clearselectstyle(),this._selectrowwithstyle(e,a,!0,i),-1!=this.selectionmode.indexOf("cell")&&this._selectcellwithstyle(e,!0,n,i,a);o||(this._lastClickedCell={row:r.visibleindex,column:i})}}}}},_selectcellwithstyle:function(t,l,i,s,o){var r=e(o.cells[t._getcolumnindex(s)]);r.removeClass(this.toTP("jqx-grid-cell-hover")),r.removeClass(this.toTP("jqx-fill-state-hover")),l?(r.addClass(this.toTP("jqx-grid-cell-selected")),r.addClass(this.toTP("jqx-fill-state-pressed"))):(r.removeClass(this.toTP("jqx-grid-cell-selected")),r.removeClass(this.toTP("jqx-fill-state-pressed")))},_selectrowwithstyle:function(t,l,i){var s=l.cells.length,o=0;t.rowdetails&&t.showrowdetailscolumn?this.rtl?(s-=1,s-=this.groups.length):o=1+this.groups.length:this.groupable&&(this.rtl?s-=this.groups.length:o=this.groups.length);for(var r=o;s>r;r++){var n=l.cells[r];i?(e(n).removeClass(this.toTP("jqx-grid-cell-hover")),e(n).removeClass(this.toTP("jqx-fill-state-hover")),-1==t.selectionmode.indexOf("cell")&&(e(n).addClass(this.toTP("jqx-grid-cell-selected")),e(n).addClass(this.toTP("jqx-fill-state-pressed")))):(e(n).removeClass(this.toTP("jqx-grid-cell-hover")),e(n).removeClass(this.toTP("jqx-grid-cell-selected")),e(n).removeClass(this.toTP("jqx-fill-state-hover")),e(n).removeClass(this.toTP("jqx-fill-state-pressed")))}},_handlemousemoveselection:function(t,l){if(("multiplerowsextended"==l.selectionmode||"multiplecellsextended"==l.selectionmode||"multiplecellsadvanced"==l.selectionmode)&&l.mousecaptured){if(l.multipleselectionbegins){var i=l.multipleselectionbegins(t);if(i===!1)return!0}var s=this.showheader?this.columnsheader.height()+2:0,o=this._groupsheader()?this.groupsheader.height():0,r=this.showtoolbar?this.toolbarheight:0;o+=r;var n=this.host.coord();if(this.hasTransform){n=e.jqx.utilities.getOffset(this.host);var a=this._getBodyOffset();n.left-=a.left,n.top-=a.top}var c=t.pageX,d=t.pageY-o;if(Math.abs(this.mousecaptureposition.left-c)>3||Math.abs(this.mousecaptureposition.top-d)>3){var h=parseInt(this.columnsheader.coord().top);this.hasTransform&&(h=e.jqx.utilities.getOffset(this.columnsheader).top),c<n.left&&(c=n.left),c>n.left+this.host.width()&&(c=n.left+this.host.width());var u=n.top+s;u>d&&(d=u+5);var f=parseInt(Math.min(l.mousecaptureposition.left,c)),v=-5+parseInt(Math.min(l.mousecaptureposition.top,d)),w=parseInt(Math.abs(l.mousecaptureposition.left-c)),g=parseInt(Math.abs(l.mousecaptureposition.top-d));if(f-=n.left,v-=n.top,this.selectionarea.css("visibility","visible"),"multiplecellsadvanced"==l.selectionmode){var c=f,p=c+w,m=l.hScrollInstance,x=m.value;this.rtl&&("hidden"!=this.hScrollBar.css("visibility")&&(x=m.max-m.value),"hidden"!=this.vScrollBar[0].style.visibility);var b=l.table[0].rows[0],_=0,y=l.mousecaptureposition.clickedcell,C=y,k=!1,j=0,q=b.cells.length;l.mousecaptureposition.left<=t.pageX&&(j=y);for(var O=j;q>O;O++){var T=parseInt(e(this.columnsrow[0].cells[O]).css("left")),P=T-x;if(l.columns.records[O].pinned)P=T;else{var I=this._getcolumnat(O);if(!(null!=I&&I.hidden||l.groupable&&l.groups.length>0&&O<l.groups.length)){var M=P+e(this.columnsrow[0].cells[O]).width();if(l.mousecaptureposition.left>t.pageX){if(M>=c&&c>=P){C=O,k=!0;break}}else if(M>=p&&p>=P){C=O,k=!0;break}}}}k||(l.mousecaptureposition.left>t.pageX?e.each(this.columns.records,function(e){return l.groupable&&l.groups.length>0&&e<l.groups.length?!0:this.pinned||this.hidden?void 0:(C=e,!1)}):(!l.groupable||l.groupable&&!l.groups.length>0)&&(C=b.cells.length-1));var S=y;y=Math.min(y,C),C=Math.max(S,C),v+=5,v+=o;for(var A=(l.table[0].rows.indexOf(l.mousecaptureposition.clickedrow),0),E=-1,K=-1,z=0,O=0;O<l.table[0].rows.length;O++){var B=e(l.table[0].rows[O]);0==O&&(z=B.coord().top);var N=B.height(),X=z-n.top;if(-1==E&&X+N>=v){for(var D=!1,Y=0;Y<l.groups.length;Y++){var G=B[0].cells[Y].className;if(-1!=G.indexOf("jqx-grid-group-collapse")||-1!=G.indexOf("jqx-grid-group-expand")){D=!0;break}}if(D)continue;E=O}if(z+=N,l.groupable&&l.groups.length>0){for(var D=!1,Y=0;Y<l.groups.length;Y++){var G=B[0].cells[Y].className;if(-1!=G.indexOf("jqx-grid-group-collapse")||-1!=G.indexOf("jqx-grid-group-expand")){D=!0;break}}if(D)continue;for(var _=0,L=l.groups.length;L<B[0].cells.length;L++){var Q=B[0].cells[L];""==e(Q).html()&&_++}if(_==B[0].cells.length-l.groups.length)continue}if(-1!=E&&(A+=N),X+N>v+g){K=O;break}}if(-1!=E){v=e(l.table[0].rows[E]).coord().top-n.top-o-2;var $=0;this.filterable&&this.showfilterrow&&($=this.filterrowheight),parseInt(l.table[0].style.top)<0&&v<this.rowsheight+$&&(v-=parseInt(l.table[0].style.top),A+=parseInt(l.table[0].style.top)),g=A;var F=e(this.columnsrow[0].cells[y]),H=e(this.columnsrow[0].cells[C]);if(f=parseInt(F.css("left")),w=parseInt(H.css("left"))-parseInt(f)+H.width()-2,f-=x,l.editcell&&l.editable&&l.endcelledit&&(y!=C||E!=K)){if(0==l.editcell.validated)return;l.endcelledit(l.editcell.row,l.editcell.column,!0,!0)}}}this.selectionarea.width(w),this.selectionarea.height(g),this.selectionarea.css("left",f),this.selectionarea.css("top",v)}}},_handlemouseupselection:function(t,l){if(this.selectionarea){if("visible"!=this.selectionarea.css("visibility"))return l.mousecaptured=!1,!0;if(l.mousecaptured&&("multiplerowsextended"==l.selectionmode||"multiplerowsadvanced"==l.selectionmode||"multiplecellsextended"==l.selectionmode||"multiplecellsadvanced"==l.selectionmode)&&(l.mousecaptured=!1,"visible"==this.selectionarea.css("visibility"))){this.selectionarea.css("visibility","hidden");var i=this.showheader?this.columnsheader.height()+2:0,s=this._groupsheader()?this.groupsheader.height():0,o=this.showtoolbar?this.toolbarheight:0;s+=o;var r=this.selectionarea.coord(),n=this.host.coord();this.hasTransform&&(n=e.jqx.utilities.getOffset(this.host),r=e.jqx.utilities.getOffset(this.selectionarea));var a=r.left-n.left,c=r.top-i-n.top-s,d=c,h=a+this.selectionarea.width(),u=a,f=new Array,v=new Array;if("multiplerowsextended"==l.selectionmode){for(;c<d+this.selectionarea.height();){var w=this._hittestrow(a,c),g=w.row,p=w.index;-1!=p&&(v[p]||(v[p]=!0,f[f.length]=w)),c+=20}var d=0;e.each(f,function(){var e=this.row;"none"!=l.selectionmode&&l._selectrowwithmouse&&(t.ctrlKey?l._applyrowselection(l.getboundindex(e),!0,!1,!1):0==d?l._applyrowselection(l.getboundindex(e),!0,!1,!0):l._applyrowselection(l.getboundindex(e),!0,!1,!1),d++)})}else{"multiplecellsadvanced"==l.selectionmode&&(c+=2);var m=l.hScrollInstance,x=m.value;this.rtl&&("hidden"!=this.hScrollBar.css("visibility")&&(x=m.max-m.value),"hidden"!=this.vScrollBar[0].style.visibility&&(x-=this.scrollbarsize+4));var b=l.table[0].rows[0],_=l.selectionarea.height();!t.ctrlKey&&_>0&&(l.selectedcells=new Array);for(var y=_;d+y>c;){var w=l._hittestrow(a,c);if(w){var g=w.row,p=w.index;if(-1!=p&&!v[p]){v[p]=!0;for(var C=0;C<b.cells.length;C++){var k=parseInt(e(l.columnsrow[0].cells[C]).css("left"))-x,j=k+e(l.columnsrow[0].cells[C]).width();(u>=k&&j>=u||h>=k&&j>=h||k>=u&&h>=k)&&l._applycellselection(l.getboundindex(g),l._getcolumnat(C).datafield,!0,!1)}}c+=5}else c+=5}}l.autosavestate&&l.savestate&&l.savestate(),l._renderrows(l.virtualsizeinfo)}}},selectprevcell:function(e,t){var l=this._getcolumnindex(t),i=(this.columns.records.length,this._getprevvisiblecolumn(l));null!=i&&(this.clearselection(),this.selectcell(e,i.datafield))},selectnextcell:function(e,t){var l=this._getcolumnindex(t),i=(this.columns.records.length,this._getnextvisiblecolumn(l));null!=i&&(this.clearselection(),this.selectcell(e,i.datafield))},_getfirstvisiblecolumn:function(){for(var e=this.columns.records.length,t=0;e>t;t++){var l=this.columns.records[t];if(!l.hidden&&null!=l.datafield)return l}return null},_getlastvisiblecolumn:function(){for(var e=this.columns.records.length,t=e-1;t>=0;t--){var l=this.columns.records[t];if(!l.hidden&&null!=l.datafield)return l}return null},_handlekeydown:function(t,l){if(l.groupable&&l.groups.length>0)return!0;if(l.disabled)return!1;var i=t.charCode?t.charCode:t.keyCode?t.keyCode:0;if(l.editcell&&"multiplecellsadvanced"!=l.selectionmode)return!0;if(l.editcell&&"multiplecellsadvanced"==l.selectionmode){if(!(i>=33&&40>=i))return!0;if(t.altKey)return l._cancelkeydown=!1,!0;if(void 0!=l._cancelkeydown&&0!=l._cancelkeydown)return l._cancelkeydown=!1,!0;if("selectedrow"===l.editmode)return!0;if(l.endcelledit(l.editcell.row,l.editcell.column,!1,!0),l._cancelkeydown=!1,l.editcell&&!l.editcell.validated)return l._rendervisualrows(),l.endcelledit(l.editcell.row,l.editcell.column,!1,!0),!1}if("none"==l.selectionmode)return!0;if(l.showfilterrow&&l.filterable&&this.filterrow&&e(t.target).ischildof(this.filterrow))return!0;if(l.pageable&&e(t.target).ischildof(this.pager))return!0;if(this.showtoolbar&&e(t.target).ischildof(this.toolbar))return!0;if(this.showstatusbar&&e(t.target).ischildof(this.statusbar))return!0;var s=!1;if(t.altKey)return!0;if(t.ctrlKey&&this.clipboard){var o=String.fromCharCode(i).toLowerCase();if("c"==o||"x"==o){var r=this.copyselection();if(window.clipboardData)window.clipboardData.setData("Text",r);else{var n=e('<textarea style="position: absolute; left: -1000px; top: -1000px;"/>');n.val(r),e("body").append(n),n.select(),setTimeout(function(){document.designMode="off",n.select(),n.remove()},100)}}else if("v"==o)if(window.clipboardData&&this._clipboardselection&&this._clipboardselection.length>0)this.pasteselection();else{var a=e('<textarea style="position: absolute; left: -1000px; top: -1000px;"/>');e("body").append(a),a.select();var c=this;setTimeout(function(){c._clipboardselection=new Array;for(var e=a.val(),t=e.split("\n"),l=0;l<t.length;l++)if(t[l].split("	").length>0){var i=t[l].split("	");if(1==i.length&&l==t.length-1&&""==i[0])continue;i.length>0&&c._clipboardselection.push(i)}c.pasteselection(),a.remove()},100)}"x"==o&&this.deleteselection()}var d=Math.round(l._gettableheight()),h=Math.round(d/l.rowsheight),u=l.getdatainformation();switch(l.selectionmode){case"singlecell":case"multiplecells":case"multiplecellsextended":case"multiplecellsadvanced":var f=l.getselectedcell();if(null!=f){var v=this.getrowvisibleindex(f.rowindex),w=v,g=f.datafield,p=l._getcolumnindex(g),m=(l.columns.records.length,function(e,o,r){var n=function(e,t){var i=l.dataview.loadedrecords[e];if(void 0!=i&&null!=t){(r||void 0==r)&&l.clearselection();var o=l.getboundindex(i);return l.selectcell(o,t),l._oldselectedcell=l.selectedcell,s=!0,l.ensurecellvisible(e,t),!0}return!1};if(n(e,o)||(l.ensurecellvisible(e,o),n(e,o),l.virtualmode&&l.host.focus()),t.shiftKey&&9!=i){if(("multiplecellsextended"==l.selectionmode||"multiplecellsadvanced"==l.selectionmode)&&l._lastClickedCell)return l._selectpath(e,o),void(l.selectedcell={rowindex:e,datafield:o})}else t.shiftKey||(l._lastClickedCell={row:e,column:o})}),x=t.shiftKey&&"singlecell"!=l.selectionmode&&"multiplecells"!=l.selectionmode,b=function(){m(0,g,!x)},_=function(){var e=u.rowscount-1;m(e,g,!x)},y=9==i&&!t.shiftKey,C=9==i&&t.shiftKey;(y||C)&&(x=!1);var k=t.ctrlKey;if(k&&37==i){var j=l._getfirstvisiblecolumn(p);null!=j&&m(w,j.datafield)}else if(k&&39==i){var q=l._getlastvisiblecolumn(p);null!=q&&m(w,q.datafield)}else if(39==i||y){var O=l._getnextvisiblecolumn(p);null!=O?m(w,O.datafield,!x):y||(s=!0)}else if(37==i||C){var j=l._getprevvisiblecolumn(p);null!=j?m(w,j.datafield,!x):C||(s=!0)}else if(36==i)b();else if(35==i)_();else if(33==i)if(w-h>=0){var T=w-h;m(T,g,!x)}else b();else if(34==i)if(u.rowscount>w+h){var T=w+h;m(T,g,!x)}else _();else 38==i?k?b():w>0?m(w-1,g,!x):s=!0:40==i&&(k?_():u.rowscount>w+1?m(w+1,g,!x):s=!0)}break;case"singlerow":case"multiplerows":case"multiplerowsextended":case"multiplerowsadvanced":var w=l.getselectedrowindex();if(null==w||-1==w)return!0;w=this.getrowvisibleindex(w);var P=function(e,o){var r=function(e){var t=l.dataview.loadedrecords[e];if(void 0!=t){var i=l.getboundindex(t),r=l.selectedrowindex;(o||void 0==o)&&l.clearselection(),l.selectedrowindex=r,l.selectrow(i,!1);var n=l.ensurerowvisible(e);return(!n||l.autoheight||l.groupable)&&l._rendervisualrows(),s=!0,!0}return!1};if(r(e)||(l.ensurerowvisible(e),r(e,o),l.virtualmode&&l.host.focus()),t.shiftKey&&9!=i){if("multiplerowsextended"==l.selectionmode&&l._lastClickedCell)return l._selectrowpath(e),void(l.selectedrowindex=l.getrowboundindex(e))}else t.shiftKey||(l._lastClickedCell={row:e},l.selectedrowindex=l.getrowboundindex(e))},x=t.shiftKey&&"singlerow"!=l.selectionmode&&"multiplerows"!=l.selectionmode,b=function(){P(0,!x)},_=function(){var e=u.rowscount-1;P(e,!x)},k=t.ctrlKey;if(36==i||k&&38==i)b();else if(35==i||k&&40==i)_();else if(33==i)if(w-h>=0){var T=w-h;P(T,!x)}else b();else if(34==i)if(u.rowscount>w+h){var T=w+h;P(T,!x)}else _();else 38==i?w>0?P(w-1,!x):s=!0:40==i&&(u.rowscount>w+1?P(w+1,!x):s=!0)}return s?(l.autosavestate&&l.savestate&&l.savestate(),!1):!0},_handlemousemove:function(t,l){if(!l.vScrollInstance.isScrolling()&&!l.hScrollInstance.isScrolling()){var i,s,o,r,n;if(l.enablehover||"multiplerows"==l.selectionmode){i=this.showheader?this.columnsheader.height()+2:0,s=this._groupsheader()?this.groupsheader.height():0;var a=this.showtoolbar?this.toolbarheight:0;if(s+=a,o=this.host.coord(),this.hasTransform){o=e.jqx.utilities.getOffset(this.host);var c=this._getBodyOffset();o.left-=c.left,o.top-=c.top}r=t.pageX-o.left,n=t.pageY-i-o.top-s}if("multiplerowsextended"!=l.selectionmode&&"multiplecellsextended"!=l.selectionmode&&"multiplecellsadvanced"!=l.selectionmode||1!=l.mousecaptured){if(!l.enablehover)return!0;if(!l.disabled&&!this.vScrollInstance.isScrolling()&&!this.hScrollInstance.isScrolling()){var d=this._hittestrow(r,n);if(d){var h=d.row,u=d.index;if((-1==this.hoveredrow||-1==u||this.hoveredrow!=u||-1!=this.selectionmode.indexOf("cell")||"checkbox"==this.selectionmode)&&(this._clearhoverstyle(),-1!=u&&void 0!=h)){var f=this.hittestinfo[u].visualrow;if(null!=f&&!(this.hittestinfo[u].details||t.clientX>e(f).width()+e(f).coord().left)){var v=0,w=f.cells.length;if(l.rowdetails&&l.showrowdetailscolumn?this.rtl?(w-=1,w-=this.groups.length):v=1+this.groups.length:this.groupable&&(this.rtl?w-=this.groups.length:v=this.groups.length),0!=f.cells.length){var g=f.cells[v].className;if(!(h.group||this.selectionmode.indexOf("row")>=0&&-1!=g.indexOf("jqx-grid-cell-selected")))if(this.hoveredrow=u,-1==this.selectionmode.indexOf("cell")&&"checkbox"!=this.selectionmode)for(var p=v;w>p;p++){var m=f.cells[p];e(m).addClass(this.toTP("jqx-grid-cell-hover")),e(m).addClass(this.toTP("jqx-fill-state-hover")),this.cellhover&&this.cellhover(m,t.pageX,t.pageY)}else{var x=-1,b=this.hScrollInstance,_=b.value;this.rtl&&"hidden"!=this.hScrollBar.css("visibility")&&(_=b.max-b.value);for(var p=v;w>p;p++){var y=parseInt(e(this.columnsrow[0].cells[p]).css("left"))-_,C=y+e(this.columnsrow[0].cells[p]).width();if(C>=r&&r>=y){x=p;break}}if(-1!=x){var m=f.cells[x];if(-1==m.className.indexOf("jqx-grid-cell-selected")){if(this.editcell){var k=this._getcolumnat(x);if(k&&this.editcell.row==u&&this.editcell.column==k.datafield)return}e(m).addClass(this.toTP("jqx-grid-cell-hover")),e(m).addClass(this.toTP("jqx-fill-state-hover")),this.cellhover&&this.cellhover(m,t.pageX,t.pageY)}}}}}}}}}}}})}(jQuery);