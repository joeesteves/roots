!function(e){e.extend(e.jqx._jqxGrid.prototype,{autoresizecolumns:function(i,t){"cells"!=i&&"all"!=i&&"column"!=i&&(i="all");var l=this.that,s=this.getrows();this.pageable&&(s=this.dataview.rows,this.groupable&&(s=this.dataview.records)),t=void 0==t?0:parseInt(t);var r=s.length;if(void 0==r&&void 0!=s){var o=new Array;e.each(s,function(){o.push(this)}),s=o,r=s.length}var a=e("<span></span>");a.addClass(this.toThemeProperty("jqx-widget")),a.addClass(this.toThemeProperty("jqx-grid-cell")),e(document.body).append(a);var n=[],d=[],c=[],u=[],h=l.host.width();"hidden"!=l.vScrollBar[0].style.visibility&&(h-=this.scrollbarsize+5),0>h&&(h=0);for(var m=0;r>m;m++)for(var f=s[m],v=0;v<this.columns.records.length;v++){var p=this.columns.records[v];if(!(p.hidden||this.groups.length>0&&v<=this.groups.length-1)){void 0==d[p.displayfield]&&(d[p.displayfield]=0),void 0==c[p.displayfield]&&(c[p.displayfield]="");var w=f[p.displayfield];if(""!=p.cellsformat)e.jqx.dataFormat&&(e.jqx.dataFormat.isDate(w)?w=e.jqx.dataFormat.formatdate(w,p.cellsformat,this.gridlocalization):e.jqx.dataFormat.isNumber(w)&&(w=e.jqx.dataFormat.formatnumber(w,p.cellsformat,this.gridlocalization)));else if(p.cellsrenderer){var g=l._defaultcellsrenderer(w,p),z=p.cellsrenderer(m,p.datafield,w,g,p.getcolumnproperties(),f);void 0!=z&&(w=e(z).text())}if((void 0==i||"cells"==i||"all"==i)&&null!=w){var n=w.toString().length,b=w.toString(),_=b.replace(/[^A-Z]/g,"").length;if(n>d[p.displayfield]&&(d[p.displayfield]=n,c[p.displayfield]=w,u[p.displayfield]=_),n>0&&n>=_){var y=20*_+15*(n-_),x=20*u[p.displayfield]+15*(d[p.displayfield]-u[p.displayfield]);y>x&&y>0&&x>0&&(d[p.displayfield]=n,c[p.displayfield]=w,u[p.displayfield]=_)}}if("column"==i||"all"==i){if(p.text.toString().length>d[p.displayfield]){c[p.displayfield]=p.text,d[p.displayfield]=p.text.length;var b=p.text.toString(),_=b.replace(/[^A-Z]/g,"").length;u[p.displayfield]=_}var w=p.text,n=w.toString().length,b=w.toString(),_=b.replace(/[^A-Z]/g,"").length;if(n>0&&n>=_){var y=20*_+15*(n-_),x=20*u[p.displayfield]+15*(d[p.displayfield]-u[p.displayfield]);y>x&&y>0&&x>0&&(d[p.displayfield]=n,c[p.displayfield]=w,u[p.displayfield]=_)}}}}if(this.columns.records){for(var v=0;v<this.columns.records.length;v++){var p=this.columns.records[v];if(p.displayfield){void 0==c[p.displayfield]&&(c[p.displayfield]=p.text),a[0].innerHTML=c[p.displayfield].toString();var j=a.outerWidth()+10;if(a.children().length>0&&(j=a.children().outerWidth()+10),e.jqx.browser.msie&&e.jqx.browser.version<8&&(j+=10),this.filterable&&this.showfilterrow&&(j+=5),j+=t,j>p.maxwidth&&(j=p.maxwidth),void 0!=p._width&&(p.__width=p._width),p._width=null,"auto"==p.maxwidth||j<=p.maxwidth){var q=p.width;j<p.minwidth&&(j=p.minwidth),p.width=j,void 0!=p._percentagewidth&&(p._percentagewidth=null),this._raiseEvent(14,{columntext:p.text,column:p.getcolumnproperties(),datafield:p.datafield,displayfield:p.displayfield,oldwidth:q,newwidth:j})}}}a.remove(),this._updatecolumnwidths(),this._updatecellwidths(),this._renderrows(this.virtualsizeinfo);for(var v=0;v<this.columns.records.length;v++){var p=this.columns.records[v];void 0!=p.__width&&(p._width=p.__width)}}},autoresizecolumn:function(i,t,l){if("cells"!=t&&"all"!=t&&"column"!=t&&(t="all"),void 0==i)return!1;var s=this.getrows();this.pageable&&(s=this.dataview.rows,this.groupable&&(s=this.dataview.records));var r=this.getcolumn(i);if(void 0==r)return!1;l=void 0==l?0:parseInt(l);var o=s.length,a=e("<span></span>");a.addClass(this.toThemeProperty("jqx-widget")),a.addClass(this.toThemeProperty("jqx-grid-cell")),e(document.body).append(a);var n=0,d="",c=0,u=this.that,h=u.host.width();if("hidden"!=u.vScrollBar[0].style.visibility&&(h-=this.scrollbarsize+5),0>h&&(h=0),void 0==t||"cells"==t||"all"==t)for(var m=0;o>m;m++){var f=s[m][r.displayfield];if(""!=r.cellsformat)e.jqx.dataFormat&&(e.jqx.dataFormat.isDate(f)?f=e.jqx.dataFormat.formatdate(f,r.cellsformat,this.gridlocalization):e.jqx.dataFormat.isNumber(f)&&(f=e.jqx.dataFormat.formatnumber(f,r.cellsformat,this.gridlocalization)));else if(r.cellsrenderer){var v=r.cellsrenderer(m,r,f);void 0!=v&&(f=e(v).text())}if(null!=f){var p=f.toString().length,w=f.toString(),g=w.replace(/[^A-Z]/g,"").length;if(p>n&&(n=p,d=f,c=g),p>0&&p>=g){var z=20*g+15*(p-g),b=20*c+15*(n-c);z>b&&z>0&&b>0&&(n=p,d=f,c=g)}}}if("column"==t||"all"==t){r.text.toString().length>n&&(d=r.text);var f=r.text.toString(),p=f.toString().length,w=f.toString(),g=w.replace(/[^A-Z]/g,"").length;if(p>0&&p>=g){var z=20*g+15*(p-g),b=20*c+15*(n-c);z>b&&z>0&&b>0&&(n=p,d=f,c=g)}}void 0==d&&(d=r.text),a[0].innerHTML=d;var _=a.outerWidth()+10;if(e.jqx.browser.msie&&e.jqx.browser.version<8&&(_+=5),this.filterable&&this.showfilterrow&&(_+=5),_+=l,a.remove(),_>r.maxwidth&&(_=r.maxwidth),"auto"==r.maxwidth||_<=r.maxwidth){var y=r.width;_<r.minwidth&&(_=r.minwidth),r.width=_,void 0!=r._width&&(r.__width=r._width),r._width=null,void 0!=r._percentagewidth&&(r._percentagewidth=null),this._updatecolumnwidths(),this._updatecellwidths(),this._raiseEvent(14,{columntext:r.text,column:r.getcolumnproperties(),datafield:i,displayfield:r.displayfield,oldwidth:y,newwidth:_}),this._renderrows(this.virtualsizeinfo),void 0!=r._width&&(r._width=r.__width)}},_handlecolumnsresize:function(){var i=this.that;if(this.columnsresize){var t=!1;i.isTouchDevice()&&i.touchmode!==!0&&(t=!0);var l="mousemove.resize"+this.element.id,s="mousedown.resize"+this.element.id,r="mouseup.resize"+this.element.id;if(t)var l=e.jqx.mobile.getTouchEventName("touchmove")+".resize"+this.element.id,s=e.jqx.mobile.getTouchEventName("touchstart")+".resize"+this.element.id,r=e.jqx.mobile.getTouchEventName("touchend")+".resize"+this.element.id;this.removeHandler(e(document),l),this.addHandler(e(document),l,function(l){var s=e.data(document.body,"contextmenu"+i.element.id);if(null!=s&&i.autoshowcolumnsmenubutton)return!0;if(null!=i.resizablecolumn&&!i.disabled&&i.resizing&&null!=i.resizeline){var r=(i.resizablecolumn.columnelement,i.host.coord()),o=parseInt(i.resizestartline.coord().left),a=o-i._startcolumnwidth,n=i.resizablecolumn.column.minwidth;n="auto"==n?0:parseInt(n);var d=i.resizablecolumn.column.maxwidth;d="auto"==d?0:parseInt(d);var c=l.pageX;if(t){var u=i.getTouches(l),h=u[0];c=h.pageX}a+=n;var m=d>0?o+d:0,f=0==d?!0:i._startcolumnwidth+c-o<d?!0:!1;if(i.rtl)var f=!0;if(f)if(i.rtl){if(c>=r.left&&c<=r.left+i.host.width()&&(i.resizeline.css("left",c),t))return!1}else if(c>=r.left&&c>=a&&(0!=m&&l.pageX<m?i.resizeline.css("left",c):0==m&&i.resizeline.css("left",c),t))return!1}return t||null==i.resizablecolumn?void 0:!1}),this.removeHandler(e(document),s),this.addHandler(e(document),s,function(t){var l=e.data(document.body,"contextmenu"+i.element.id);if(null!=l&&i.autoshowcolumnsmenubutton)return!0;if(null!=i.resizablecolumn&&!i.disabled){var s=i.resizablecolumn.columnelement;if(s.coord().top+s.height()+5<t.pageY)return void(i.resizablecolumn=null);if(s.coord().top-5>t.pageY)return void(i.resizablecolumn=null);i._startcolumnwidth=i.resizablecolumn.column.width,i.resizablecolumn.column._width=null,e(document.body).addClass("jqx-disableselect"),e(document.body).addClass("jqx-position-reset"),i.host.addClass("jqx-disableselect"),i.content.addClass("jqx-disableselect"),i._mouseDownResize=new Date,i.resizing=!0,i._resizecolumn=i.resizablecolumn.column,i.resizeline=i.resizeline||e('<div style="position: absolute;"></div>'),i.resizestartline=i.resizestartline||e('<div style="position: absolute;"></div>'),i.resizebackground=i.resizebackground||e('<div style="position: absolute; left: 0; top: 0; background: #000;"></div>'),i.resizebackground.css("opacity",.01),i.resizebackground.css("cursor","col-resize"),i.resizeline.css("cursor","col-resize"),i.resizestartline.css("cursor","col-resize"),i.resizeline.addClass(i.toThemeProperty("jqx-grid-column-resizeline")),i.resizestartline.addClass(i.toThemeProperty("jqx-grid-column-resizestartline")),e(document.body).append(i.resizeline),e(document.body).append(i.resizestartline),e(document.body).append(i.resizebackground);var r=i.resizablecolumn.columnelement.coord();i.resizebackground.css("left",i.host.coord().left),i.resizebackground.css("top",i.host.coord().top),i.resizebackground.width(i.host.width()),i.resizebackground.height(i.host.height()),i.resizebackground.css("z-index",9999);var o=function(e){i.rtl?e.css("left",parseInt(r.left)):e.css("left",parseInt(r.left)+i._startcolumnwidth);var t=i._groupsheader(),l=t?i.groupsheader.height():0,s=i.showtoolbar?i.toolbarheight:0;l+=s;var o=i.showstatusbar?i.statusbarheight:0;l+=o;var a=0;i.pageable&&(a=i.pagerheight);var n="visible"==i.hScrollBar.css("visibility")?17:0;e.css("top",parseInt(r.top)),e.css("z-index",99999),e.height(i.columngroups?i.host.height()+i.resizablecolumn.columnelement.height()-a-l-n-i.columngroupslevel*i.columnsheight:i.host.height()-a-l-n),i.enableanimations?e.show("fast"):e.show()};o(i.resizeline),o(i.resizestartline),i.dragmousedown=null}});var o=function(){if(e(document.body).removeClass("jqx-disableselect"),e(document.body).removeClass("jqx-position-reset"),(i.showfilterrow||i.showstatusbar||i.showtoolbar||i.enablebrowserselection)&&(i.host.removeClass("jqx-disableselect"),i.content.removeClass("jqx-disableselect")),i.resizing){i._mouseUpResize=new Date;var t=i._mouseUpResize-i._mouseDownResize;if(200>t)return i.resizing=!1,void(null!=i._resizecolumn&&null!=i.resizeline&&"block"==i.resizeline.css("display")&&(i._resizecolumn=null,i.resizeline.hide(),i.resizestartline.hide(),i.resizebackground.remove()));if(i.resizing=!1,!i.disabled){var l=i.host.width();if("hidden"!=i.vScrollBar[0].style.visibility&&(l-=20),0>l&&(l=0),null!=i._resizecolumn&&null!=i.resizeline&&"block"==i.resizeline.css("display")){var s=parseInt(i.resizeline.css("left")),r=parseInt(i.resizestartline.css("left")),o=i._startcolumnwidth+s-r;if(i.rtl)var o=i._startcolumnwidth-s+r;var a=i._resizecolumn.width;i._closemenu(),o<i._resizecolumn.minwidth&&(o=i._resizecolumn.minwidth),i._resizecolumn.width=o,void 0!=i._resizecolumn._percentagewidth&&(i._resizecolumn._percentagewidth=o/l*100);for(var n=0;n<i._columns.length;n++)if(i._columns[n].datafield===i._resizecolumn.datafield){i._columns[n].width=i._resizecolumn.width,i._columns[n].width<i._resizecolumn.minwidth&&(i._columns[n].width=i._resizecolumn.minwidth);break}var d=i.hScrollBar[0].style.visibility;i._updatecolumnwidths(),i._updatecellwidths(),i._raiseEvent(14,{columntext:i._resizecolumn.text,column:i._resizecolumn.getcolumnproperties(),datafield:i._resizecolumn.datafield,oldwidth:a,newwidth:o}),i._renderrows(i.virtualsizeinfo),i.autosavestate&&i.savestate&&i.savestate(),d!=i.hScrollBar[0].style.visibility&&i.hScrollInstance.setPosition(0),i.rtl&&i._arrange(),i._resizecolumn=null,i.resizeline.hide(),i.resizestartline.hide(),i.resizebackground.remove(),i.resizablecolumn=null}else i.resizablecolumn=null}}};try{if(""!=document.referrer||window.frameElement){var a=null;if(null!=window.top&&window.top!=window.self&&window.parent&&document.referrer&&(a=document.referrer),a&&-1!=a.indexOf(document.location.host)){var n=function(){o()};window.top.document.addEventListener?window.top.document.addEventListener("mouseup",n,!1):window.top.document.attachEvent&&window.top.document.attachEvent("onmouseup",n)}}}catch(d){}this.removeHandler(e(document),r),this.addHandler(e(document),r,function(){var t=e.data(document.body,"contextmenu"+i.element.id);return null!=t&&i.autoshowcolumnsmenubutton?!0:void o()})}}})}(jqxBaseFramework);