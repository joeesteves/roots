!function(e){e.jqx.dataview.grouping=function(){this.loadgrouprecords=function(t,r,i,s,o,n,a,l,u){for(var d=t,p=this,h=new Array,g=0;g<p.groups.length;g++)h[g]=p.generatekey();var v=new Array,c=0,h=h,f=new Array,m=r,b=r,x=p.groups.length;this.loadedrecords=new Array,this.bounditems=new Array,this.loadedrecords=new Array,this.loadedrootgroups=new Array,this.loadedgroups=new Array,this.loadedgroupsByKey=new Array,this.sortedgroups=new Array;var w=null!=this.sortdata,y=w?this.sortdata:this.records;if(this.pageable){var q=Object.prototype.toString,I=this.groups[0];if(Object.prototype.toString="function"==typeof I?I:function(){return this[I]},w){var _=this.sortfield;Object.prototype.toString="function"==typeof I?I:function(){return this[I]+" "+this[_]}}var j=new Array,T=0;y[r]||(e.each(y,function(e){j[r+e++]=this}),y=j),w?y.sort(function(t,r){var t=t.value,r=r.value;if(void 0===t&&(t=null),void 0===r&&(r=null),null===t&&null===r)return 0;if(null===t&&null!==r)return 1;if(null!==t&&null===r)return-1;if(e.jqx.dataFormat.isNumber(t)&&e.jqx.dataFormat.isNumber(r))return r>t?-1:t>r?1:0;if(e.jqx.dataFormat.isDate(t)&&e.jqx.dataFormat.isDate(r))return r>t?-1:t>r?1:0;e.jqx.dataFormat.isNumber(t)||e.jqx.dataFormat.isNumber(r)||(t=String(t).toLowerCase(),r=String(r).toLowerCase());try{if(r>t)return-1;if(t>r)return 1}catch(i){}return 0}):y.sort&&y.sort(function(t,r){if(void 0===t&&(t=null),void 0===r&&(r=null),null===t&&null===r)return 0;if(null===t&&null!==r)return 1;if(null!==t&&null===r)return-1;if(t=t.toString(),r=r.toString(),e.jqx.dataFormat.isNumber(t)&&e.jqx.dataFormat.isNumber(r))return r>t?-1:t>r?1:0;if(e.jqx.dataFormat.isDate(t)&&e.jqx.dataFormat.isDate(r))return r>t?-1:t>r?1:0;e.jqx.dataFormat.isNumber(t)||e.jqx.dataFormat.isNumber(r)||(t=String(t).toLowerCase(),r=String(r).toLowerCase());try{if(r>t)return-1;if(t>r)return 1}catch(i){}return 0}),Object.prototype.toString=q}if(this.virtualmode){for(var j=new Array,T=0,m=0;i-r>m;m++)y[m]?j[r+T++]=y[m]:y[r+T]&&(j[r+T]=y[r+T],T++);m=0,y=j}for(var G=r;i>G;G++){var P={};P=w?e.extend({},y[G].value):e.extend({},y[G]),id=P[p.uniqueId],(o>=l||id!=a[o][p.uniqueId]||n&&n[id])&&(u[u.length]=o);for(var A=new Array,C=0,g=0;x>g;g++){var S=p.groups[g],H=P[S];null==H&&(H=""),A[C++]={value:H,hash:h[g]}}if(A.length!=x)break;for(var D=null,F="",B=-1,N=0;N<A.length;N++){B++;var z=A[N].value,L=A[N].hash;if(F=F+"_"+L+"_"+z,void 0==f[F]||null==f[F]){if(null==D)D={group:z,subItems:new Array,subGroups:new Array,level:0},v[c++]=D,D.uniqueid=p.generatekey(),p.loadedgroupsByKey[z]=D;else{var M={group:z,subItems:new Array,subGroups:new Array,parentItem:D,level:D.level+1};p.loadedgroupsByKey[D.uniqueid+"_"+z]=M,M.uniqueid=p.generatekey(),D.subGroups[D.subGroups.length++]=M,D=M}f[F]=D}else D=f[F]}null!=D?(void 0==P.uid&&(P.uid=this.getid(this.source.id,P,m)),w?(P.boundindex=y[G].index,this.recordsbyid["id"+P.uid]=y[G].value):(P.boundindex=m,this.recordsbyid["id"+P.uid]=y[G]),this.bounditems[P.boundindex]=P,this.sortedgroups[m]=P,P.uniqueid=p.generatekey(),P.parentItem=D,P.level=D.level+1,D.subItems[D.subItems.length++]=P):(void 0==P.uid&&(P.uid=this.getid(this.source.id,P,m)),w?(P.boundindex=y[G].index,this.recordsbyid["id"+P.uid]=y[G].value):(P.boundindex=m,this.recordsbyid["id"+P.uid]=y[G]),this.sortedgroups[m]=P,this.bounditems[P.boundindex]=P,P.uniqueid=p.generatekey()),o++,m++,b++}var E=function(e,r,i){for(var s=0;s<r.subItems.length;s++)r.subItems[s].visibleindex=t+i,e.rows[i]=r.subItems[s],e.loadedrecords[i]=r.subItems[s],i++;return i},k=function(e,r,i){var s=function(r){if(1==e.aggregates){var s=r,o={};null!=s&&(o.level=s.level,o.visibleindex=t+i,o.uniqueid=e.generatekey(),e.rows[i]=o,e.loadedrecords[i++]=o,o.totalsrow=!0,r.subItems.length>0?(s=r.subItems[r.subItems.length-1],o.parentItem=s.parentItem,o.parentItem.subItems&&(o.parentItem.subItems[o.parentItem.subItems.length]=o)):r.subGroups.length>0&&(s=r.subGroups[r.subGroups.length-1],o.level=s.level,o.parentItem=r,r.subGroups[r.subGroups.length]=o))}};for(subGroup in r.subGroups){var o=r.subGroups[subGroup];o.subGroups&&(e.loadedgroups[e.loadedgroups.length]=o,o.visibleindex=t+i,e.rows[i]=o,e.loadedrecords[i]=o,i++,o.subGroups.length>0?i=k(e,o,i):o.subItems.length>0&&(i=E(e,o,i)),s(o))}return r.subItems.length>0&&(i=E(e,r,i)),s(r),i},X=v.length;this.loadedgroups=new Array,this.rows=new Array;for(var d=0,m=0;X>m;m++){var S=v[m];this.loadedrootgroups[m]=S,this.loadedgroups[this.loadedgroups.length]=S,S.visibleindex=t+d,this.rows[d]=S,this.loadedrecords[d]=S,d++,d=k(this,S,d)}return d},this._updategroupsinpage=function(t,r,i,s,o,n,a){var l=new Array,u=[];if(this.groupable&&this.groups.length>0){for(var d=0,p=new Array,h=new Array,g=0;g<t.groups.length;g++)h[g]=t.generatekey();var v=0,c=new Array,f=0;a>this.totalrecords&&(a=this.totalrecords);for(var m=n;a>m;m++){var b=e.extend({},t.sortedgroups[m]);if(id=b[t.uniqueId],!t.pagesize||i>=t.pagesize*t.pagenum&&i<t.pagesize*(t.pagenum+1)){(s>=o||id!=l[s][t.uniqueId]||updated&&updated[id])&&(u[u.length]=s);for(var x=new Array,w=0,g=0;g<t.groups.length;g++){var y=t.groups[g],q=b[y];null==q&&(q=""),x[w++]={value:q,hash:h[g]}}if(x.length!=t.groups.length)break;for(var I=null,_="",j=-1,T=0;T<x.length;T++){j++;var G=x[T].value,P=x[T].hash;if(_=_+"_"+P+"_"+G,void 0==p[_]||null==p[_]){if(null==I){I={group:G,subItems:new Array,subGroups:new Array,level:0},c[f++]=I;var A=t.loadedgroupsByKey[G];void 0!=A&&(I.visibleindex=A.visibleindex,I.uniqueid=A.uniqueid)}else{var C={group:G,subItems:new Array,subGroups:new Array,parentItem:I,level:I.level+1},A=t.loadedgroupsByKey[I.uniqueid+"_"+G];C.visibleindex=A.visibleindex,C.uniqueid=A.uniqueid,I.subGroups[I.subGroups.length++]=C,I=C}p[_]=I}else I=p[_]}null!=I&&(b.parentItem=I,b.level=I.level+1,I.subItems[I.subItems.length++]=b),s++}v++,i++}for(var S=function(t,r,i){for(var s=0;s<r.subItems.length;s++)l[i]=e.extend({},r.subItems[s]),i++;return i},H=function(e){var t=!1;for(subGroup in e.subGroups){var r=e.subGroups[subGroup];if(r.subGroups){if(r.subGroups.length>0){var i=H(r);if(i)return t=!0,!0}if(r.subItems.length>0)return t=!0,!0}}return e.subItems.length>0?(t=!0,!0):t},D=function(e,t,r){for(subGroup in t.subGroups){var i=t.subGroups[subGroup];i.subGroups&&H(i)&&(l[r]=i,r++,i.subGroups.length>0?r=D(e,i,r):i.subItems.length>0&&(r=S(e,i,r)))}return t.subItems.length>0&&(r=S(e,t,r)),r},v=0;v<c.length;v++){var y=c[v];H(y)&&(l[d]=y,d++,d=D(this,y,d))}}return l}},e.extend(e.jqx._jqxGrid.prototype,{_initgroupsheader:function(){if(this.groupsheader.css("visibility","hidden"),this._groupsheader()){this.groupsheader.css("visibility","inherit");var t=this,r=this.gridlocalization.groupsheaderstring;this.groupsheaderdiv=this.groupsheaderdiv||e('<div style="width: 100%; position: relative;"></div>'),this.groupsheaderdiv.height(this.groupsheaderheight),this.groupsheaderdiv.css("top",0),this.groupsheader.append(this.groupsheaderdiv),this.groupheadersbounds=new Array;var i=this.groups.length;this.groupsheaderdiv.children().remove(),this.groupsheaderdiv[0].innerHTML="";var s=new Array;if(i>0)e.each(this.groups,function(r){var o=this,n=t._getColumnText(this),a=n.label,l=t._rendergroupcolumn(a,o);if(l.addClass(t.toThemeProperty("jqx-grid-group-column")),t.groupsheaderdiv.append(l),t.closeablegroups){var u=e(l.find(".jqx-icon-close"));t.isTouchDevice()&&t.touchmode!==!0?t.addHandler(u,"touchstart",function(){return t.removegroupat(r),!1}):t.addHandler(u,"click",function(){return t.removegroupat(r),!1})}if(t.sortable&&t.addHandler(l,"click",function(){var e=t.getcolumn(o);return null!=e&&t._togglesort(e),!1}),s[s.length]=l,t._handlegroupstocolumnsdragdrop(this,l),i-1>r){var d=l.height(),p=e('<div style="float: left; position: relative;"></div>');t.rtl&&p.css("float","right"),p.width(t.groupindentwidth/3),p.height(1),p.css("top",d/2),p.addClass(t.toThemeProperty("jqx-grid-group-column-line")),t.groupsheaderdiv.append(p)}});else{var o=e('<div style="position: relative;">'+r+"</div>");this.groupsheaderdiv.append(o),this.rtl&&o.addClass(this.toThemeProperty("jqx-rtl"))}this._groupheaders=s,this._updategroupheadersbounds()}},_updategroupheadersbounds:function(){var t=this,r=this.groupsheaderdiv.children().outerHeight(),i=(this.groupsheader.height()-r)/2;this.groupsheaderdiv.css("top",i),this.rtl?this.groupsheaderdiv.css("right",i):this.groupsheaderdiv.css("left",i),this.rtl&&this._groupheaders.reverse(),e.each(this._groupheaders,function(e){var r=this.coord();t.groupheadersbounds[e]={left:r.left,top:r.top,width:this.outerWidth(),height:this.outerHeight(),index:e}})},addgroup:function(e){if(e){var t=this;t.groups!==t.dataview.groups&&(t.dataview.groups=t.groups),t.groups[t.groups.length]=e,t.refreshgroups(),this._raiseEvent(12,{type:"Add",index:t.groups[t.groups.length],groups:t.groups})}},insertgroup:function(e,t){if(void 0!=e&&null!=e&&e>=0&&e<=this.groups.length&&t){var r=this;r.groups!==r.dataview.groups&&(r.dataview.groups=r.groups),r.groups.splice(e,0,t.toString()),r.refreshgroups(),this._raiseEvent(12,{type:"Insert",index:e,groups:r.groups})}},refreshgroups:function(){this._refreshdataview(),this._render(!0,!0,!0,!1)},_insertaftergroup:function(e,t){var r=this._getGroupIndexByDataField(e);this.insertgroup(r+1,t)},_insertbeforegroup:function(e,t){var r=this._getGroupIndexByDataField(e);this.insertgroup(r,t)},removegroupat:function(e){if(e>=0&&null!=e&&void 0!=e){var t=this;return t.groups!==t.dataview.groups&&(t.dataview.groups=t.groups),t.groups.splice(e,1),t.refreshgroups(),t.virtualmode&&t.updatebounddata(),this._raiseEvent(12,{type:"Remove",index:e,groups:t.groups}),!0}return!1},cleargroups:function(){var e=this;return e.groups=[],e.dataview.groups=e.groups,e.refreshgroups(),this._raiseEvent(12,{type:"Clear",index:-1,groups:e.groups}),!0},removegroup:function(e){if(null==e)return!1;var t=this.groups.indexOf(e.toString());return this.removegroupat(t)},getrootgroupscount:function(){var e=this.dataview.loadedrootgroups.length;return e},collapsegroup:function(e){return this._setrootgroupstate(e,!1)},expandgroup:function(e){return this._setrootgroupstate(e,!0)},collapseallgroups:function(e){this._setbatchgroupstate(!1,e)},expandallgroups:function(e){this._setbatchgroupstate(!0,e)},getgroup:function(t){var r=this.dataview.loadedrootgroups[t];if(null==r)return null;var i=this.expandedgroups[r.uniqueid].expanded,s=r.group,o=r.level,n=new Array;this._getsubgroups(n,r);var a=this,l={group:s,level:o,expanded:i,subgroups:n};if(r.subItems){var u=new Array;e.each(r.subItems,function(){var e=this.boundindex;u[u.length]=a.getrowdata(e)}),u.length>0&&(l.subrows=u)}return l},getrootgroups:function(){for(var e=this.dataview.loadedrootgroups.length,t=new Array,r=0;e>r;r++)t[r]=this.getgroup(r);return t},_getsubgroups:function(t,r){var i=this;for(obj in r.subGroups){var s=r.subGroups[obj],o=i.expandedgroups[s.uniqueid].expanded,n=s.group,a=s.level;if(t[t.length]={group:n,level:a,expanded:o},s.subItems){var l=new Array;e.each(s.subItems,function(){var e=this.boundindex;l[l.length]=i.getrowdata(e)}),t[t.length-1].subrows=l}if(s.subGroups){var u=new Array;i._getsubgroups(u,s)}}return t},_setbatchgroupstate:function(e,t){var r=this;for(obj in this.dataview.loadedrootgroups)r._setrootgroupstate(obj,e,!1,!0);if(0==t)return r._requiresupdate=!0,r._renderrows(r.virtualsizeinfo),!0;var i=this.vScrollBar[0].style.visibility;return this.rendergridcontent(!0,!1),(i!=this.vScrollBar[0].style.visibility||this._hiddencolumns)&&(this._updatecolumnwidths(),this._updatecellwidths(),this._renderrows(this.virtualsizeinfo)),!0},_setrootgroupstate:function(e,t,r,i){if(void 0==e||null==e||0>e)return!1;if(!this.groupable||0==this.groups.length)return!1;var s=void 0!=r?r:!0;if(e>=0&&e<this.dataview.loadedrootgroups.length){var o=this.dataview.loadedrootgroups[e];if(this.pageable){for(var n=new Array,a=0;a<this.dataview.rows.length;a++)null!=this.dataview.rows[a].group&&0===this.dataview.rows[a].level&&n.push(this.dataview.rows[a]);if(o=n[e],!o)return}return this._setgroupstate(o,t,s,i)}return!1},_togglegroupstate:function(e,t){if(null==e||void 0==e)return!1;var r=this.vScrollInstance.value,i=this.expandedgroups[e.uniqueid];i=void 0==i?!1:i.expanded,i=!i;var s=this._setgroupstate(e,i,t);return 0!==r&&"hidden"!==this.vScrollBar.css("visibility")&&this.vScrollInstance.setPosition(r<=this.vScrollInstance.max?r:this.vScrollInstance.max),s},_setgroupstate:function(e,t,r,i){if(null==e||void 0==e)return!1;var s=!1;this.editable&&this.editcell&&this.endcelledit(this.editcell.row,this.editcell.column,!1,!1);var o=this.expandedgroups[e.uniqueid];if(void 0==o&&(o={expanded:!1},s=!0),o.expanded!=t&&(s=!0),s){if(this.expandedgroups[e.uniqueid]={expanded:t,group:e},this._setsubgroupsvisibility(this,e,!t,i),r){var n=this.vScrollBar[0].style.visibility;this.rendergridcontent(!0,!1),(n!=this.vScrollBar[0].style.visibility||this._hiddencolumns)&&(this._updatecolumnwidths(),this._updatecellwidths(),this._renderrows(this.virtualsizeinfo))}return(void 0==this.suspendgroupevents||0==this.suspendgroupevents)&&(t?this._raiseEvent(4,{group:e.group,parentgroup:e.parentItem?e.parentItem.group:null,level:e.level,visibleindex:e.visibleindex}):this._raiseEvent(5,{group:e.group,parentgroup:e.parentItem?e.parentItem.group:null,level:e.level,visibleindex:e.visibleindex})),!0}return!1},_setgroupitemsvisibility:function(e,t,r){for(var i=0;i<t.subItems.length;i++)e._setrowvisibility(t.subItems[i].visibleindex,r,!1)},_setsubgroupsvisibility:function(e,t,r,i){if(null!=t.parentItem){if(this.hiddens[t.parentItem.visibleindex])return}else if(null==t.parentItem&&this.hiddens[t.visibleindex])return;for(subGroup in t.subGroups){var s=t.subGroups[subGroup];r||e._setrowvisibility(s.visibleindex,r,!1);var o=!r;i?this.expandedgroups[s.uniqueid]={expanded:o,group:s}:o=void 0==e.expandedgroups[s.uniqueid]?!1:e.expandedgroups[s.uniqueid].expanded,s.subGroups&&(s.subGroups.length>0?e._setsubgroupsvisibility(e,s,!o||r,i):s.subItems.length>0&&e._setgroupitemsvisibility(e,s,!o||r)),r&&e._setrowvisibility(s.visibleindex,r,!1)}t.subItems&&t.subItems.length>0&&e._setgroupitemsvisibility(e,t,r)},_handlecolumnsdragdrop:function(){var t=this,r=-1,i=!1;if(t.groupable){var s="mousemove.grouping"+this.element.id,o="mousedown.grouping"+this.element.id,n="mouseup.grouping"+this.element.id,a=!1;this.isTouchDevice()&&this.touchmode!==!0&&(a=!0,s=e.jqx.mobile.getTouchEventName("touchmove")+".grouping"+this.element.id,o=e.jqx.mobile.getTouchEventName("touchstart")+".grouping"+this.element.id,n=e.jqx.mobile.getTouchEventName("touchend")+".grouping"+this.element.id),this.removeHandler(e(document),s),this.addHandler(e(document),s,function(s){if(!t.showgroupsheader)return!0;if(null!=t.dragcolumn){var o=parseInt(s.pageX),n=parseInt(s.pageY);if(a){var l=t.getTouches(s),u=l[0];o=parseInt(u.pageX),n=parseInt(u.pageY)}var d=t.host.coord(),p=parseInt(d.left),h=parseInt(d.top);(void 0==t.dragmousedownoffset||null==t.dragmousedownoffset)&&(t.dragmousedownoffset={left:0,top:0});var g=parseInt(o)-parseInt(t.dragmousedownoffset.left),v=parseInt(n)-parseInt(t.dragmousedownoffset.top);if(t.dragcolumn.css({left:g+"px",top:v+"px"}),i=!1,o>=p&&o<=p+t.host.width()&&n>=h&&n<=h+t.host.height()&&(i=!0),r=-1,i){t.dragcolumnicon.removeClass(t.toThemeProperty("jqx-grid-dragcancel-icon")),t.dragcolumnicon.addClass(t.toThemeProperty("jqx-grid-drag-icon"));var c=t.groupsheader.coord(),f=c.top+t.groupsheader.height(),m=e.data(t.dragcolumn[0],"datarecord");if(m)var b=t.groups.indexOf(m.toString());else var b=-1;var x=-1==b||t.groups.length>1&&b>-1;null!=t.dropline&&(n>=c.top&&f>=n?x&&(r=t._handlegroupdroplines(o)):t.dropline.fadeOut("slow"))}else null!=t.dropline&&t.dropline.fadeOut("slow"),t.dragcolumnicon.removeClass(t.toThemeProperty("jqx-grid-drag-icon")),t.dragcolumnicon.addClass(t.toThemeProperty("jqx-grid-dragcancel-icon"));if(a)return s.preventDefault(),s.stopPropagation(),!1}}),this.removeHandler(e(document),n),this.addHandler(e(document),n,function(s){if(!t.showgroupsheader)return!0;t.__drag=!1,e(document.body).removeClass("jqx-disableselect");var o=parseInt(s.pageX),n=parseInt(s.pageY);if(a){var l=t.getTouches(s),u=l[0];o=parseInt(u.pageX),n=parseInt(u.pageY)}var d=t.host.coord(),p=(parseInt(d.left),parseInt(d.top)),h=t.groupsheader.height();if(t.showtoolbar&&(p+=t.toolbarheight),t.dragstarted=!1,t.dragmousedown=null,null!=t.dragcolumn){var g=e.data(t.dragcolumn[0],"datarecord");if(t.dragcolumn.remove(),t.dragcolumn=null,null!=g){if(!t.getcolumn(g).groupable)return void(null!=t.dropline&&(t.dropline.remove(),t.dropline=null));if(i)if(-1!=r){var v=r.index,c=t.groups[v],f=t._getGroupIndexByDataField(g);f!=v&&(void 0!=f&&f>=0&&t.groups.splice(f,1),"before"==r.position?t.rtl?t._insertaftergroup(c,g):t._insertbeforegroup(c,g):t.rtl?t._insertbeforegroup(c,g):t._insertaftergroup(c,g))}else if(0==t.groups.length)n>p&&p+h>=n&&t.addgroup(g);else if(n>p+h){var f=t._getGroupIndexByDataField(g);t.removegroupat(f)}null!=t.dropline&&(t.dropline.remove(),t.dropline=null)}}})}},_getGroupIndexByDataField:function(e){for(var t=0;t<this.groups.length;t++)if(this.groups[t]==e)return t;return-1},_isColumnInGroups:function(e){for(var t=0;t<this.groups.length;t++)if(this.groups[t]==e)return!0;return!1},_handlegroupdroplines:function(t){var r=this,i=-1;return e.each(r.groupheadersbounds,function(e){if(t<=this.left+this.width/2){var s=this.left-3;return e>0&&(s=this.left-1-r.groupindentwidth/6),r.dropline.css("left",s),r.dropline.css("top",this.top),r.dropline.height(this.height),r.dropline.fadeIn("slow"),i={index:e,position:"before"},r.rtl&&(i={index:r.groupheadersbounds.length-1-e,position:"before"}),!1}t>=this.left+this.width/2&&(r.dropline.css("left",1+this.left+this.width),r.dropline.css("top",this.top),r.dropline.height(this.height),r.dropline.fadeIn("slow"),i={index:e,position:"after"},r.rtl&&(i={index:r.groupheadersbounds.length-1-e,position:"after"}))}),i},_handlegroupstocolumnsdragdrop:function(t,r){this.dragmousedown=null,this.dragmousedownoffset=null,this.dragstarted=!1,this.dragcolumn=null;var i,s=this,o="mousedown",n="mousemove",a=!1;this.isTouchDevice()&&this.touchmode!==!0&&(a=!0,o=e.jqx.mobile.getTouchEventName("touchstart"),n=e.jqx.mobile.getTouchEventName("touchmove")),this.addHandler(r,"dragstart",function(){return!1}),this.addHandler(r,o,function(t){if(!s.showgroupsheader)return!0;var r=t.pageX,i=t.pageY;if(s.__drag=!0,s.dragmousedown={left:r,top:i},a){var o=s.getTouches(t),n=o[0];r=n.pageX,i=n.pageY,s.dragmousedown={left:r,top:i},t.preventDefault&&t.preventDefault()}var l=e(t.target).coord();s.dragmousedownoffset={left:parseInt(r)-parseInt(l.left),top:parseInt(i-l.top)}}),this.addHandler(r,n,function(o){if(!s.showgroupsheader)return!0;if(s.dragmousedown){if(i={left:o.pageX,top:o.pageY},a){var n=s.getTouches(o),l=n[0];i={left:l.pageX,top:l.pageY}}if(!s.dragstarted&&null==s.dragcolumn){var u=Math.abs(i.left-s.dragmousedown.left),d=Math.abs(i.top-s.dragmousedown.top);(u>3||d>3)&&(s._createdragcolumn(r,i,!0),e(document.body).addClass("jqx-disableselect"),e.data(s.dragcolumn[0],"datarecord",t),o.preventDefault&&o.preventDefault())}}})},_createdragcolumn:function(t,r,i){var s=this,o=r;s.dragcolumn=e("<div></div>");var n=t.clone();s.dragcolumn.css("z-index",999999),n.css("border-width","1px"),n.css("opacity","0.4");var a=e(n.find("."+s.toThemeProperty("jqx-grid-column-menubutton")));a.length>0&&a.css("display","none");var l=e(n.find(".jqx-icon-close"));l.length>0&&l.css("display","none"),s.dragcolumnicon=e('<div style="z-index: 9999; position: absolute; left: 100%; top: 50%; margin-left: -18px; margin-top: -7px;"></div>'),s.dragcolumnicon.addClass(s.toThemeProperty("jqx-grid-drag-icon")),s.dragcolumn.css("float","left"),s.dragcolumn.css("position","absolute");s.host.coord();n.width(t.width()+16),s.dragcolumn.append(n),s.dragcolumn.height(t.height()),s.dragcolumn.width(n.width()),s.dragcolumn.append(s.dragcolumnicon),e(document.body).append(s.dragcolumn),n.css("margin-left",0),n.css("left",0),n.css("top",0),s.dragcolumn.css("left",o.left+s.dragmousedown.left),s.dragcolumn.css("top",o.top+s.dragmousedown.top),void 0!=i&&i&&(s.dropline=e('<div style="display: none; position: absolute;"></div>'),s.dropline.width(2),s.dropline.addClass(s.toThemeProperty("jqx-grid-group-drag-line")),e(document.body).append(s.dropline))},iscolumngroupable:function(e){return this._getcolumnproperty(e,"groupable")},_handlecolumnstogroupsdragdrop:function(t,r){this.dragmousedown=null,this.dragmousedownoffset=null,this.dragstarted=!1,this.dragcolumn=null;var i,s=this,o=!1;this.isTouchDevice()&&this.touchmode!==!0&&(o=!0);var n="mousedown.drag",i="mousemove.drag";o?(n=e.jqx.mobile.getTouchEventName("touchstart")+".drag",i=e.jqx.mobile.getTouchEventName("touchmove")+".drag"):this.addHandler(r,"dragstart",function(){return!1}),this.addHandler(r,n,function(i){if(!s.showgroupsheader)return!0;if(s.__drag=!0,s._isColumnInGroups(t.displayfield))return"col-resize"!=r.css("cursor")?!0:!0;if(0==t.groupable)return!0;var n=i.pageX,a=i.pageY;if(o){var l=s.getTouches(i),u=l[0];n=u.pageX,a=u.pageY}s.dragmousedown={left:n,top:a},o&&i.preventDefault&&i.preventDefault();var d=e(i.target).coord();s.dragmousedownoffset={left:parseInt(n)-parseInt(d.left),top:parseInt(a-d.top)}}),this.addHandler(r,i,function(n){if(!s.showgroupsheader)return!0;if(s._isColumnInGroups(t.displayfield))return"col-resize"!=r.css("cursor")?!0:!0;if(s.dragmousedown){var a=n.pageX,l=n.pageY;if(o){var u=s.getTouches(n),d=u[0];a=d.pageX,l=d.pageY}if(i={left:a,top:l},!s.dragstarted&&null==s.dragcolumn){var p=Math.abs(i.left-s.dragmousedown.left),h=Math.abs(i.top-s.dragmousedown.top);(p>3||h>3)&&(s._createdragcolumn(r,i,!0),e.data(s.dragcolumn[0],"datarecord",t.displayfield),n.preventDefault&&n.preventDefault())}}})},_rendergroupcolumn:function(t,r){var i=e('<div style="float: left; position: relative;"></div>');if(this.rtl&&i.css("float","right"),null!=this.groupcolumnrenderer&&(i[0].innerHTML=this.groupcolumnrenderer(t),i.addClass(this.toThemeProperty("jqx-grid-group-column")),i.addClass(this.toThemeProperty("jqx-fill-state-normal"))),this.closeablegroups){""==i[0].innerHTML&&(i[0].innerHTML='<a style="float: left;" href="#">'+t+"</a>"),this.rtl&&(i[0].innerHTML='<a style="float: right;" href="#">'+t+"</a>");var s=this.rtl?"left":"right",o='<div style="float: '+s+'; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 100%; top: 50%; margin-left: -18px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-icon-close")+'"></div></div>';if(e.jqx.browser.msie&&e.jqx.browser.version<8&&(o='<div style="float: left; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 100%; top: 50%; margin-left: -18px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-icon-close")+'"></div></div>'),this.rtl){var o='<div style="float: '+s+'; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 0px; top: 50%; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-icon-close")+'"></div></div>';e.jqx.browser.msie&&e.jqx.browser.version<8&&(o='<div style="float: left; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 0px; top: 50%; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-icon-close")+'"></div></div>')}i[0].innerHTML+=o}else""==i[0].innerHTML&&(i[0].innerHTML='<a href="#">'+t+"</a>");if(this.sortable){var n=e('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 100%; top: 50%; margin-left: -16px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortascbutton")+'"></div></div>'),a=e('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 100%; top: 50%; margin-left: -16px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortdescbutton")+'"></div></div>');if(this.closeablegroups)var n=e('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 100%; top: 50%; margin-left: -32px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortascbutton")+'"></div></div>'),a=e('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 100%; top: 50%; margin-left: -32px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortdescbutton")+'"></div></div>');if(this.rtl){var n=e('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 0px; top: 50%; margin-left: 0px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortascbutton")+'"></div></div>'),a=e('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 0px; top: 50%; margin-left: 0px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortdescbutton")+'"></div></div>');if(this.closeablegroups)var n=e('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 0px; top: 50%; margin-left: 16px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortascbutton")+'"></div></div>'),a=e('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 0px; top: 50%; margin-left: 16px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortdescbutton")+'"></div></div>')}n.css("display","none"),a.css("display","none"),e.jqx.browser.msie&&e.jqx.browser.version<8&&(n.css("float","left"),a.css("float","left")),i.append(n),i.append(a),e.data(document.body,"groupsortelements"+r,{sortasc:n,sortdesc:a})}return i.addClass(this.toThemeProperty("jqx-fill-state-normal")),i.addClass(this.toThemeProperty("jqx-grid-group-column")),i},_rendergroup:function(t,r,i,s,o,n,a){var l=r,u=r.cells[i.level];this.rtl&&(u=r.cells[r.cells.length-1-i.level]);var d=this._findgroupstate(i.uniqueid);if(i.bounddata.subGroups.length>0||i.bounddata.subItems.length>0){var p=this.rtl?"-rtl":"",h=this.toThemeProperty("jqx-icon-arrow-right");p&&(h=this.toThemeProperty("jqx-icon-arrow-left")),u.className+=d?" "+this.toThemeProperty("jqx-grid-group-expand"+p)+" "+this.toThemeProperty("jqx-icon-arrow-down"):" "+this.toThemeProperty("jqx-grid-group-collapse"+p)+" "+h}var g=this._getColumnText(this.groups[i.level]).label,v=this.groupindentwidth,c=this.rowdetails&&this.showrowdetailscolumn?(1+t)*v:t*v,f=a-c,m=i.level+1;this.rtl&&(m=0);for(var b=l.cells[m],x=2;void 0!=b&&"none"==b.style.display&&x<l.cells.length-1;)b=l.cells[m+x-1],x++;var w=e(b);if(b){if(b.style.width=parseInt(f)+"px",-1!=b.className.indexOf("jqx-grid-cell-filter")&&w.removeClass(this.toThemeProperty("jqx-grid-cell-filter")),-1!=b.className.indexOf("jqx-grid-cell-sort")&&w.removeClass(this.toThemeProperty("jqx-grid-cell-sort")),-1!=b.className.indexOf("jqx-grid-cell-pinned")&&w.removeClass(this.toThemeProperty("jqx-grid-cell-pinned")),null!=this.groupsrenderer){var y={group:i.group,level:i.level,parent:i.bounddata.parentItem,subGroups:i.bounddata.subGroups,subItems:i.bounddata.subItems,groupcolumn:this._getColumnText(this.groups[i.level]).column},q=this.groupsrenderer(g+": "+i.group,i.group,d,y);if(q)b.innerHTML=q;else{var I=i.bounddata.subItems.length>0?i.bounddata.subItems.length:i.bounddata.subGroups.length;b.innerHTML='<div class="'+this.toThemeProperty("jqx-grid-groups-row")+'" style="position: absolute;"><span>'+g+': </span><span class="'+this.toThemeProperty("jqx-grid-groups-row-details")+'">'+i.group+" ("+I+")</span></div>"}}else{var _=this._getcolumnbydatafield(this.groups[i.level]),j=i.group;if(null==_)throw new Error("jqxGrid: Unable to find '"+this.groups[i.level]+"' group in the Grid's columns collection.");_.cellsformat&&e.jqx.dataFormat&&(e.jqx.dataFormat.isDate(j)?j=e.jqx.dataFormat.formatdate(j,_.cellsformat,this.gridlocalization):e.jqx.dataFormat.isNumber(j)&&(j=e.jqx.dataFormat.formatnumber(j,_.cellsformat,this.gridlocalization)));var I=i.bounddata.subItems.length>0?i.bounddata.subItems.length:i.bounddata.subGroups.length;b.innerHTML='<div class="'+this.toThemeProperty("jqx-grid-groups-row")+'" style="position: absolute;"><span>'+g+': </span><span class="'+this.toThemeProperty("jqx-grid-groups-row-details")+'">'+j+" ("+I+")</span></div>"}if(this.rtl){_||(_=this._getcolumnbydatafield(this.groups[i.level]));var T="hidden"==this.hScrollBar.css("visibility")?0:this.hScrollInstance.max-this.hScrollInstance.value,G="hidden"==this.vScrollBar.css("visibility")?0:this.scrollbarsize+6,c=this.rowdetails&&this.showrowdetailscolumn?(2+i.level)*v:(1+i.level)*v;b.style.width=a+parseInt(T)-c-G+"px",w.addClass(this.toThemeProperty("jqx-rtl"));var P=e(r.cells[r.cells.length-1]).css("z-index");w.css("z-index",P);var A=w.find("div"),f=A.width();A.css("left","100%");var C=null!=this.columns.records[r.cells.length-2-i.level]?this.columns.records[r.cells.length-2-i.level].pinned:!1;if(this.table.width()<a&&(a=this.table.width(),"hidden"!=this.vScrollBar.css("visibility")&&(a+=this.vScrollBar.outerWidth())),_.pinned||C)this.rowdetails&&this.showrowdetailscolumn&&(a+=30),A.css("margin-left",-f),b.style.width=a+T-c-G+"px";else{var T="hidden"==this.hScrollBar.css("visibility")?0:this.hScrollInstance.max;b.style.width=a+T-c-G+"px";var f=A.width();A.css("margin-left",-f)}}}}})}(jqxBaseFramework);